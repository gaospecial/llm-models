[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "å¤§æ¨¡å‹å¹³å°å’Œåº”ç”¨å®ä¾‹",
    "section": "",
    "text": "Preface\nThis is a Quarto book, created from markdown and executable code.\nSee Knuth (1984) for additional discussion of literate programming.\nTo learn more about Quarto books visit https://quarto.org/docs/books.\n\n\n\n\nKnuth, Donald E. 1984. â€œLiterate Programming.â€ Comput. J. 27 (2): 97â€“111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1Â  Introduction",
    "section": "",
    "text": "æœ¬ä¹¦ä»‹ç»å¼€æºæ¨¡å‹çš„éƒ¨ç½²å’Œåº”ç”¨ã€‚",
    "crumbs": [
      "<span class='chapter-number'>1</span>Â  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "2Â  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.",
    "crumbs": [
      "<span class='chapter-number'>2</span>Â  <span class='chapter-title'>Summary</span>"
    ]
  },
  {
    "objectID": "setup-env.html",
    "href": "setup-env.html",
    "title": "3Â  è®¾ç½®è¿è¡Œç¯å¢ƒ",
    "section": "",
    "text": "3.1 ä½¿ç”¨ Conda\nConda æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åŒ…ç®¡ç†å’Œç¯å¢ƒç®¡ç†å·¥å…·ï¼Œå¹¿æ³›ç”¨äº Python é¡¹ç›®ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ Conda çš„åŸºæœ¬æ­¥éª¤ï¼š\né¦–å…ˆï¼Œä» Anaconda å®˜ç½‘ä¸‹è½½å¹¶å®‰è£… Condaã€‚æ‚¨å¯ä»¥é€‰æ‹©å®‰è£…å®Œæ•´çš„ Anaconda å‘è¡Œç‰ˆï¼Œæˆ–è€…æ›´è½»é‡çº§çš„ Minicondaã€‚\nåˆ›å»ºä¸€ä¸ªæ–°çš„ Conda ç¯å¢ƒï¼š\nè¿™å°†åˆ›å»ºä¸€ä¸ªåä¸º myenv çš„ Python 3.10 ç¯å¢ƒã€‚\nåœ¨åˆ›å»ºçš„ç¯å¢ƒä¸­å®‰è£…æ‰€éœ€çš„åŒ…ï¼š\nè¿™å°†å®‰è£… NumPy åŒ…ã€‚\næ¿€æ´»ç¯å¢ƒï¼š\nè¿™å°†æ¿€æ´»æ‚¨åˆ›å»ºçš„ç¯å¢ƒã€‚\nå¦‚æœæ‚¨å·²ç»æœ‰ä¸€ä¸ªæƒ³è¦è®°å½•çš„ Conda ç¯å¢ƒï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯¼å‡ºå®ƒï¼š\nè¿™å°†åˆ›å»ºä¸€ä¸ªåŒ…å«å½“å‰ç¯å¢ƒæ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬çš„ environment.yml æ–‡ä»¶ã€‚\nåˆ›å»ºå¥½ environment.yml æ–‡ä»¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºæ–°ç¯å¢ƒï¼š\nè¿™å°†åˆ›å»ºä¸€ä¸ªä¸ environment.yml æ–‡ä»¶ä¸­è®°å½•çš„åŒ…åŠå…¶ç‰ˆæœ¬å®Œå…¨ç›¸åŒçš„æ–°ç¯å¢ƒã€‚",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è®¾ç½®è¿è¡Œç¯å¢ƒ</span>"
    ]
  },
  {
    "objectID": "setup-env.html#ä½¿ç”¨-conda",
    "href": "setup-env.html#ä½¿ç”¨-conda",
    "title": "3Â  è®¾ç½®è¿è¡Œç¯å¢ƒ",
    "section": "",
    "text": "å®‰è£… Conda\n\n\n\nåˆ›å»ºç¯å¢ƒ\n\n\nconda create -n myenv python=3.10\n\n\nå®‰è£…åŒ…\n\n\nconda install numpy\n\n\næ¿€æ´»ç¯å¢ƒ\n\n\nconda activate myenv\n\n\nå¯¼å‡ºç¯å¢ƒ\n\n\nconda env export &gt; environment.yml\n\n\nä½¿ç”¨æ–‡ä»¶åˆ›å»ºç¯å¢ƒ\n\n\nconda env create -f environment.yml",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è®¾ç½®è¿è¡Œç¯å¢ƒ</span>"
    ]
  },
  {
    "objectID": "setup-env.html#ä½¿ç”¨-pip",
    "href": "setup-env.html#ä½¿ç”¨-pip",
    "title": "3Â  è®¾ç½®è¿è¡Œç¯å¢ƒ",
    "section": "3.2 ä½¿ç”¨ pip",
    "text": "3.2 ä½¿ç”¨ pip\npip æ˜¯ Python çš„åŒ…ç®¡ç†å·¥å…·ï¼Œå¹¿æ³›ç”¨äº Python é¡¹ç›®ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ pip çš„åŸºæœ¬æ­¥éª¤ï¼š\n\nå®‰è£… pip\n\né¦–å…ˆï¼Œç¡®ä¿æ‚¨å·²ç»å®‰è£…äº† pipã€‚pip é€šå¸¸éš Python ä¸€èµ·å®‰è£…ã€‚\n\nå®‰è£…åŒ…\n\nåœ¨åˆ›å»ºçš„ç¯å¢ƒä¸­å®‰è£…æ‰€éœ€çš„åŒ…ï¼š\npip install numpy\nè¿™å°†å®‰è£… NumPy åŒ…ã€‚\n\nå¯¼å‡ºç¯å¢ƒ\n\nå¦‚æœæ‚¨å·²ç»æœ‰ä¸€ä¸ªæƒ³è¦è®°å½•çš„ pip ç¯å¢ƒï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯¼å‡ºå®ƒï¼š\npip freeze &gt; requirements.txt\nè¿™å°†åˆ›å»ºä¸€ä¸ªåŒ…å«å½“å‰ç¯å¢ƒä¸­æ‰€æœ‰å·²å®‰è£…åŒ…åŠå…¶ç‰ˆæœ¬çš„ requirements.txt æ–‡ä»¶ã€‚\n\nä½¿ç”¨æ–‡ä»¶åˆ›å»ºç¯å¢ƒ\n\nåˆ›å»ºå¥½ requirements.txt æ–‡ä»¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºæ–°ç¯å¢ƒï¼š\npip install -r requirements.txt\nè¿™å°†å®‰è£… requirements.txt æ–‡ä»¶ä¸­åˆ—å‡ºçš„æ‰€æœ‰åŒ…ã€‚",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è®¾ç½®è¿è¡Œç¯å¢ƒ</span>"
    ]
  },
  {
    "objectID": "setup-env.html#æ³¨æ„",
    "href": "setup-env.html#æ³¨æ„",
    "title": "3Â  è®¾ç½®è¿è¡Œç¯å¢ƒ",
    "section": "3.3 æ³¨æ„",
    "text": "3.3 æ³¨æ„\nå½“ä½ åŒæ—¶ä½¿ç”¨ conda å’Œ pip å®‰è£… Python ç¯å¢ƒåå‡ºç°å†²çªæ—¶ï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•è§£å†³ï¼š\n\nä¼˜å…ˆä½¿ç”¨ Condaï¼šå°½é‡ä½¿ç”¨ conda æ¥ç®¡ç†åŒ…ï¼Œå› ä¸ºå®ƒæ›´å¥½åœ°å¤„ç†ä¾èµ–å…³ç³»ã€‚åªæœ‰å½“ conda ä¸­æ‰¾ä¸åˆ°åŒ…æ—¶ï¼Œå†ä½¿ç”¨ pipã€‚\nåˆ›å»ºéš”ç¦»ç¯å¢ƒï¼šé€šè¿‡ conda create -n myenv åˆ›å»ºä¸€ä¸ªæ–°çš„ç¯å¢ƒï¼Œé¿å…ä¸å…¨å±€ç¯å¢ƒå†²çªã€‚\nä½¿ç”¨ conda install pipï¼šåœ¨ conda ç¯å¢ƒä¸­å®‰è£… pipï¼Œç¡®ä¿ pip å®‰è£…çš„åŒ…ä¸ç¯å¢ƒå…¼å®¹ã€‚\né‡è£…å†²çªåŒ…ï¼šå¦‚æœé—®é¢˜æŒç»­ï¼Œå°è¯•å¸è½½å†²çªåŒ…ï¼Œå¹¶ä½¿ç”¨å•ä¸€åŒ…ç®¡ç†å·¥å…·é‡æ–°å®‰è£…ã€‚",
    "crumbs": [
      "<span class='chapter-number'>3</span>Â  <span class='chapter-title'>è®¾ç½®è¿è¡Œç¯å¢ƒ</span>"
    ]
  },
  {
    "objectID": "huggingface.html",
    "href": "huggingface.html",
    "title": "4Â  Hugging Face",
    "section": "",
    "text": "4.1 å®‰è£…",
    "crumbs": [
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>Hugging Face</span>"
    ]
  },
  {
    "objectID": "huggingface.html#å®‰è£…",
    "href": "huggingface.html#å®‰è£…",
    "title": "4Â  Hugging Face",
    "section": "",
    "text": "å®‰è£…æœºå™¨å­¦ä¹ åŸºç¡€åº“ï¼ˆpytorch æˆ–è€… TensorFlowï¼‰ã€‚ é¦–å…ˆåˆ›å»ºä¸€ä¸ª Conda ç¯å¢ƒï¼Œç„¶åå®‰è£… Pytorchã€‚conda install pytorch::pytorch torchvision torchaudio -c pytorch\nå®‰è£… transformersï¼š pip install transformers datasets evaluate accelerateã€‚",
    "crumbs": [
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>Hugging Face</span>"
    ]
  },
  {
    "objectID": "huggingface.html#é…ç½®-gpu-åŠ é€Ÿ",
    "href": "huggingface.html#é…ç½®-gpu-åŠ é€Ÿ",
    "title": "4Â  Hugging Face",
    "section": "4.2 é…ç½® GPU åŠ é€Ÿ",
    "text": "4.2 é…ç½® GPU åŠ é€Ÿ\nPytorch æ”¯æŒ CUDAï¼ˆNVIDIAï¼‰å’Œ MPSï¼ˆMacï¼‰å¹³å°çš„ GPU åŠ é€Ÿï¼Œæ‰€ä»¥è¿™é‡Œæ£€æµ‹ä¸€ä¸‹ç¡¬ä»¶ç¯å¢ƒã€‚\n\nimport torch\n\n# select the device for computation\nif torch.cuda.is_available():\n    device = torch.device(\"cuda\")\nelif torch.backends.mps.is_available():\n    device = torch.device(\"mps\")\nelse:\n    device = torch.device(\"cpu\")\n\nprint(f\"using device: {device}\")\n\nusing device: mps",
    "crumbs": [
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>Hugging Face</span>"
    ]
  },
  {
    "objectID": "huggingface.html#pipeline",
    "href": "huggingface.html#pipeline",
    "title": "4Â  Hugging Face",
    "section": "4.3 Pipeline",
    "text": "4.3 Pipeline\npipeline æ˜¯ transformers åº“ä¸­çš„ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œæ—¨åœ¨ç®€åŒ–æ¨¡å‹çš„ä½¿ç”¨ã€‚å®ƒå°è£…äº†æ¨¡å‹çš„åŠ è½½ã€è¾“å…¥å¤„ç†ã€é¢„æµ‹å’Œè¾“å‡ºå¤„ç†çš„ç»†èŠ‚ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥ä»¥æ›´ç®€å•çš„æ–¹å¼æ‰§è¡Œå¸¸è§ä»»åŠ¡ã€‚\nåœ¨ Hugging Face Transformers åº“ä¸­ï¼Œpipelines å¯ä»¥è¢«åˆ†ä¸ºä¸åŒçš„ç±»åˆ«ï¼Œä»¥é€‚åº”éŸ³é¢‘ã€è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰å’Œå¤šæ¨¡æ€ä»»åŠ¡ã€‚ä»¥ä¸‹æ˜¯è¿™äº›ç±»åˆ«ä¸­å¸¸è§çš„ pipelinesï¼š\n\néŸ³é¢‘ï¼ˆAudioï¼‰:\n\nè¯­éŸ³è¯†åˆ«ï¼ˆSpeech Recognitionï¼‰: å°†éŸ³é¢‘è½¬æ¢ä¸ºæ–‡æœ¬ã€‚\nè¯­éŸ³åˆæˆï¼ˆText-to-Speechï¼‰: å°†æ–‡æœ¬è½¬æ¢ä¸ºè¯­éŸ³ã€‚\nè¯­éŸ³åˆ†ç±»ï¼ˆSpeech Classificationï¼‰: å¯¹éŸ³é¢‘è¿›è¡Œåˆ†ç±»ï¼Œå¦‚æƒ…ç»ªè¯†åˆ«ã€‚\n\nè®¡ç®—æœºè§†è§‰ï¼ˆComputer Visionï¼‰:\n\nå›¾åƒåˆ†ç±»ï¼ˆImage Classificationï¼‰: è¯†åˆ«å›¾åƒä¸­çš„ä¸»è¦å¯¹è±¡æˆ–åœºæ™¯ã€‚\nå¯¹è±¡æ£€æµ‹ï¼ˆObject Detectionï¼‰: è¯†åˆ«å¹¶å®šä½å›¾åƒä¸­çš„å¯¹è±¡ã€‚\nå›¾åƒåˆ†å‰²ï¼ˆImage Segmentationï¼‰: å°†å›¾åƒåˆ†å‰²æˆå¤šä¸ªéƒ¨åˆ†æˆ–å¯¹è±¡ã€‚\nå›¾åƒç”Ÿæˆï¼ˆImage Generationï¼‰: æ ¹æ®æ–‡æœ¬æè¿°ç”Ÿæˆå›¾åƒã€‚\n\nè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰:\n\næ–‡æœ¬åˆ†ç±»ï¼ˆText Classificationï¼‰: å¯¹æ–‡æœ¬è¿›è¡Œåˆ†ç±»ï¼Œå¦‚æƒ…æ„Ÿåˆ†æã€‚\nå‘½åå®ä½“è¯†åˆ«ï¼ˆNamed Entity Recognition, NERï¼‰: è¯†åˆ«æ–‡æœ¬ä¸­çš„å®ä½“ã€‚\né—®ç­”ï¼ˆQuestion Answeringï¼‰: ä»æ–‡æœ¬ä¸­æ‰¾åˆ°é—®é¢˜çš„ç­”æ¡ˆã€‚\næ–‡æœ¬ç”Ÿæˆï¼ˆText Generationï¼‰: ç”Ÿæˆæ–°çš„æ–‡æœ¬å†…å®¹ã€‚\næ‘˜è¦ï¼ˆSummarizationï¼‰: ç”Ÿæˆæ–‡æœ¬çš„æ‘˜è¦ã€‚\nç¿»è¯‘ï¼ˆTranslationï¼‰: å°†æ–‡æœ¬ä»ä¸€ç§è¯­è¨€ç¿»è¯‘æˆå¦ä¸€ç§è¯­è¨€ã€‚\n\nå¤šæ¨¡æ€ï¼ˆMultimodalï¼‰:\n\nè§†è§‰é—®ç­”ï¼ˆVisual Question Answering, VQAï¼‰: ç»“åˆå›¾åƒå’Œæ–‡æœ¬é—®é¢˜ï¼Œæä¾›ç­”æ¡ˆã€‚\nå›¾åƒå­—å¹•ç”Ÿæˆï¼ˆImage Captioningï¼‰: ä¸ºå›¾åƒç”Ÿæˆæè¿°æ€§æ–‡æœ¬ã€‚\nè§†é¢‘é—®ç­”ï¼ˆVideo Question Answeringï¼‰: æ ¹æ®è§†é¢‘å†…å®¹å›ç­”é—®é¢˜ã€‚\nå¤šæ¨¡æ€æƒ…æ„Ÿåˆ†æï¼ˆMultimodal Sentiment Analysisï¼‰: ç»“åˆæ–‡æœ¬ã€éŸ³é¢‘å’Œè§†è§‰ä¿¡æ¯è¿›è¡Œæƒ…æ„Ÿåˆ†æã€‚\n\n\nè¿™äº› pipelines åˆ©ç”¨äº†é¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œå¯ä»¥å¤„ç†å„ç§ä»»åŠ¡ï¼Œä»å•ä¸€æ¨¡æ€çš„éŸ³é¢‘æˆ–å›¾åƒå¤„ç†åˆ°ç»“åˆå¤šç§æ¨¡æ€ä¿¡æ¯çš„å¤æ‚ä»»åŠ¡ã€‚ç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ¨¡å‹å’Œpipelineæ¥å®ç°ç‰¹å®šçš„ä»»åŠ¡ã€‚\n\nimport inspect\nfrom transformers import pipelines\n\n# è·å– transformers.pipeline æ¨¡å—ä¸­çš„æ‰€æœ‰æˆå‘˜\npipeline_members = inspect.getmembers(pipelines)\n\n# è¿‡æ»¤å‡ºç±»ï¼Œå¹¶ä¸”åç§°ä»¥ 'Pipeline' ç»“å°¾\npipeline_classes = [name for name, obj in pipeline_members if inspect.isclass(obj) and name.endswith('Pipeline')]\n\n# æ‰“å°ç¬¦åˆæ¡ä»¶çš„ç±»åç§°\nprint(\"Classes ending with 'Pipeline':\")\nfor class_name in pipeline_classes:\n    print(class_name)\n\nClasses ending with 'Pipeline':\nAudioClassificationPipeline\nAutomaticSpeechRecognitionPipeline\nDepthEstimationPipeline\nDocumentQuestionAnsweringPipeline\nFeatureExtractionPipeline\nFillMaskPipeline\nImageClassificationPipeline\nImageFeatureExtractionPipeline\nImageSegmentationPipeline\nImageToImagePipeline\nImageToTextPipeline\nMaskGenerationPipeline\nNerPipeline\nObjectDetectionPipeline\nPipeline\nQuestionAnsweringPipeline\nSummarizationPipeline\nTableQuestionAnsweringPipeline\nText2TextGenerationPipeline\nTextClassificationPipeline\nTextGenerationPipeline\nTextToAudioPipeline\nTokenClassificationPipeline\nTranslationPipeline\nVideoClassificationPipeline\nVisualQuestionAnsweringPipeline\nZeroShotAudioClassificationPipeline\nZeroShotClassificationPipeline\nZeroShotImageClassificationPipeline\nZeroShotObjectDetectionPipeline\n\n\nä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ pipeline ç±»å‹å’Œå®ƒä»¬çš„åº”ç”¨åœºæ™¯ï¼š\n\n4.3.1 æ–‡æœ¬åˆ†ç±» (text-classification)\nç”¨äºå¯¹è¾“å…¥æ–‡æœ¬è¿›è¡Œåˆ†ç±»ï¼Œä¾‹å¦‚æƒ…æ„Ÿåˆ†æã€‚\n\nfrom transformers import pipeline\nfrom pprint import pprint  # pretty print\n\nclassifier = pipeline('text-classification')\nresult = classifier(\"I love using transformers!\")\npprint(result)\n\n[{'label': 'POSITIVE', 'score': 0.9994327425956726}]\n\n\n\n\n4.3.2 å‘½åå®ä½“è¯†åˆ« (ner)\nç”¨äºè¯†åˆ«æ–‡æœ¬ä¸­çš„å‘½åå®ä½“ï¼ˆå¦‚äººåã€åœ°ç‚¹ã€ç»„ç»‡ç­‰ï¼‰ã€‚\n\nfrom transformers import pipeline\n\nner = pipeline('ner', device = device)\nresult = ner(\"Hugging Face is based in New York City.\")\npprint(result)\n\n[{'end': 2,\n  'entity': 'I-ORG',\n  'index': 1,\n  'score': 0.9736425,\n  'start': 0,\n  'word': 'Hu'},\n {'end': 7,\n  'entity': 'I-ORG',\n  'index': 2,\n  'score': 0.7939442,\n  'start': 2,\n  'word': '##gging'},\n {'end': 12,\n  'entity': 'I-ORG',\n  'index': 3,\n  'score': 0.9046833,\n  'start': 8,\n  'word': 'Face'},\n {'end': 28,\n  'entity': 'I-LOC',\n  'index': 7,\n  'score': 0.9990658,\n  'start': 25,\n  'word': 'New'},\n {'end': 33,\n  'entity': 'I-LOC',\n  'index': 8,\n  'score': 0.99908113,\n  'start': 29,\n  'word': 'York'},\n {'end': 38,\n  'entity': 'I-LOC',\n  'index': 9,\n  'score': 0.99939454,\n  'start': 34,\n  'word': 'City'}]\n\n\n\n\n4.3.3 é—®ç­” (question-answering)\nç”¨äºä»ç»™å®šä¸Šä¸‹æ–‡ä¸­å›ç­”é—®é¢˜ã€‚\n\nfrom transformers import pipeline\n\nquestion_answerer = pipeline('question-answering', device = device)\nresult = question_answerer(question=\"What is the capital of France?\", context=\"The capital of France is Paris.\")\npprint(result)\n\n{'answer': 'Paris', 'end': 30, 'score': 0.9863283038139343, 'start': 25}\n\n\n\n\n4.3.4 æ–‡æœ¬ç”Ÿæˆ (text-generation)\nç”¨äºç”Ÿæˆæ–‡æœ¬ï¼Œä¾‹å¦‚ç”Ÿæˆç»­å†™æˆ–å¯¹è¯ã€‚\n\nfrom transformers import pipeline\n\ngenerator = pipeline('text-generation', device = device)\nresult = generator(\"Once upon a time\", max_length=50)\npprint(result)\n\n[{'generated_text': 'Once upon a time, when I was young, I became obsessed '\n                    'with seeing people I was in the know. I had never seen, '\n                    'seen, even heard of, or read anything about how to get to '\n                    'know the people I knew. It was like'}]\n\n\n\n\n4.3.5 ç¿»è¯‘ (translation)\nç”¨äºå°†æ–‡æœ¬ä»ä¸€ç§è¯­è¨€ç¿»è¯‘æˆå¦ä¸€ç§è¯­è¨€ã€‚\n\nfrom transformers import pipeline\n\ntranslator = pipeline('translation_en_to_fr', device = device)\nresult = translator(\"Hello, how are you?\")\npprint(result)\n\n[{'translation_text': 'Bonjour, comment Ãªtes-vous?'}]\n\n\n\n\n4.3.6 æ–‡æœ¬æ‘˜è¦ (summarization)\nç”¨äºå¯¹é•¿æ–‡æœ¬è¿›è¡Œæ‘˜è¦ï¼Œæå–ä¸»è¦å†…å®¹ã€‚\n\nfrom transformers import pipeline\n\nsummarizer = pipeline('summarization', device = device)\nresult = summarizer(\"Hugging Face is creating a tool that democratizes AI. The library will support various tasks and models.\")\npprint(result)\n\n[{'summary_text': ' Hugging Face is creating a tool that democratizes AI . The '\n                  'library will support various tasks and models . Hugging '\n                  'face is creating an AI tool that can be used to help people '\n                  'learn more about AI . It will be available in the U.S. for '\n                  'free .'}]",
    "crumbs": [
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>Hugging Face</span>"
    ]
  },
  {
    "objectID": "huggingface.html#è¿è¡Œæœºåˆ¶",
    "href": "huggingface.html#è¿è¡Œæœºåˆ¶",
    "title": "4Â  Hugging Face",
    "section": "4.4 è¿è¡Œæœºåˆ¶",
    "text": "4.4 è¿è¡Œæœºåˆ¶\nä½¿ç”¨ Hugging Face çš„ pipeline è¿è¡Œä»»åŠ¡æ—¶ï¼Œä»»åŠ¡é»˜è®¤æ˜¯åœ¨æœ¬åœ°æ‰§è¡Œçš„ã€‚\nå½“ä½ ä½¿ç”¨ pipeline å‡½æ•°æ—¶ï¼Œå®ƒä¼šåŠ è½½ä¸€ä¸ªé¢„è®­ç»ƒçš„æ¨¡å‹ï¼ˆå¯ä»¥æ˜¯ Hugging Face Hub ä¸Šçš„æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä½ æœ¬åœ°çš„æ¨¡å‹ï¼‰ï¼Œç„¶ååœ¨ä½ çš„æœ¬åœ°æœºå™¨ä¸Šæ‰§è¡Œæ¨ç†ä»»åŠ¡ã€‚è¿™æ„å‘³ç€æ‰€æœ‰è®¡ç®—éƒ½æ˜¯åœ¨ä½ çš„æœ¬åœ°è®¡ç®—æœºä¸Šè¿›è¡Œçš„ï¼Œè€Œä¸æ˜¯åœ¨ Hugging Face çš„æœåŠ¡å™¨ä¸Šè¿›è¡Œçš„ã€‚\nä¸è¿‡ï¼Œpipeline ä¹Ÿå¯ä»¥è®¿é—®åœ¨çº¿çš„æ¨¡å‹å­˜å‚¨åº“ã€‚å¦‚æœä½ æŒ‡å®šäº†ä¸€ä¸ªåœ¨çº¿æ¨¡å‹ï¼ˆä¾‹å¦‚ Hugging Face Hub ä¸Šçš„æŸä¸ªæ¨¡å‹ï¼‰ï¼Œé‚£ä¹ˆ pipeline ä¼šå…ˆä»åœ¨çº¿å­˜å‚¨åº“ä¸‹è½½æ¨¡å‹åˆ°æœ¬åœ°ï¼Œç„¶ååœ¨æœ¬åœ°è¿è¡Œæ¨ç†ä»»åŠ¡ã€‚å› æ­¤ï¼Œå³ä½¿ä½ è®¿é—®çš„æ˜¯åœ¨çº¿æ¨¡å‹ï¼Œæ‰§è¡Œè¿‡ç¨‹ä»ç„¶æ˜¯åœ¨æœ¬åœ°å®Œæˆçš„ã€‚\næœ¬åœ°è¿è¡Œæ¨ç†ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ‰§è¡Œæ‰¹å¤„ç†ä»»åŠ¡ã€‚\n\nfrom transformers import pipeline\n\nclassifier = pipeline(\"sentiment-analysis\", device=device)\n\nresults = classifier([\"We are very happy to show you the ğŸ¤— Transformers library.\", \"We hope you don't hate it.\"])\nfor result in results:\n    print(f\"label: {result['label']}, with score: {round(result['score'], 4)}\")\n\nlabel: POSITIVE, with score: 0.9998\nlabel: NEGATIVE, with score: 0.5309\n\n\n\n4.4.1 é…ç½®æ¨¡å‹å’Œå‚æ•°\npipeline ä¼šè‡ªåŠ¨ä¸‹è½½å’Œä½¿ç”¨é»˜è®¤çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚ä½†æ˜¯æœ‰äº›ä»»åŠ¡å¯èƒ½æ²¡æœ‰æŒ‡å®šæ¨¡å‹ï¼Œè¿™æ—¶å€™å°±éœ€è¦é…ç½®æ¨¡å‹å‚æ•°ã€‚æ­¤å¤–ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨ç‰¹å®šçš„æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥åœ¨ pipeline æ„é€ å‡½æ•°ä¸­æŒ‡å®šæ¨¡å‹åç§°ã€‚\npipeline ä¼šæ ¹æ®ä»»åŠ¡ç±»å‹è‡ªåŠ¨å¤„ç†è¾“å…¥å’Œè¾“å‡ºã€‚ä¾‹å¦‚ï¼Œæ–‡æœ¬åˆ†ç±»ä»»åŠ¡çš„è¾“å‡ºé€šå¸¸æ˜¯æ¯ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œè€Œç¿»è¯‘ä»»åŠ¡çš„è¾“å‡ºæ˜¯ç¿»è¯‘åçš„æ–‡æœ¬ã€‚å¦‚æœæä¾›çš„ä»»åŠ¡åç§°ä¸æ­£ç¡®ï¼Œpipeline å¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ã€‚å¦‚æœæ¨¡å‹ä¸é€‚åˆç‰¹å®šä»»åŠ¡ï¼Œä¹Ÿå¯èƒ½ä¼šå¾—åˆ°ä¸å‡†ç¡®çš„ç»“æœæˆ–é‡åˆ°è¿è¡Œæ—¶é”™è¯¯ã€‚\nä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é’ˆå¯¹ ZeroShotClassificationPipeline ä»»åŠ¡æŒ‡å®šä½¿ç”¨äº† Facebook çš„ bart-large-mnli æ¨¡å‹ã€‚\n\noracle = pipeline(\"zero-shot-classification\", \n                  model=\"facebook/bart-large-mnli\",\n                  device=device)\noracle(\n    \"I have a problem with my iphone that needs to be resolved asap!!\",\n    candidate_labels=[\"urgent\", \"not urgent\", \"phone\", \"tablet\", \"computer\"],\n)\n\n{'sequence': 'I have a problem with my iphone that needs to be resolved asap!!',\n 'labels': ['urgent', 'phone', 'computer', 'not urgent', 'tablet'],\n 'scores': [0.5036347508430481,\n  0.47880011796951294,\n  0.012600583024322987,\n  0.0026557755190879107,\n  0.002308781025931239]}\n\n\n\noracle(\n    \"I have a problem with my iphone that needs to be resolved asap!!\",\n    candidate_labels=[\"english\", \"german\"],\n)\n\n{'sequence': 'I have a problem with my iphone that needs to be resolved asap!!',\n 'labels': ['english', 'german'],\n 'scores': [0.8135165572166443, 0.18648339807987213]}\n\n\næ•´ä¸ªæµç¨‹ä»¥åŠæœ¬åœ°æ¨¡å‹çš„å®‰è£…å’Œè¿è¡Œæƒ…å†µï¼š\n\næ¨¡å‹ä¸‹è½½ï¼š\n\nå½“ä½ æŒ‡å®š model=\"facebook/bart-large-mnli\" æ—¶ï¼ŒHugging Face çš„ transformers åº“ä¼šä» Hugging Face Hub ä¸‹è½½è¿™ä¸ªé¢„è®­ç»ƒæ¨¡å‹ï¼ˆfacebook/bart-large-mnliï¼‰ã€‚\næ¨¡å‹ä¸‹è½½åï¼Œä¼šè¢«å­˜å‚¨åœ¨ä½ çš„æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œé»˜è®¤ä½ç½®é€šå¸¸æ˜¯ ~/.cache/huggingface/transformers/ ç›®å½•ä¸‹ã€‚å¦‚æœä½ æœ‰è‡ªå®šä¹‰çš„ç¼“å­˜ç›®å½•è®¾ç½®ï¼Œæ¨¡å‹å°†ä¸‹è½½åˆ°æŒ‡å®šä½ç½®ã€‚\n\næ¨¡å‹åŠ è½½ï¼š\n\nä¸‹è½½å®Œæˆåï¼Œpipeline ä¼šå°†è¯¥æ¨¡å‹åŠ è½½åˆ°å†…å­˜ä¸­ã€‚è¿™åŒ…æ‹¬æ¨¡å‹çš„æƒé‡ã€é…ç½®æ–‡ä»¶ä»¥åŠä¸ä¹‹ç›¸å…³çš„è¯æ±‡è¡¨ï¼ˆtokenizerï¼‰ã€‚\n\nä»»åŠ¡æ‰§è¡Œï¼š\n\nå½“ä½ ä½¿ç”¨ oracle è¿™ä¸ª pipeline å¯¹è±¡æ¥è¿›è¡Œé›¶æ ·æœ¬åˆ†ç±»ä»»åŠ¡æ—¶ï¼Œæ‰€æœ‰çš„è®¡ç®—å’Œæ¨ç†ï¼ˆinferenceï¼‰éƒ½æ˜¯åœ¨ä½ çš„æœ¬åœ°æœºå™¨ä¸Šæ‰§è¡Œçš„ã€‚è¿™åŒ…æ‹¬æ–‡æœ¬çš„é¢„å¤„ç†ã€æ¨¡å‹çš„å‰å‘ä¼ æ’­è®¡ç®—ã€ä»¥åŠåå¤„ç†å’Œè¾“å‡ºç»“æœã€‚\n\n\n\n\n4.4.2 æœ¬åœ°æ¨¡å‹çš„å­˜å‚¨å’Œç®¡ç†\n\nå­˜å‚¨ä½ç½®ï¼šæ¨¡å‹çš„æƒé‡æ–‡ä»¶ã€é…ç½®æ–‡ä»¶å’Œè¯æ±‡è¡¨ä¼šå­˜å‚¨åœ¨ ~/.cache/huggingface/hub/ ä¸‹çš„ä¸€ä¸ªä»¥æ¨¡å‹åç§°å‘½åçš„ç›®å½•ä¸­ã€‚ä¾‹å¦‚ï¼š~/.cache/huggingface/hub/models--facebook--bart-large-mnli/ã€‚\nç¼“å­˜æœºåˆ¶ï¼šå¦‚æœä½ å†æ¬¡ä½¿ç”¨åŒä¸€ä¸ªæ¨¡å‹ï¼ˆå¦‚ facebook/bart-large-mnliï¼‰ï¼Œpipeline ä¼šç›´æ¥ä»æœ¬åœ°ç¼“å­˜ä¸­åŠ è½½æ¨¡å‹ï¼Œè€Œä¸ä¼šå†æ¬¡ä» Hugging Face Hub ä¸‹è½½ï¼Œé™¤éä½ æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜æˆ–æŒ‡å®šä¸‹è½½æ–°çš„æ¨¡å‹ç‰ˆæœ¬ã€‚\n\n\n\n4.4.3 é…ç½®ä¸€ä¸ªç¿»è¯‘å™¨\nä¸Šé¢æˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªç¿»è¯‘å™¨ï¼Œå°†è‹±æ–‡ç¿»è¯‘ä¸ºæ³•æ–‡ã€‚\n\nen_fr_translator = pipeline(\"translation_en_to_fr\", device=device)\nen_fr_translator(\"How old are you?\")\n\n[{'translation_text': ' quel Ã¢ge Ãªtes-vous?'}]\n\n\nä¸è¿‡ï¼Œè°ƒç”¨ pipeline(\"tranlation_en_to_zh\") å´ä¼šå‡ºé”™ã€‚è¿™æ˜¯å› ä¸ºï¼šè™½ç„¶ â€œtranslation_en_to_zhâ€ æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ä»»åŠ¡æ ‡è¯†ç¬¦ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ç›´æ¥æŒ‡å®šæ¨¡å‹çš„åç§°ã€‚è¿™æ—¶ï¼Œéœ€è¦æ˜¾å¼æŒ‡å®šæ¨¡å‹åç§°æ¥é¿å…è¿™ç§æƒ…å†µï¼š\n\n\n\n\n\n\nNote\n\n\n\nè¿™é‡Œè¿˜éœ€è¦å®‰è£…ä¸€ä¸ªç¼ºå¤±çš„æ¨¡å—ï¼šSentencePieceã€‚\nSentencePiece æ˜¯ä¸€ä¸ªç”¨äºæ–‡æœ¬åˆ†è¯å’Œè¯æ±‡ç”Ÿæˆçš„å·¥å…·ï¼Œå®ƒåœ¨è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ä»»åŠ¡ä¸­éå¸¸æœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨è®­ç»ƒå’Œä½¿ç”¨åŸºäºå­è¯å•å…ƒçš„æ¨¡å‹æ—¶ã€‚SentencePiece ç”± Google å¼€å‘ï¼Œä½œä¸ºä¸€ç§æ— è¯­è¨€ä¾èµ–çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥å¤„ç†å‡ ä¹ä»»ä½•è¯­è¨€çš„æ–‡æœ¬æ•°æ®ã€‚\nSentencePiece çš„ä¸»è¦åŠŸèƒ½\n\nå­è¯å•å…ƒï¼ˆSubword Unitsï¼‰ç”Ÿæˆ:\n\nSentencePiece ä¸ä¾èµ–äºè¯­è¨€çš„ç‰¹å®šè¯æ±‡è¡¨ï¼Œè€Œæ˜¯é€šè¿‡æ•°æ®é©±åŠ¨çš„æ–¹æ³•ç”Ÿæˆå­è¯å•å…ƒã€‚å®ƒé€šè¿‡åˆ†æè®­ç»ƒæ•°æ®ä¸­çš„å¸¸è§å­—ç¬¦åºåˆ—ï¼Œç”Ÿæˆé€‚åˆè¯¥æ•°æ®é›†çš„å­è¯å•å…ƒï¼Œè¿™äº›å­è¯å•å…ƒå¯ä»¥æ˜¯å®Œæ•´çš„è¯ã€è¯çš„ä¸€éƒ¨åˆ†ï¼ˆå¦‚è¯ç¼€ã€è¯æ ¹ï¼‰ã€ç”šè‡³æ˜¯å•ä¸ªå­—ç¬¦ã€‚\nè¿™åœ¨å¤„ç†ä½èµ„æºè¯­è¨€æˆ–å¤šè¯­è¨€ä»»åŠ¡æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥ç”Ÿæˆè·¨è¯­è¨€çš„ç»Ÿä¸€è¯æ±‡è¡¨ï¼Œå‡å°‘OOVï¼ˆOut of Vocabularyï¼Œè¯æ±‡è¡¨å¤–çš„è¯ï¼‰é—®é¢˜ã€‚\n\nBPEï¼ˆByte-Pair Encodingï¼‰å’Œ Unigram æ¨¡å‹:\n\nSentencePiece æ”¯æŒå¤šç§å­è¯åˆ†å‰²æ–¹æ³•ï¼ŒåŒ…æ‹¬ BPEï¼ˆByte-Pair Encodingï¼‰å’Œ Unigram æ¨¡å‹ã€‚BPE æ˜¯ä¸€ç§å¸¸ç”¨çš„å­è¯åˆ†å‰²ç®—æ³•ï¼Œé€šè¿‡é¢‘ç¹åœ°åˆå¹¶å­—ç¬¦å¯¹æ¥ç”Ÿæˆå­è¯å•å…ƒã€‚Unigram æ¨¡å‹åˆ™æ˜¯ä¸€ç§åŸºäºæ¦‚ç‡çš„æ¨¡å‹ï¼Œå®ƒæ ¹æ®å­è¯å•å…ƒçš„æ¦‚ç‡æ¥åˆ†å‰²æ–‡æœ¬ã€‚\n\nè¯­è¨€æ— å…³æ€§:\n\nä¸ä¼ ç»Ÿçš„åˆ†è¯å™¨ä¸åŒï¼ŒSentencePiece ä¸éœ€è¦ä¾èµ–äºç©ºæ ¼æˆ–å…¶ä»–ç‰¹å®šçš„æ ‡è®°æ¥åˆ†å‰²è¯è¯­ã€‚è¿™ä½¿å¾—å®ƒåœ¨å¤„ç†æ²¡æœ‰æ˜ç¡®å•è¯è¾¹ç•Œçš„è¯­è¨€ï¼ˆå¦‚ä¸­æ–‡ã€æ—¥æ–‡ã€æ³°è¯­ç­‰ï¼‰æ—¶éå¸¸æœ‰æ•ˆã€‚\n\nå¤„ç†æœªå½’ä¸€åŒ–çš„æ–‡æœ¬:\n\nSentencePiece å¯ä»¥ç›´æ¥å¤„ç†æœªç»å½’ä¸€åŒ–çš„åŸå§‹æ–‡æœ¬ï¼ˆå¦‚å¸¦æœ‰æ ‡ç‚¹ç¬¦å·çš„æ–‡æœ¬ï¼‰ï¼Œè¿™åœ¨å®é™…åº”ç”¨ä¸­éå¸¸æœ‰ç”¨ï¼Œé¿å…äº†å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†çš„éœ€æ±‚ã€‚\n\n\nä½¿ç”¨ SentencePiece çš„åœºæ™¯\n\næœºå™¨ç¿»è¯‘: åœ¨è®­ç»ƒæœºå™¨ç¿»è¯‘æ¨¡å‹æ—¶ï¼Œä½¿ç”¨ SentencePiece å¯ä»¥å°†è¾“å…¥å’Œè¾“å‡ºæ–‡æœ¬åˆ†å‰²æˆå­è¯å•å…ƒï¼Œå‡å°‘è¯æ±‡è¡¨å¤§å°ï¼Œå¹¶æé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚\né¢„è®­ç»ƒè¯­è¨€æ¨¡å‹: è¯¸å¦‚ BERTã€GPTã€T5 ç­‰æ¨¡å‹åœ¨é¢„è®­ç»ƒæ—¶ï¼Œé€šå¸¸ä½¿ç”¨ SentencePiece ç”Ÿæˆå­è¯å•å…ƒè¯æ±‡è¡¨ï¼Œè¿™äº›è¯æ±‡è¡¨æœ‰åŠ©äºå¤„ç†å¤šè¯­è¨€æ•°æ®å’Œç¨€æœ‰è¯æ±‡ã€‚\næ–‡æœ¬ç”Ÿæˆ: åœ¨ç”Ÿæˆä»»åŠ¡ä¸­ï¼Œå­è¯å•å…ƒå¯ä»¥æ›´å¥½åœ°è¡¨ç¤ºç¨€æœ‰æˆ–é•¿å°¾è¯æ±‡ï¼Œå‡å°‘ç”Ÿæˆè¿‡ç¨‹ä¸­å‡ºç°çš„OOVé—®é¢˜ã€‚\n\nSentencePiece æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åˆ†è¯å·¥å…·ï¼Œå®ƒé€šè¿‡ç”Ÿæˆæ•°æ®é©±åŠ¨çš„å­è¯å•å…ƒè¯æ±‡è¡¨ï¼Œåœ¨ NLP ä»»åŠ¡ä¸­å¹¿æ³›ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤šè¯­è¨€æ–‡æœ¬å’Œè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹æ—¶ã€‚\n\n\n\ntranslator = pipeline(\"translation_en_to_zh\",\n                      model=\"Helsinki-NLP/opus-mt-en-zh\", device=device)\ntranslator(\"This is a introduction to Huggingface.\")\n\n[{'translation_text': 'è¿™æ˜¯å“ˆggingfaceçš„ä»‹ç»ã€‚'}]\n\n\nç»“æœå¾ˆä¸€èˆ¬ã€‚è¿™æ˜¯å› ä¸ºç¿»è¯‘ä»»åŠ¡ä¸ä»…éœ€è¦æ¨¡å‹æ”¯æŒï¼Œè¿˜éœ€è¦æœ‰ä¸€ä¸ªä¸­æ–‡çš„åˆ†è¯å™¨ã€‚è€Œé»˜è®¤çš„åˆ†è¯å™¨ä¸é€‚åˆè¿›è¡Œä¸­æ–‡åˆ†è¯çš„ä»»åŠ¡ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬ä¼˜åŒ–ä¸€ä¸‹åˆ†è¯å™¨çš„è®¾ç½®ã€‚\n\nfrom transformers import AutoModelWithLMHead,AutoTokenizer,pipeline\nmode_name = 'liam168/trans-opus-mt-en-zh'\nmodel = AutoModelWithLMHead.from_pretrained(mode_name)\ntokenizer = AutoTokenizer.from_pretrained(mode_name)\ntranslation = pipeline(\"translation_en_to_zh\", \n                      model=model, \n                      tokenizer=tokenizer, device=device)\ntranslation('This is a introduction to Huggingface.')\n\n[{'translation_text': 'è¿™æ˜¯\"æŠ±èµ·è„¸\"çš„å¼•è¨€'}]\n\n\nè®©æˆ‘ä»¬é€è¡Œè§£é‡Šä»£ç çš„å«ä¹‰ï¼š\nfrom transformers import AutoModelWithLMHead, AutoTokenizer, pipeline\n\nAutoModelWithLMHead: è¿™æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŠ è½½è¯­è¨€æ¨¡å‹ï¼ˆLanguage Modelï¼‰çš„ç±»ï¼Œé€šå¸¸ç”¨äºåŠ è½½å¸¦æœ‰è¯­è¨€å»ºæ¨¡å¤´çš„æ¨¡å‹ã€‚LMHead ä»£è¡¨è¯­è¨€æ¨¡å‹çš„è¾“å‡ºå±‚ã€‚\nAutoTokenizer: è¿™æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŠ è½½é€‚å½“çš„åˆ†è¯å™¨ï¼ˆtokenizerï¼‰çš„ç±»ã€‚åˆ†è¯å™¨ç”¨äºå°†è¾“å…¥æ–‡æœ¬è½¬æ¢ä¸ºæ¨¡å‹å¯ä»¥å¤„ç†çš„ä»¤ç‰Œï¼ˆtokensï¼‰åºåˆ—ã€‚\npipeline: è¿™æ˜¯ Hugging Face çš„é«˜å±‚ APIï¼Œå®ƒæä¾›äº†å„ç§ NLP ä»»åŠ¡çš„é¢„å®šä¹‰ç®¡é“ï¼ˆpipelineï¼‰ï¼Œå¦‚æ–‡æœ¬åˆ†ç±»ã€ç¿»è¯‘ã€æ–‡æœ¬ç”Ÿæˆç­‰ã€‚\n\nmode_name = 'liam168/trans-opus-mt-en-zh'\n\nmode_name: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å˜é‡ï¼Œå­˜å‚¨äº†æ¨¡å‹çš„åç§°æˆ–è·¯å¾„ã€‚è¿™é‡Œçš„ liam168/trans-opus-mt-en-zh æ˜¯åœ¨ Hugging Face æ¨¡å‹åº“ä¸­çš„ä¸€ä¸ªæ¨¡å‹åç§°ï¼Œè¡¨ç¤ºä¸€ä¸ªé¢„è®­ç»ƒçš„ä»è‹±è¯­åˆ°ä¸­æ–‡ç¿»è¯‘çš„æ¨¡å‹ã€‚\n\nmodel = AutoModelWithLMHead.from_pretrained(mode_name)\n\nAutoModelWithLMHead.from_pretrained(mode_name): è¿™è¡Œä»£ç åŠ è½½äº† liam168/trans-opus-mt-en-zh æ¨¡å‹çš„é¢„è®­ç»ƒæƒé‡å’Œé…ç½®ã€‚from_pretrained æ–¹æ³•ä» Hugging Face çš„æ¨¡å‹åº“ä¸‹è½½ï¼ˆå¦‚æœå°šæœªä¸‹è½½ï¼‰å¹¶åŠ è½½è¯¥æ¨¡å‹åˆ°å†…å­˜ä¸­ã€‚\n\ntokenizer = AutoTokenizer.from_pretrained(mode_name)\n\nAutoTokenizer.from_pretrained(mode_name): è¿™è¡Œä»£ç åŠ è½½äº†ä¸æ¨¡å‹é…å¥—çš„åˆ†è¯å™¨ã€‚åˆ†è¯å™¨å°†è¾“å…¥çš„è‹±æ–‡å¥å­è½¬æ¢ä¸ºæ¨¡å‹æ‰€éœ€çš„ä»¤ç‰Œï¼ˆtokensï¼‰ï¼Œå¹¶ä¸”ä¼šæ‰§è¡Œå¿…è¦çš„æ–‡æœ¬é¢„å¤„ç†ã€‚\n\ntranslation = pipeline(\"translation_en_to_zh\", model=model, tokenizer=tokenizer)\n\npipeline(\"translation_en_to_zh\", model=model, tokenizer=tokenizer): è¿™é‡Œä½¿ç”¨äº† pipeline å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªç¿»è¯‘ç®¡é“ï¼ŒæŒ‡å®šäº†ä»»åŠ¡ç±»å‹ä¸º \"translation_en_to_zh\"ï¼ˆä»è‹±è¯­åˆ°ä¸­æ–‡çš„ç¿»è¯‘ï¼‰ï¼Œå¹¶ä¼ å…¥äº†ä¹‹å‰åŠ è½½çš„æ¨¡å‹å’Œåˆ†è¯å™¨ã€‚è¿™ä¸ªç®¡é“å°è£…äº†ç¿»è¯‘ä»»åŠ¡çš„æ‰€æœ‰æ­¥éª¤ï¼Œä½¿å¾—ç¿»è¯‘æ–‡æœ¬å˜å¾—ç®€å•ä¸”æ˜“äºä½¿ç”¨ã€‚\n\ntranslation('This is a introduction to Huggingface.')\n\ntranslation('This is a introduction to Huggingface.'): è¿™è¡Œä»£ç è°ƒç”¨äº†ç¿»è¯‘ç®¡é“ï¼Œå°†è¾“å…¥çš„è‹±æ–‡å¥å­ \"This is a introduction to Huggingface.\" ç¿»è¯‘ä¸ºä¸­æ–‡ã€‚ç®¡é“ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š\n\nä½¿ç”¨ tokenizer å°†è¾“å…¥çš„è‹±æ–‡å¥å­åˆ†è¯ä¸ºä»¤ç‰Œã€‚\nå°†ä»¤ç‰Œè¾“å…¥åˆ° model ä¸­è¿›è¡Œç¿»è¯‘ã€‚\nç”Ÿæˆçš„ä¸­æ–‡ä»¤ç‰Œåºåˆ—è¢«è§£ç æˆè‡ªç„¶è¯­è¨€æ–‡æœ¬ã€‚\n\n\næœ€ç»ˆè¾“å‡ºä¼šæ˜¯ \"This is a introduction to Huggingface.\" çš„ä¸­æ–‡ç¿»è¯‘ç‰ˆæœ¬ï¼Œä¾‹å¦‚ \"è¿™æ˜¯å¯¹ Huggingface çš„ä»‹ç»ã€‚\"ï¼ˆå…·ä½“ç¿»è¯‘ç»“æœå¯èƒ½æœ‰æ‰€ä¸åŒï¼Œå–å†³äºæ¨¡å‹çš„æ€§èƒ½ï¼‰ã€‚\nè¿™æ®µä»£ç é€šè¿‡åŠ è½½ Hugging Face æä¾›çš„é¢„è®­ç»ƒæ¨¡å‹å’Œåˆ†è¯å™¨ï¼Œå®ç°äº†ä»è‹±è¯­åˆ°ä¸­æ–‡çš„è‡ªåŠ¨ç¿»è¯‘ä»»åŠ¡ï¼Œå¹¶ä¸”é€šè¿‡ä½¿ç”¨é«˜å±‚çš„ pipeline APIï¼Œç®€åŒ–äº†ç¿»è¯‘ä»»åŠ¡çš„æ‰§è¡Œã€‚",
    "crumbs": [
      "<span class='chapter-number'>4</span>Â  <span class='chapter-title'>Hugging Face</span>"
    ]
  },
  {
    "objectID": "huggingface-models.html",
    "href": "huggingface-models.html",
    "title": "5Â  Hugging Face Model",
    "section": "",
    "text": "5.1 ä¸¤ç§è°ƒç”¨æ¨¡å‹çš„æ–¹å¼\næŸ¥æ‰¾ GPU è®¾å¤‡ã€‚\nimport torch\nfrom pprint import pprint\n\n# select the device for computation\nif torch.cuda.is_available():\n    device = torch.device(\"cuda\")\nelif torch.backends.mps.is_available():\n    device = torch.device(\"mps\")\nelse:\n    device = torch.device(\"cpu\")\n\nprint(f\"using device: {device}\")\n\nusing device: mps\nå›¾ç‰‡æ•°æ®ã€‚\nimport io\nimport requests\nfrom PIL import Image\n\nurl = \"http://images.cocodataset.org/val2017/000000039769.jpg\"\nimage = Image.open(requests.get(url, stream=True).raw)",
    "crumbs": [
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>Hugging Face Model</span>"
    ]
  },
  {
    "objectID": "huggingface-models.html#ä¸¤ç§è°ƒç”¨æ¨¡å‹çš„æ–¹å¼",
    "href": "huggingface-models.html#ä¸¤ç§è°ƒç”¨æ¨¡å‹çš„æ–¹å¼",
    "title": "5Â  Hugging Face Model",
    "section": "",
    "text": "5.1.1 ä½¿ç”¨ Pipeline\n\n# Use a pipeline as a high-level helper\nfrom transformers import pipeline\n\nobject_detector = pipeline(\"object-detection\", model=\"facebook/detr-resnet-50\", device=device)\n\ndetection_results = object_detector(image)\npprint(detection_results)\n\n[{'box': {'xmax': 175, 'xmin': 40, 'ymax': 117, 'ymin': 70},\n  'label': 'remote',\n  'score': 0.9982202649116516},\n {'box': {'xmax': 368, 'xmin': 333, 'ymax': 187, 'ymin': 72},\n  'label': 'remote',\n  'score': 0.9960021376609802},\n {'box': {'xmax': 639, 'xmin': 0, 'ymax': 473, 'ymin': 1},\n  'label': 'couch',\n  'score': 0.9954743981361389},\n {'box': {'xmax': 314, 'xmin': 13, 'ymax': 470, 'ymin': 52},\n  'label': 'cat',\n  'score': 0.99880051612854},\n {'box': {'xmax': 640, 'xmin': 345, 'ymax': 368, 'ymin': 23},\n  'label': 'cat',\n  'score': 0.9986783862113953}]\n\n\n\n\n5.1.2 ç›´æ¥ä½¿ç”¨æ¨¡å‹\n\n# Load model directly\nfrom transformers import AutoImageProcessor, AutoModelForObjectDetection\n\nimage_processor = AutoImageProcessor.from_pretrained(\"facebook/detr-resnet-50\", device=device)\nmodel = AutoModelForObjectDetection.from_pretrained(\"facebook/detr-resnet-50\")",
    "crumbs": [
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>Hugging Face Model</span>"
    ]
  },
  {
    "objectID": "huggingface-models.html#å¯¹è±¡æ£€æµ‹",
    "href": "huggingface-models.html#å¯¹è±¡æ£€æµ‹",
    "title": "5Â  Hugging Face Model",
    "section": "5.2 å¯¹è±¡æ£€æµ‹",
    "text": "5.2 å¯¹è±¡æ£€æµ‹\nDEtection TRansformerï¼ˆDETRï¼‰æ¨¡å‹ï¼Œé€šè¿‡ç«¯åˆ°ç«¯è®­ç»ƒåœ¨ COCO 2017 å¯¹è±¡æ£€æµ‹æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼ˆåŒ…å« 118K å¼ æ ‡æ³¨å›¾åƒï¼‰ã€‚\nDETR æ¨¡å‹æ˜¯ä¸€ç§å…·æœ‰å·ç§¯éª¨å¹²çš„ç¼–ç å™¨-è§£ç å™¨å˜æ¢å™¨ã€‚åœ¨è§£ç å™¨è¾“å‡ºä¹‹ä¸Šæ·»åŠ äº†ä¸¤ä¸ªå¤´éƒ¨ï¼Œä»¥æ‰§è¡Œå¯¹è±¡æ£€æµ‹ï¼šä¸€ä¸ªçº¿æ€§å±‚ç”¨äºç±»åˆ«æ ‡ç­¾ï¼Œä¸€ä¸ªå¤šå±‚æ„ŸçŸ¥å™¨ï¼ˆMLPï¼‰ç”¨äºè¾¹ç•Œæ¡†ã€‚è¯¥æ¨¡å‹ä½¿ç”¨æ‰€è°“çš„å¯¹è±¡æŸ¥è¯¢æ¥æ£€æµ‹å›¾åƒä¸­çš„å¯¹è±¡ã€‚æ¯ä¸ªå¯¹è±¡æŸ¥è¯¢éƒ½åœ¨å¯»æ‰¾å›¾åƒä¸­çš„ç‰¹å®šå¯¹è±¡ã€‚å¯¹äº COCOï¼Œè®¾ç½®çš„å¯¹è±¡æŸ¥è¯¢æ•°é‡ä¸º 100ã€‚\næ¨¡å‹ä½¿ç”¨â€œäºŒéƒ¨åŒ¹é…æŸå¤±â€è¿›è¡Œè®­ç»ƒï¼šå°†é¢„æµ‹çš„ N=100 ä¸ªå¯¹è±¡æŸ¥è¯¢ä¸­çš„æ¯ä¸ªç±»åˆ«çš„é¢„æµ‹æ¡†ä¸ ground truth æ³¨é‡Šè¿›è¡Œæ¯”è¾ƒï¼Œå¡«å……åˆ°ç›¸åŒçš„é•¿åº¦ Nï¼ˆå¦‚æœä¸€å¼ å›¾ç‰‡åªåŒ…å« 4 ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆ 96 ä¸ªæ³¨é‡Šå°†åªæ˜¯â€œæ— å¯¹è±¡â€ä½œä¸ºç±»åˆ«ï¼Œâ€œæ— æ¡†â€ä½œä¸ºæ¡†ï¼‰ã€‚åŒˆç‰™åˆ©åŒ¹é…ç®—æ³•ç”¨äºåœ¨æ¯ä¸ª N æŸ¥è¯¢å’Œæ¯ä¸ª N æ³¨é‡Šä¹‹é—´åˆ›å»ºæœ€ä¼˜çš„ä¸€å¯¹ä¸€æ˜ å°„ã€‚æ¥ä¸‹æ¥ï¼Œä½¿ç”¨æ ‡å‡†äº¤å‰ç†µï¼ˆå¯¹äºç±»åˆ«ï¼‰ä»¥åŠ L1 å’Œé€šç”¨ IoU æŸå¤±çš„çº¿æ€§ç»„åˆï¼ˆå¯¹äºæ¡†ï¼‰æ¥ä¼˜åŒ–æ¨¡å‹å‚æ•°ã€‚\nä¸‹é¢æ˜¯ä½¿ç”¨ç¬¬ä¸€ç§è°ƒç”¨æ–¹å¼è°ƒç”¨ DETR æ¨¡å‹æ—¶ç»“æœçš„å¤„ç†ç¤ºä¾‹ã€‚\n\nimport matplotlib.pyplot as plt\nfrom PIL import Image\nimport numpy as np\nimport matplotlib.patches as patches\n\ndef random_color():\n    \"\"\"Generate a random color.\"\"\"\n    return np.random.rand(3,)\n\n# Create a figure and axis for plotting\nfig, ax = plt.subplots(1, 1, figsize=(12, 8))\n\n# Display the original image\nax.imshow(image)\n\n# Overlay bounding boxes and labels with random colors\nfor result in detection_results:\n    score = result['score']\n    label = result['label']\n    box = result['box']\n    \n    # Generate a random color\n    color = random_color()\n    \n    # Draw bounding box\n    rect = patches.Rectangle(\n        (box['xmin'], box['ymin']),\n        box['xmax'] - box['xmin'],\n        box['ymax'] - box['ymin'],\n        linewidth=2,\n        edgecolor=color,\n        facecolor='none'\n    )\n    ax.add_patch(rect)\n    \n    # Draw label and score with the same color as the rectangle\n    label_text = f\"{label}: {score:.2f}\"\n    ax.text(\n        box['xmin'],\n        box['ymin'] - 10,\n        label_text,\n        color=color,\n        fontsize=12,\n        bbox=dict(facecolor='white', alpha=0.5, \n                  edgecolor=color, boxstyle='round,pad=0.5')\n    )\n\n\n# Hide axis\nplt.axis('off')\n\n# Show the plot with bounding boxes and labels\nplt.show()\n\n\n\n\n\n\n\n\nä¸‹é¢æ˜¯å¯¹ç¬¬äºŒç§è°ƒç”¨æ–¹å¼ç»“æœå¤„ç†çš„æ–¹æ³•ã€‚\n\n# prepare image for the model\ninputs = image_processor(images=image, return_tensors=\"pt\")\n\n# forward pass\noutputs = model(**inputs)\n\n# convert outputs (bounding boxes and class logits) to COCO API\n# let's only keep detections with score &gt; 0.9\ntarget_sizes = torch.tensor([image.size[::-1]])\nresults = image_processor.post_process_object_detection(\n    outputs, \n    target_sizes=target_sizes, \n    threshold=0.9)[0]\n\nfor score, label, box in zip(results[\"scores\"], results[\"labels\"], results[\"boxes\"]):\n    box = [round(i, 2) for i in box.tolist()]\n    print(\n            f\"Detected {model.config.id2label[label.item()]} with confidence \"\n            f\"{round(score.item(), 3)} at location {box}\"\n    )\n\nDetected remote with confidence 0.998 at location [40.16, 70.81, 175.55, 117.98]\nDetected remote with confidence 0.996 at location [333.24, 72.55, 368.33, 187.66]\nDetected couch with confidence 0.995 at location [-0.02, 1.15, 639.73, 473.76]\nDetected cat with confidence 0.999 at location [13.24, 52.05, 314.02, 470.93]\nDetected cat with confidence 0.999 at location [345.4, 23.85, 640.37, 368.72]",
    "crumbs": [
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>Hugging Face Model</span>"
    ]
  },
  {
    "objectID": "huggingface-models.html#yolov8",
    "href": "huggingface-models.html#yolov8",
    "title": "5Â  Hugging Face Model",
    "section": "5.3 YOLOv8",
    "text": "5.3 YOLOv8\nYOLOv8 éœ€è¦ä½¿ç”¨ pip æˆ–è€… conda å®‰è£…ã€‚å®‰è£…åæä¾› cli å’Œ Python ç­‰ä¸¤ç§è¿è¡Œæ–¹å¼ã€‚è¯¦æƒ…å‚è§ï¼šhttps://docs.ultralytics.com/quickstart/ã€‚",
    "crumbs": [
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>Hugging Face Model</span>"
    ]
  },
  {
    "objectID": "huggingface-models.html#vit-å›¾åƒåˆ†ç±»",
    "href": "huggingface-models.html#vit-å›¾åƒåˆ†ç±»",
    "title": "5Â  Hugging Face Model",
    "section": "5.4 ViT å›¾åƒåˆ†ç±»",
    "text": "5.4 ViT å›¾åƒåˆ†ç±»\nThe Vision Transformerï¼ˆViTï¼‰æ˜¯ä¸€ç§ä»¥ç›‘ç£æ–¹å¼åœ¨å¤§é‡å›¾åƒé›†åˆï¼ˆå³ ImageNet - 21kï¼‰ä¸Šè¿›è¡Œé¢„è®­ç»ƒçš„ Transformer ç¼–ç å™¨æ¨¡å‹ï¼ˆç±»ä¼¼äº BERTï¼‰ï¼Œå›¾åƒåˆ†è¾¨ç‡ä¸º 224x224 åƒç´ ã€‚æ¥ä¸‹æ¥ï¼Œè¯¥æ¨¡å‹åœ¨ ImageNetï¼ˆä¹Ÿç§°ä¸º ILSVRC2012ï¼‰ä¸Šè¿›è¡Œå¾®è°ƒï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ…å« 100 ä¸‡å¼ å›¾åƒå’Œ 1000 ä¸ªç±»åˆ«çš„æ•°æ®é›†ï¼Œå›¾åƒåˆ†è¾¨ç‡åŒæ ·ä¸º 224x224ã€‚\nå›¾åƒä½œä¸ºä¸€ç³»åˆ—å›ºå®šå¤§å°çš„è¡¥ä¸ï¼ˆåˆ†è¾¨ç‡ä¸º 16x16ï¼‰å‘ˆç°ç»™æ¨¡å‹ï¼Œè¿™äº›è¡¥ä¸æ˜¯çº¿æ€§åµŒå…¥çš„ã€‚è¿˜åœ¨åºåˆ—å¼€å¤´æ·»åŠ ä¸€ä¸ª[CLS]æ ‡è®°ï¼Œç”¨äºåˆ†ç±»ä»»åŠ¡ã€‚åœ¨å°†åºåˆ—è¾“å…¥åˆ° Transformer ç¼–ç å™¨çš„å±‚ä¹‹å‰ï¼Œè¿˜æ·»åŠ äº†ç»å¯¹ä½ç½®åµŒå…¥ã€‚\né€šè¿‡å¯¹æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒï¼Œå®ƒå­¦ä¹ åˆ°å›¾åƒçš„å†…éƒ¨è¡¨ç¤ºï¼Œç„¶åå¯ç”¨äºæå–å¯¹ä¸‹æ¸¸ä»»åŠ¡æœ‰ç”¨çš„ç‰¹å¾ï¼šä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªå¸¦æ ‡ç­¾å›¾åƒçš„æ•°æ®é›†ï¼Œåˆ™å¯ä»¥é€šè¿‡åœ¨é¢„è®­ç»ƒçš„ç¼–ç å™¨é¡¶éƒ¨æ”¾ç½®ä¸€ä¸ªçº¿æ€§å±‚æ¥è®­ç»ƒæ ‡å‡†åˆ†ç±»å™¨ã€‚é€šå¸¸ä¼šåœ¨ [CLS] æ ‡è®°çš„é¡¶éƒ¨æ”¾ç½®ä¸€ä¸ªçº¿æ€§å±‚ï¼Œå› ä¸ºæ­¤æ ‡è®°çš„æœ€åä¸€ä¸ªéšè—çŠ¶æ€å¯ä»¥è§†ä¸ºæ•´ä¸ªå›¾åƒçš„è¡¨ç¤ºã€‚\n\nimage_classifier = pipeline(\"image-classification\", \n                            model=\"google/vit-base-patch16-224\", \n                            device=device)\n\nclass_results = image_classifier(image)\npprint(class_results)\n\n[{'label': 'Egyptian cat', 'score': 0.9374417066574097},\n {'label': 'tabby, tabby cat', 'score': 0.038442544639110565},\n {'label': 'tiger cat', 'score': 0.014411404728889465},\n {'label': 'lynx, catamount', 'score': 0.003274324582889676},\n {'label': 'Siamese cat, Siamese', 'score': 0.000679593242239207}]",
    "crumbs": [
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>Hugging Face Model</span>"
    ]
  },
  {
    "objectID": "huggingface-models.html#vit-ç‰¹å¾æå–",
    "href": "huggingface-models.html#vit-ç‰¹å¾æå–",
    "title": "5Â  Hugging Face Model",
    "section": "5.5 ViT ç‰¹å¾æå–",
    "text": "5.5 ViT ç‰¹å¾æå–\nè§†è§‰è½¬æ¢å™¨ï¼ˆViTï¼‰æ¨¡å‹åœ¨ ImageNet-21k ä¸Šé¢„è®­ç»ƒï¼ŒåŒ…å« 1.4 äº¿å¼ å›¾ç‰‡å’Œ 21843 ä¸ªç±»åˆ«ã€‚å…¶åˆ†è¾¨ç‡ä¸º 224 x 224ã€‚\n\nfrom transformers import ViTImageProcessor, ViTModel\nfrom PIL import Image\nimport requests\n\nurl = 'http://images.cocodataset.org/val2017/000000039769.jpg'\nimage = Image.open(requests.get(url, stream=True).raw)\n\nprocessor = ViTImageProcessor.from_pretrained('google/vit-base-patch16-224-in21k')\nmodel = ViTModel.from_pretrained('google/vit-base-patch16-224-in21k')\ninputs = processor(images=image, return_tensors=\"pt\")\n\noutputs = model(**inputs)\nlast_hidden_states = outputs.last_hidden_state\n\nBaseModelOutputWithPooling æ˜¯ Hugging Face çš„ transformers åº“ä¸­çš„ä¸€ä¸ªç±»ï¼Œç”¨äºæ¨¡å‹è¾“å‡ºçš„è¡¨ç¤ºã€‚è¿™ä¸ªç±»é€šå¸¸åœ¨æ¨¡å‹è¿”å›çš„è¾“å‡ºä¸­åŒ…å«äº†æ± åŒ–å±‚çš„ç»“æœï¼Œè¿™å¯¹äºä¸€äº›ä»»åŠ¡ï¼Œæ¯”å¦‚æ–‡æœ¬åˆ†ç±»æˆ–åµŒå…¥ç”Ÿæˆï¼Œç‰¹åˆ«æœ‰ç”¨ã€‚\n\n5.5.1 ä¸»è¦åŠŸèƒ½\nBaseModelOutputWithPooling ç±»æ˜¯ä» BaseModelOutput æ´¾ç”Ÿè€Œæ¥çš„ï¼Œå®ƒåŒ…å«ä»¥ä¸‹å‡ ä¸ªé‡è¦çš„ç»„ä»¶ï¼š\n\nlast_hidden_stateï¼šæ¨¡å‹åœ¨æ‰€æœ‰éšè—å±‚çš„è¾“å‡ºï¼Œè¿™äº›è¾“å‡ºé€šå¸¸ç”¨äºè·å–åºåˆ—çš„ç‰¹å¾è¡¨ç¤ºã€‚\npooler_outputï¼šç»è¿‡æ± åŒ–å±‚ï¼ˆé€šå¸¸æ˜¯æ± åŒ–åçš„ç¬¬ä¸€ä¸ª tokenï¼‰çš„è¾“å‡ºï¼Œç”¨äºè·å¾—åºåˆ—çš„æ•´ä½“è¡¨ç¤ºã€‚å¯¹äº BERT ç­‰æ¨¡å‹ï¼Œè¿™é€šå¸¸æ˜¯ [CLS] token çš„è¾“å‡ºç»è¿‡æ± åŒ–æ“ä½œçš„ç»“æœã€‚\nhidden_statesï¼ˆå¯é€‰ï¼‰ï¼šæ¨¡å‹åœ¨æ¯ä¸ªéšè—å±‚çš„è¾“å‡ºï¼ˆå¦‚æœ output_hidden_states=True æ—¶ä¼šè¿”å›ï¼‰ã€‚\n\n\n\n5.5.2 ç”¨é€”\n\npooler_outputï¼šè¿™ä¸ªè¾“å‡ºæ˜¯ç”¨æ¥è·å–åºåˆ—çš„æ•´ä½“è¡¨ç¤ºçš„ï¼Œä¾‹å¦‚ç”¨äºåˆ†ç±»ä»»åŠ¡ã€‚å¯¹äºå¾ˆå¤šé¢„è®­ç»ƒæ¨¡å‹æ¥è¯´ï¼Œè¿™ä¸ªè¾“å‡ºæ˜¯å¯¹ [CLS] token çš„è¡¨ç¤ºç»è¿‡æ± åŒ–åçš„ç»“æœã€‚\nlast_hidden_stateï¼šå¦‚æœä½ éœ€è¦å¯¹æ¯ä¸ª token çš„è¡¨ç¤ºè¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†æˆ–åˆ†æï¼ˆä¾‹å¦‚ï¼Œè¿›è¡Œåºåˆ—æ ‡æ³¨ä»»åŠ¡ï¼‰ï¼Œè¿™ä¸ªè¾“å‡ºå°†æ˜¯æœ‰ç”¨çš„ã€‚\n\n\n\n5.5.3 ç¤ºä¾‹\nä»¥ä¸‹æ˜¯å¦‚ä½•åœ¨ä½¿ç”¨ Hugging Face æ¨¡å‹æ—¶ï¼Œåˆ©ç”¨ BaseModelOutputWithPooling è·å–æ¨¡å‹è¾“å‡ºçš„ä¸€ä¸ªä¾‹å­ï¼š\n\n# Extract the output\nlast_hidden_state = outputs.last_hidden_state  # Shape: [batch_size, sequence_length, hidden_size]\npooler_output = outputs.pooler_output  # Shape: [batch_size, hidden_size]\n\nprint(\"Last hidden state:\", last_hidden_state.shape)\nprint(\"Pooler output:\", pooler_output.shape)\n\nLast hidden state: torch.Size([1, 197, 768])\nPooler output: torch.Size([1, 768])\n\n\n\n\n5.5.4 è¯´æ˜ï¼š\n\nlast_hidden_stateï¼šé€šå¸¸æ˜¯ä¸‰ç»´å¼ é‡ï¼Œå½¢çŠ¶ä¸º [batch_size, sequence_length, hidden_size]ã€‚\npooler_outputï¼šé€šå¸¸æ˜¯äºŒç»´å¼ é‡ï¼Œå½¢çŠ¶ä¸º [batch_size, hidden_size]ï¼Œç”¨äºè¡¨ç¤ºæ•´ä¸ªåºåˆ—çš„ç‰¹å¾ã€‚\n\nBaseModelOutputWithPooling æ˜¯ä¸€ä¸ªç»“æ„åŒ–çš„è¿”å›å¯¹è±¡ï¼Œå¸®åŠ©ä½ ä»æ¨¡å‹ä¸­æå–æœ‰ç”¨çš„ç‰¹å¾è¡¨ç¤ºï¼Œç‰¹åˆ«æ˜¯å½“éœ€è¦å¤„ç†åºåˆ—æ•°æ®æ—¶ã€‚",
    "crumbs": [
      "<span class='chapter-number'>5</span>Â  <span class='chapter-title'>Hugging Face Model</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html",
    "href": "chatanywhere.html",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "",
    "text": "6.1 æ¨¡å‹åˆ—è¡¨\nChatAnyWhere æä¾›çš„æ¨¡å‹åå­—å¯èƒ½ä¼šä¸ OpenAI ä¸åŒã€‚ä¾‹å¦‚ *-ca æ¨¡å‹ä¼šæœ‰æ›´ä¼˜æƒ çš„ä»·æ ¼ã€‚ä¸ºäº†é…ç½®è°ƒç”¨å‚æ•°æ—¶å†™å¯¹æ¨¡å‹åç§°ï¼Œéœ€è¦æŸ¥è¯¢æä¾›çš„æ¨¡å‹åˆ—è¡¨ã€‚\nlibrary(httr)\nlibrary(glue)\n\n# è¯»å– CHATANYWHERE_API_KEY ç¯å¢ƒå˜é‡\nOPENAI_API_KEY = Sys.getenv(\"CHATANYWHERE_API_KEY\")\n\nheaders = c(\n   'Authorization' = glue('Bearer {OPENAI_API_KEY}'),\n   'User-Agent' = 'Apifox/1.0.0 (https://apifox.com)',\n   'Content-Type' = 'application/json'\n)\n\n# ä½¿ç”¨ GET æ–¹æ³•è·å–\nres &lt;- VERB(\"GET\", \n            url = \"https://api.chatanywhere.tech/v1/models\", \n            add_headers(headers))\nå°† JSON è¾“å‡ºä¸ºè¡¨æ ¼ã€‚\nlibrary(jsonlite)\nlibrary(tidyverse)\nlibrary(gt)\n\nmodels = jsonlite::fromJSON(content(res, as = \"text\", encoding = \"UTF-8\"))$data\n\nmodels |&gt; \n  mutate(created = as_datetime(created) |&gt; as_date()) |&gt; \n  gt(groupname_col = \"owned_by\")\n\n\n\n\n\n\n\nid\nobject\ncreated\n\n\n\n\nopenai-internal\n\n\ntext-embedding-ada-002\nmodel\n2022-12-16\n\n\ngpt-3.5-turbo-16k\nmodel\n2023-05-10\n\n\nwhisper-1\nmodel\n2023-02-27\n\n\ntts-1\nmodel\n2023-04-19\n\n\nsystem\n\n\ntext-embedding-3-small\nmodel\n2024-01-22\n\n\ntext-embedding-3-large\nmodel\n2024-01-22\n\n\ngpt-3.5-turbo-0125\nmodel\n2024-01-23\n\n\ngpt-3.5-turbo-1106\nmodel\n2023-11-02\n\n\ngpt-3.5-turbo-instruct\nmodel\n2023-08-24\n\n\ngpt-3.5-turbo-instruct-0914\nmodel\n2023-09-07\n\n\ngpt-4o\nmodel\n2024-05-10\n\n\ngpt-4o-2024-05-13\nmodel\n2024-05-10\n\n\nchatgpt-4o-latest\nmodel\n2024-05-10\n\n\ngpt-4o-2024-08-06\nmodel\n2024-05-10\n\n\ngpt-4o-mini\nmodel\n2024-05-10\n\n\ngpt-4o-mini-2024-07-18\nmodel\n2024-05-10\n\n\ngpt-4-turbo\nmodel\n2024-04-05\n\n\ngpt-4-turbo-2024-04-09\nmodel\n2024-04-08\n\n\ngpt-4-turbo-preview\nmodel\n2024-01-23\n\n\ngpt-4-1106-preview\nmodel\n2023-11-02\n\n\ngpt-4-0125-preview\nmodel\n2024-01-23\n\n\ngpt-4-vision-preview\nmodel\n2023-11-02\n\n\ngpt-4-1106-vision-preview\nmodel\n2024-03-26\n\n\ntts-1-1106\nmodel\n2023-11-03\n\n\ntts-1-hd\nmodel\n2023-11-03\n\n\ntts-1-hd-1106\nmodel\n2023-11-03\n\n\ndall-e-2\nmodel\n2023-11-01\n\n\ndall-e-3\nmodel\n2023-10-31\n\n\nca\n\n\ngpt-3.5-turbo-ca\nmodel\n2024-01-23\n\n\ngpt-4o-ca\nmodel\n2024-01-23\n\n\ngpt-4-turbo-ca\nmodel\n2024-01-23\n\n\ngpt-4-turbo-preview-ca\nmodel\n2024-01-23\n\n\no1-mini-ca\nmodel\n2024-01-23\n\n\no1-preview-ca\nmodel\n2024-01-23\n\n\ngpt-4-ca\nmodel\n2023-03-12\n\n\nclaude-3-5-sonnet-20240620\nmodel\n2023-03-12\n\n\nopenai\n\n\ngpt-3.5-turbo\nmodel\n2023-02-28\n\n\ngpt-3.5-turbo-0613\nmodel\n2023-06-12\n\n\ngpt-3.5-turbo-0301\nmodel\n2023-03-01\n\n\ngpt-3.5-turbo-16k-0613\nmodel\n2023-05-30\n\n\ngpt-4\nmodel\n2023-03-12\n\n\ngpt-4-0613\nmodel\n2023-06-12\nä¸‹é¢ä¾æ¬¡ä»‹ç»è¿™äº›æ¨¡å‹çš„ç”¨æ³•ã€‚",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#å¯¹è¯æ¨¡å‹",
    "href": "chatanywhere.html#å¯¹è¯æ¨¡å‹",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.2 å¯¹è¯æ¨¡å‹",
    "text": "6.2 å¯¹è¯æ¨¡å‹\nä»¥ gpt-* å¼€å¤´çš„éƒ½æ˜¯æ–‡æœ¬å¯¹è¯æ¨¡å‹ã€‚è°ƒç”¨ OpenAI çš„æ¨¡å‹æ—¶ï¼Œé€šå¸¸éœ€è¦é…ç½®ä»¥ä¸‹ä¸€äº›å…³é”®å‚æ•°æ¥æ§åˆ¶æ¨¡å‹çš„è¡Œä¸ºå’Œç”Ÿæˆç»“æœçš„æ–¹å¼ã€‚\n\nPromptï¼ˆæç¤ºï¼‰\n\næ¨¡å‹çš„è¾“å…¥æ–‡æœ¬ï¼Œé€šå¸¸ç§°ä¸ºâ€œæç¤ºâ€ã€‚\nå¯ä»¥æ˜¯ç®€å•çš„æ–‡æœ¬ï¼Œæˆ–è€…å¸¦æœ‰ä¸€äº›é—®é¢˜æˆ–ä»»åŠ¡æè¿°ï¼Œå‘Šè¯‰æ¨¡å‹ç”Ÿæˆå“ªç±»å†…å®¹ã€‚\n\nMax Tokensï¼ˆæœ€å¤§ä»¤ç‰Œæ•°ï¼‰\n\næŒ‡å®šç”Ÿæˆçš„æ–‡æœ¬ä¸­æœ€å¤šåŒ…å«å¤šå°‘ä¸ªä»¤ç‰Œï¼ˆtokensï¼‰ã€‚ä¸€ä¸ªä»¤ç‰Œå¤§çº¦å¯¹åº”ä¸€ä¸ªè‹±æ–‡å•è¯æˆ–æ ‡ç‚¹ç¬¦å·ã€‚\nè¯¥å‚æ•°å¯ä»¥æ§åˆ¶ç”Ÿæˆçš„å“åº”é•¿åº¦ï¼Œä½†åŒ…æ‹¬è¾“å…¥å’Œè¾“å‡ºåœ¨å†…çš„ä»¤ç‰Œæ€»æ•°ä¸èƒ½è¶…è¿‡æ¨¡å‹çš„ä¸Šä¸‹æ–‡é•¿åº¦é™åˆ¶ã€‚\n\nTemperatureï¼ˆæ¸©åº¦ï¼‰\n\næ§åˆ¶ç”Ÿæˆæ–‡æœ¬çš„éšæœºæ€§ã€‚èŒƒå›´æ˜¯ 0 åˆ° 2ï¼š\n\ntemperature=0 æ—¶ï¼Œè¾“å‡ºæ›´åŠ ç¡®å®šå’Œä¿å®ˆï¼Œåå‘ç”Ÿæˆå¸¸è§çš„æˆ–â€œæœ€å¯èƒ½â€çš„ç­”æ¡ˆã€‚\nè¾ƒé«˜çš„ temperature å€¼ï¼ˆå¦‚ 0.7ï¼‰ä¼šè®©ç”Ÿæˆçš„å†…å®¹æ›´åŠ éšæœºå’Œå¤šæ ·åŒ–ã€‚\n\n\nnï¼ˆç”Ÿæˆæ¬¡æ•°ï¼‰\n\næ§åˆ¶ç”Ÿæˆå¤šå°‘ä¸ªä¸åŒçš„å“åº”ã€‚\nn=1 åªç”Ÿæˆä¸€ä¸ªå“åº”ï¼›n=2 ä¼šç”Ÿæˆå¤šä¸ªå“åº”ï¼Œé€‚åˆæ¯”è¾ƒæˆ–é€‰æ‹©æœ€åˆé€‚çš„å†…å®¹ã€‚\n\n\nè°ƒç”¨ OpenAI æ¨¡å‹æ—¶ï¼Œé€šå¸¸éœ€è¦è®¾ç½® æ¨¡å‹åç§°ã€æç¤ºã€æœ€å¤§ä»¤ç‰Œæ•°ã€æ¸©åº¦ã€top-pã€ç”Ÿæˆæ¬¡æ•° ç­‰å‚æ•°ï¼Œè§†ä»»åŠ¡éœ€æ±‚è¿˜å¯ä»¥è°ƒæ•´ å‡ºç°æƒ©ç½šã€é¢‘ç‡æƒ©ç½šã€åœæ­¢åºåˆ— ç­‰å…¶ä»–é…ç½®ï¼Œä»¥æ§åˆ¶ç”Ÿæˆçš„å†…å®¹è´¨é‡å’Œè¡Œä¸ºã€‚\nä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œå±•ç¤ºäº† ChatGPT æ•°ä¸æ¸…æ¥šâ€œtemperatureâ€è¿™ä¸ªå•è¯é‡Œé¢æœ‰å‡ ä¸ªå­—æ¯â€œeâ€ã€‚\n\nbody = '{\n   \"model\": \"gpt-4o-mini\",\n   \"messages\": [\n      {\n         \"role\": \"system\",\n         \"content\": \"You are a helpful assistant.\"\n      },\n      {\n         \"role\": \"user\",\n         \"content\": \"Temperatureè¿™ä¸ªå•è¯ä¸­å«æœ‰å‡ ä¸ªå­—æ¯eï¼Ÿ\"\n      }\n   ],\n   \"temperature\": 2\n}';\n\nres &lt;- VERB(\"POST\", \n            url = \"https://api.chatanywhere.tech/v1/chat/completions\", \n            body = body, \n            add_headers(headers))\n\ncontent(res, 'text', encoding = \"UTF-8\") |&gt; \n  fromJSON() |&gt; \n  str()\n\nList of 7\n $ id                : chr \"chatcmpl-ABwBJsmRdhuBlKfEHdMtFwwASkSpK\"\n $ object            : chr \"chat.completion\"\n $ created           : int 1727408621\n $ model             : chr \"gpt-4o-mini-2024-07-18\"\n $ choices           :'data.frame': 1 obs. of  4 variables:\n  ..$ index        : int 0\n  ..$ message      :'data.frame':   1 obs. of  2 variables:\n  .. ..$ role   : chr \"assistant\"\n  .. ..$ content: chr \"\\\"Temperature\\\"è¿™ä¸ªå•è¯ä¸­æœ‰ä¸¤ä¸ªå­—æ¯eã€‚\"\n  ..$ logprobs     : logi NA\n  ..$ finish_reason: chr \"stop\"\n $ usage             :List of 4\n  ..$ prompt_tokens            : int 29\n  ..$ completion_tokens        : int 13\n  ..$ total_tokens             : int 42\n  ..$ completion_tokens_details:List of 1\n  .. ..$ reasoning_tokens: int 0\n $ system_fingerprint: chr \"fp_1bb46167f9\"",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#ä½¿ç”¨-openai-api",
    "href": "chatanywhere.html#ä½¿ç”¨-openai-api",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.3 ä½¿ç”¨ OpenAI API",
    "text": "6.3 ä½¿ç”¨ OpenAI API\n\nfrom openai import OpenAI\nimport os\n\n# åˆ›å»º client\nclient = OpenAI(\n    api_key=os.getenv(\"CHATANYWHERE_API_KEY\"), # å¦‚æœæ‚¨æ²¡æœ‰é…ç½®ç¯å¢ƒå˜é‡ï¼Œè¯·åœ¨æ­¤å¤„ç”¨æ‚¨çš„API Keyè¿›è¡Œæ›¿æ¢\n    base_url=\"https://api.chatanywhere.tech\",  # å¡«å†™ openAI æœåŠ¡çš„ base_url\n)\n\n# ç”Ÿæˆå¯¹è¯\ncompletion = client.chat.completions.create(\n    model=\"gpt-4o-ca\",\n    messages=[\n        {'role': 'system', 'content': 'You are a helpful assistant.'},\n        {'role': 'user', 'content': 'ä½ æ˜¯è°'}],\n    temperature=0.8,\n    top_p=0.8\n    )\n\nprint(completion.choices[0].message.content)\n\næˆ‘æ˜¯ä¸€ä¸ªç”±äººå·¥æ™ºèƒ½é©±åŠ¨çš„åŠ©æ‰‹ï¼Œæ—¨åœ¨å¸®åŠ©ä½ å›ç­”é—®é¢˜ã€æä¾›ä¿¡æ¯å’Œå®Œæˆä»»åŠ¡ã€‚æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©çš„åœ°æ–¹ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼\n\n\n\n6.3.1 è§£ææ–‡ä»¶\nChatAnyWhere çš„æœåŠ¡å™¨æ˜¯ä¸æ˜¯ä¸æ”¯æŒä¸‹é¢è¿™ä¸ªå‘½ä»¤ï¼Ÿ\n\nfrom pathlib import Path\n\nassistant = client.beta.assistants.create(\n  name=\"Document Reader Assistant\",\n  instructions=\"You are an document reader\",\n  model=\"gpt-4o\",\n  tools=[{\"type\": \"file_search\"}],\n)\n\nfile_object = client.files.create(file=open(Path(\"example/Kraken2.pdf\"),\"r\"), \n                                  purpose=\"assistants\")\n\nprint(f\"æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œæ–‡ä»¶ID: {file_object.id}\")\n\n\n\n6.3.2 ä½¿ç”¨ Kimi æœåŠ¡å™¨è§£æ\n\nfrom pathlib import Path\nfrom openai import OpenAI\nimport os\n\nclient = OpenAI(\n   api_key = os.getenv(\"MOONSHOT_API_KEY\"),  # æ›¿æ¢ä¸ºä½ çš„APIå¯†é’¥\n   base_url = \"https://api.moonshot.cn/v1\",\n)\n\npdf_file_path = Path(\"example/Kraken2.pdf\")\n\n# ä¸Šä¼ æ–‡ä»¶\nfile_object = client.files.create(file = pdf_file_path, \n                                  purpose = \"file-extract\")\n\nprint(f\"æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œæ–‡ä»¶ID: {file_object.id}\")\n\næ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œæ–‡ä»¶ID: crshkmalve9pdev71plg\n\n# è·å–æ–‡ä»¶å†…å®¹\nfile_content = client.files.content(file_id=file_object.id).text\n\n# æ‰“å°å‰ 200 å­—\nprint(file_content[:200])\n\n{\"content\":\"åˆ©â½¤å®åŸºå› ç»„çš„readsè¿›â¾ç‰©ç§æ³¨é‡Šçš„å¸¸â½¤â¼¯å…·æœ‰å¾ˆå¤šï¼Œå®ƒä»¬é€šè¿‡â½å¯¹readsåˆ°å‚è€ƒæ•°æ®åº“æ¥è¯†åˆ«å¾®â½£ç‰©çš„åˆ†ç±»ä¿¡\\næ¯ã€‚ä»¥ä¸‹æ˜¯â¼ç§å¸¸â½¤çš„â¼¯å…·ï¼š\\n1. Kraken2\\nâ¼¯ä½œåŸç†ï¼šåŸºäºk-merâ½å¯¹æŠ€æœ¯ï¼Œå°†readsâ½å¯¹åˆ°å‚è€ƒæ•°æ®åº“ä¸­çš„ç‰¹å®šk-meré›†åˆï¼Œä»¥å®ç°å¿«é€Ÿçš„åˆ†ç±»æ³¨\\né‡Šã€‚\\nä¼˜ç‚¹ï¼šé€Ÿåº¦â¾®å¸¸å¿«ï¼Œèƒ½å¤„ç†â¼¤è§„æ¨¡æ•°æ®ã€‚\\næ•°æ®åº“ï¼šKraken2å…è®¸ä½¿â½¤æ ‡å‡†æ•°æ®åº“ï¼ˆå¦‚NCBI \n\n\n\nfrom IPython.display import Markdown\n\nmessages = [\n    {\n        \"role\": \"system\",\n        \"content\": \"ä½ æ˜¯Kimiï¼Œç”±Moonshot AIæä¾›çš„äººå·¥æ™ºèƒ½åŠ©æ‰‹ã€‚\"\n    },\n    {\n        \"role\": \"system\",\n        \"content\": file_content  # å°†æ–‡ä»¶å†…å®¹ä½œä¸ºç³»ç»Ÿæç¤º\n    },\n    {\n        \"role\": \"user\",\n        \"content\": \"æ€»ç»“ä¸€ä¸‹è¿™ä»½æ–‡ä»¶ä¸­çš„å†…å®¹\"\n    }\n]\n\n# å‘é€å¯¹è¯è¯·æ±‚\nresponse = client.chat.completions.create(\n    model=\"moonshot-v1-32k\",\n    messages=messages,\n    temperature=0.3,\n)\n\n# æ‰“å°å›ç­”\nMarkdown(response.choices[0].message.content)\n\nè¿™ä»½æ–‡ä»¶æ˜¯å…³äºå¦‚ä½•ä½¿ç”¨å®åŸºå› ç»„çš„readsè¿›è¡Œç‰©ç§æ³¨é‡Šçš„æŒ‡å—ï¼Œä¸»è¦ä»‹ç»äº†å‡ ç§å¸¸ç”¨çš„å·¥å…·ï¼ŒåŒ…æ‹¬Kraken2ã€MetaPhlAn3å’ŒCentrifugeã€‚ä»¥ä¸‹æ˜¯å¯¹è¿™äº›å·¥å…·çš„æ€»ç»“ï¼š\n\nKraken2ï¼š\n\nå·¥ä½œåŸç†ï¼šåŸºäºk-meræ¯”å¯¹æŠ€æœ¯ï¼Œå°†readsæ¯”å¯¹åˆ°å‚è€ƒæ•°æ®åº“ä¸­çš„ç‰¹å®šk-meré›†åˆã€‚\nä¼˜ç‚¹ï¼šé€Ÿåº¦å¿«ï¼Œèƒ½å¤„ç†å¤§è§„æ¨¡æ•°æ®ã€‚\næ•°æ®åº“ï¼šå¯ä»¥ä½¿ç”¨æ ‡å‡†æ•°æ®åº“æˆ–è‡ªå®šä¹‰æ•°æ®åº“ã€‚\nè¾“å‡ºï¼šç‰©ç§åˆ†ç±»ä¿¡æ¯å’Œç‰©ç§ç›¸å¯¹ä¸°åº¦ã€‚\nStandard-8æ•°æ®åº“ï¼šä¸ºèµ„æºæœ‰é™çš„ç¯å¢ƒä¼˜åŒ–ï¼Œæ•°æ®åº“å¤§å°é™åˆ¶ä¸º8GBï¼Œé’ˆå¯¹å¸¸è§ç‰©ç§ä¼˜åŒ–ï¼Œå¿«é€Ÿåˆ†æã€‚\n\nMetaPhlAn3ï¼š\n\nå·¥ä½œåŸç†ï¼šä½¿ç”¨å·²çŸ¥å¾®ç”Ÿç‰©çš„æ ‡è®°åŸºå› è¿›è¡Œæ¯”å¯¹ã€‚\nä¼˜ç‚¹ï¼šé€‚åˆåˆ†æç‰©ç§ç›¸å¯¹ä¸°åº¦ï¼Œè®¡ç®—æ•ˆç‡é«˜ã€‚\næ•°æ®åº“ï¼šä½¿ç”¨MetaPhlAnè‡ªå¸¦çš„æ ‡è®°åŸºå› æ•°æ®åº“ã€‚\nè¾“å‡ºï¼šç‰©ç§åˆ†ç±»å’Œä¸°åº¦è¡¨ã€‚\n\nCentrifugeï¼š\n\nå·¥ä½œåŸç†ï¼šåŸºäºå‹ç¼©ç´¢å¼•æŠ€æœ¯ï¼Œå°†readsä¸å‹ç¼©å‚è€ƒæ•°æ®åº“ä¸­çš„åŸºå› ç»„åºåˆ—è¿›è¡Œæ¯”å¯¹ã€‚\nä¼˜ç‚¹ï¼šå¤„ç†å¤§æ•°æ®åº“é€Ÿåº¦å¿«ï¼Œé€‚åˆå¤„ç†ä½è´¨é‡readsã€‚\næ•°æ®åº“ï¼šä½¿ç”¨Centrifugeæä¾›çš„å‚è€ƒæ•°æ®åº“æˆ–è‡ªå®šä¹‰æ•°æ®åº“ã€‚\nè¾“å‡ºï¼šç‰©ç§åˆ†ç±»å’Œä¸°åº¦ä¼°è®¡ã€‚\n\n\næ–‡ä»¶è¿˜æä¾›äº†ä½¿ç”¨Kraken2è¿›è¡Œå®åŸºå› ç»„æµ‹åºæ•°æ®ç‰©ç§æ³¨é‡Šåˆ†æçš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…Kraken2ã€ä¸‹è½½æ•°æ®åº“ã€è¿è¡ŒKraken2è¿›è¡Œåˆ†ç±»æ³¨é‡Šä»¥åŠåˆ†æç»“æœã€‚æ­¤å¤–ï¼Œè¿˜æä¾›äº†å¦‚ä½•ä½¿ç”¨Rè¯­è¨€çš„ggplot2åº“å¯¹åˆ†ç±»ç»“æœè¿›è¡Œå¯è§†åŒ–çš„ç¤ºä¾‹ä»£ç ã€‚\næœ€åï¼Œæ–‡ä»¶æä¾›äº†ä¸€ä¸ªKraken2è¾“å‡ºæŠ¥å‘Šçš„ç¤ºä¾‹ï¼Œæ˜¾ç¤ºäº†æ ·æœ¬ä¸­ä¸åŒåˆ†ç±»å•å…ƒçš„ç›¸å¯¹ä¸°åº¦ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Rè¯­è¨€ç»˜åˆ¶åˆ†ç±»ç»“æœçš„æŸ±çŠ¶å›¾ã€‚",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#è¯åµŒå…¥æ¨¡å‹",
    "href": "chatanywhere.html#è¯åµŒå…¥æ¨¡å‹",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.4 è¯åµŒå…¥æ¨¡å‹",
    "text": "6.4 è¯åµŒå…¥æ¨¡å‹\næ‰€æœ‰ä¸‰ä¸ªè¯åµŒå…¥æ¨¡å‹éƒ½æ˜¯åŸºäº Transformer æ¶æ„ï¼Œè¿™ä½¿å¾—å®ƒä»¬åœ¨å¤„ç†è‡ªç„¶è¯­è¨€æ—¶å…·æœ‰è‰¯å¥½çš„æ€§èƒ½ã€‚ä¸‹è¡¨æ¯”è¾ƒäº† text-embedding-ada-002ã€text-embedding-3-small å’Œ text-embedding-3-large è¿™ä¸‰ä¸ªè¯åµŒå…¥æ¨¡å‹çš„ç‰¹ç‚¹ï¼š\n\n\n\n\n\n\n\n\n\n\n\n\næ¨¡å‹åç§°\nå‚æ•°é‡\nåµŒå…¥ç»´åº¦\næ€§èƒ½\né€‚ç”¨åœºæ™¯\nä¼˜ç‚¹\nç¼ºç‚¹\n\n\n\n\ntext-embedding-ada-002\nä¸­ç­‰\n1536\né«˜æ•ˆï¼Œæ€§èƒ½ä¼˜ç§€\né€šç”¨æ–‡æœ¬åµŒå…¥ï¼Œé€‚ç”¨äºå¹¿æ³›çš„ NLP ä»»åŠ¡\né«˜ç²¾åº¦åµŒå…¥ï¼Œé€‚åˆå„ç§è¯­ä¹‰åŒ¹é…ä»»åŠ¡\nç›¸æ¯”å°å‹æ¨¡å‹ï¼Œè®¡ç®—èµ„æºéœ€æ±‚è¾ƒé«˜\n\n\ntext-embedding-3-small\nå°\n512\nè¾ƒå¿«ï¼Œèµ„æºæ•ˆç‡é«˜\nèµ„æºå—é™çš„åº”ç”¨åœºæ™¯ï¼Œä½è®¡ç®—æˆæœ¬çš„åµŒå…¥ç”Ÿæˆ\nè®¡ç®—æ•ˆç‡é«˜ï¼Œé€‚åˆå®æ—¶æˆ–èµ„æºæœ‰é™çš„åœºæ™¯\nåµŒå…¥ç»´åº¦è¾ƒä½ï¼Œå¯èƒ½å½±å“è¯­ä¹‰è¡¨è¾¾èƒ½åŠ›\n\n\ntext-embedding-3-large\nå¤§\n2048\næ›´é«˜æ€§èƒ½ï¼Œç²¾åº¦æé«˜\né«˜ç«¯åº”ç”¨åœºæ™¯ï¼Œå¦‚é«˜ç²¾åº¦è¯­ä¹‰æœç´¢å’Œæ¨èç³»ç»Ÿ\nåµŒå…¥ç»´åº¦æ›´é«˜ï¼Œèƒ½å¤Ÿæ•æ‰å¤æ‚è¯­ä¹‰å…³ç³»\nèµ„æºæ¶ˆè€—å¤§ï¼Œé€‚åˆè®¡ç®—èµ„æºå……è¶³çš„åœºæ™¯\n\n\n\n\nbody = '{\n   \"model\": \"text-embedding-ada-002\",\n   \"input\": \"The food was delicious and the waiter...\"\n}';\n\nres = VERB(\"POST\", \n           url = \"https://api.chatanywhere.tech/v1/embeddings\", \n           body = body, \n           add_headers(headers))\n\ncontent = content(res, 'text', encoding = \"UTF-8\")\n\nembedding = fromJSON(content)\nstr(embedding)\n\nList of 4\n $ object: chr \"list\"\n $ data  :'data.frame': 1 obs. of  3 variables:\n  ..$ object   : chr \"embedding\"\n  ..$ embedding:List of 1\n  .. ..$ : num [1:1536] 0.00238 -0.00932 0.01569 -0.00774 -0.00472 ...\n  ..$ index    : int 0\n $ model : chr \"text-embedding-ada-002\"\n $ usage :List of 3\n  ..$ prompt_tokens    : int 8\n  ..$ completion_tokens: int 0\n  ..$ total_tokens     : int 8",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#æ–‡ç”Ÿå›¾æ¨¡å‹",
    "href": "chatanywhere.html#æ–‡ç”Ÿå›¾æ¨¡å‹",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.5 æ–‡ç”Ÿå›¾æ¨¡å‹",
    "text": "6.5 æ–‡ç”Ÿå›¾æ¨¡å‹\ndall-e-2 å’Œ dall-e-3 æ˜¯æ–‡ç”Ÿå›¾æ¨¡å‹ã€‚\nDALL-E 2 æ”¯æŒä»¥ä¸‹ä¸‰ç§å›¾åƒå°ºå¯¸ï¼š\n\n256x256\n512x512\n1024x1024\n\nDALL-E 3 æ”¯æŒä»¥ä¸‹å›¾åƒå°ºå¯¸ï¼š\n\n1024x1024: æ­£æ–¹å½¢å›¾åƒï¼Œé€‚åˆå¤§å¤šæ•°ä½¿ç”¨åœºæ™¯ï¼Œæ˜¯é»˜è®¤æ¨èçš„å°ºå¯¸ã€‚\n1792x1024: å®½å±å›¾åƒï¼Œé€‚åˆéœ€è¦æ›´å®½è§†é‡çš„åœºæ™¯æˆ–æ¨ªå‘å¸ƒå±€çš„è®¾è®¡ã€‚\n1024x1792: çºµå‘å›¾åƒï¼Œé€‚åˆéœ€è¦æ›´é«˜è§†é‡çš„åœºæ™¯æˆ–çºµå‘å¸ƒå±€çš„è®¾è®¡ã€‚\n\nä½ å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„å›¾åƒå°ºå¯¸è¿›è¡Œç”Ÿæˆã€‚\n\nurl = \"https://api.chatanywhere.tech/v1/images/generations\"\n\nbody = '{\n   \"prompt\": \"A colorful sunset over the snow mountains\",\n   \"n\": 1,\n   \"model\":  \"dall-e-2\",\n   \"size\": \"256x256\"\n}';\n\nresponse = VERB(\"POST\", url, body = body, add_headers(headers))\n\ncontent = content(response, \"text\", encoding = \"UTF-8\")\nprint(content)\n\n[1] \"{\\\"created\\\":1727601271,\\\"data\\\":[{\\\"url\\\":\\\"https://oaidalleapiprodscus.blob.core.windows.net/private/org-iEnzkgXz3MLYFDoiaMsyPKYw/user-4vHAQk9cYlLmeDvsuy2iKvDZ/img-rtLChxv4kEKdWs8fWdKyHaLc.png?st=2024-09-29T08%3A14%3A31Z&se=2024-09-29T10%3A14%3A31Z&sp=r&sv=2024-08-04&sr=b&rscd=inline&rsct=image/png&skoid=d505667d-d6c1-4a0a-bac7-5c84a87759f8&sktid=a48cca56-e6da-484e-a814-9c849652bcb3&skt=2024-09-29T01%3A03%3A42Z&ske=2024-09-30T01%3A03%3A42Z&sks=b&skv=2024-08-04&sig=A2h8h/24EXYfTQXp4jrt2794eopKRKIQUypio0ccnNU%3D\\\"}]}\"\n\n\nè·å–å›¾ç‰‡ã€‚\n# è·å–ç”Ÿæˆçš„å›¾åƒ URL\nimage_url = fromJSON(content)[[\"data\"]][[\"url\"]]\n\n# ä¸‹è½½å›¾ç‰‡\nresponse &lt;- GET(image_url)\n\n# æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ\nif (status_code(response) == 200) {\n  # å°†å›¾ç‰‡ä¿å­˜åˆ°ç£ç›˜\n  writeBin(content(response, \"raw\"), \"output/sunset.png\")\n  cat(\"å›¾ç‰‡å·²æˆåŠŸä¿å­˜åˆ° `output/sunset.png`ã€‚\")\n} else {\n  cat(\"ä¸‹è½½å›¾ç‰‡å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š\", status_code(response), \"\\n\")\n}\nå›¾ç‰‡å·²æˆåŠŸä¿å­˜åˆ° output/sunset.pngã€‚",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#è¯†å›¾åŠŸèƒ½ä¸æ”¯æŒ",
    "href": "chatanywhere.html#è¯†å›¾åŠŸèƒ½ä¸æ”¯æŒ",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.6 è¯†å›¾åŠŸèƒ½ï¼ˆä¸æ”¯æŒï¼‰",
    "text": "6.6 è¯†å›¾åŠŸèƒ½ï¼ˆä¸æ”¯æŒï¼‰\nä½¿ç”¨å¤šæ¨¡æ€æ¨¡å‹ï¼Œå¯ä»¥è¯†åˆ«å›¾ç‰‡ä¸­çš„ä¿¡æ¯ã€‚\n\n# è®¾ç½®è¯·æ±‚ä½“\nbody = list(\n  model = \"gpt-4o-ca\",\n  file = upload_file(\"output/sunset.png\"),  # æ–‡ä»¶è·¯å¾„\n  prompt = \"è¿™æ˜¯ä»€ä¹ˆ?\",  # æç¤º\n  encode = \"multipart\"\n  )\n\nres = VERB(\"POST\", \n            url = \"https://api.chatanywhere.tech/v1/chat/completions\", \n            body = body, \n            add_headers(headers))\n\ncat(content(res, 'text', encoding = \"UTF-8\"))\n\n{\"error\":{\"message\":\"JSON parse error: Unexpected character ('-' (code 45)) in numeric value: expected digit (0-9) to follow minus sign, for valid numeric value; nested exception is com.fasterxml.jackson.core.JsonParseException: Unexpected character ('-' (code 45)) in numeric value: expected digit (0-9) to follow minus sign, for valid numeric value\\n at [Source: (org.springframework.util.StreamUtils$NonClosingInputStream); line: 1, column: 3]\",\"type\":\"chatanywhere_error\",\"param\":null,\"code\":\"400 BAD_REQUEST\"}}",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#æ–‡å­—è½¬è¯­éŸ³æ¨¡å‹",
    "href": "chatanywhere.html#æ–‡å­—è½¬è¯­éŸ³æ¨¡å‹",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.7 æ–‡å­—è½¬è¯­éŸ³æ¨¡å‹",
    "text": "6.7 æ–‡å­—è½¬è¯­éŸ³æ¨¡å‹\nå°†ä¸€æ®µæ–‡å­—è½¬å˜ä¸ºè¯­éŸ³ï¼Œæ”¯æŒä¸­è‹±æ–‡æ··åˆã€‚\n\nbody = '{\n   \"model\": \"tts-1\",\n   \"input\": \"ä»Šå¤©å¤©æ°”ä¸é”™ã€‚It is a nice day today.\",\n   \"voice\": \"alloy\"\n}';\n\nres &lt;- VERB(\"POST\", \n            url = \"https://api.chatanywhere.tech/v1/audio/speech\", \n            body = body, \n            add_headers(headers))\n\n# æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ\nif (status_code(res) == 200) {\n  # å°†å“åº”ä¿å­˜ä¸ºéŸ³é¢‘æ–‡ä»¶ï¼ˆå‡è®¾è¿”å›çš„æ˜¯äºŒè¿›åˆ¶éŸ³é¢‘æ•°æ®ï¼‰\n  audio_file &lt;- \"output/audio-goodday.mp3\"  # ä½ å¯ä»¥æ›´æ”¹æ–‡ä»¶åå’Œæ‰©å±•å\n  writeBin(content(res, \"raw\"), audio_file)\n  message(\"Audio saved successfully as: \", audio_file)\n} else {\n  message(\"Request failed with status: \", status_code(res))\n}",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#è¯­éŸ³è¯†åˆ«æ¨¡å‹",
    "href": "chatanywhere.html#è¯­éŸ³è¯†åˆ«æ¨¡å‹",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.8 è¯­éŸ³è¯†åˆ«æ¨¡å‹",
    "text": "6.8 è¯­éŸ³è¯†åˆ«æ¨¡å‹\nwhisper-1 æ˜¯ OpenAI å¼€å‘çš„ä¸€ä¸ªå¼ºå¤§çš„è¯­éŸ³è¯†åˆ«æ¨¡å‹ã€‚å®ƒä¸»è¦ç”¨äºå°†è¯­éŸ³è½¬æ¢ä¸ºæ–‡æœ¬ï¼ˆä¹Ÿç§°ä¸ºè¯­éŸ³è½¬æ–‡å­—ï¼ŒSpeech-to-Textï¼Œç®€ç§° STTï¼‰ã€‚è¯¥æ¨¡å‹èƒ½å¤Ÿå¤„ç†å¤šç§è¯­è¨€çš„è¯­éŸ³è¾“å…¥ï¼Œå¹¶èƒ½å¤Ÿè¯†åˆ«ä¸åŒçš„å£éŸ³å’Œè¯­éŸ³é£æ ¼ï¼Œéå¸¸é€‚ç”¨äºå„ç§éŸ³é¢‘è½¬å½•ä»»åŠ¡ã€‚\n\nheaders_multipart = c(\n   'Authorization' = glue('Bearer {OPENAI_API_KEY}'),\n   'User-Agent' = 'Apifox/1.0.0 (https://apifox.com)',\n   'Content-Type' = 'multipart/form-data'\n)\n\nbody = list(\n   'file' = upload_file('output/audio-goodday.mp3'),\n   'model' = 'whisper-1',\n   'prompt' = 'eiusmod nulla',\n   'response_format' = 'json',\n   'temperature' = '0',\n   'language' = ''\n)\n\nres = VERB(\"POST\", \n            url = \"https://api.chatanywhere.tech/v1/audio/transcriptions\", \n            body = body, \n            add_headers(headers_multipart),\n            encode = 'multipart')\n\ncat(content(res, 'text', encoding = \"UTF-8\"))\n\n{\n  \"text\": \"ä»Šå¹´å¤©æ°£ä¸éŒ¯ It is a nice day today\"\n}",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#claude-æ¨¡å‹æ— æ•ˆ",
    "href": "chatanywhere.html#claude-æ¨¡å‹æ— æ•ˆ",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.9 Claude æ¨¡å‹ï¼ˆæ— æ•ˆï¼‰",
    "text": "6.9 Claude æ¨¡å‹ï¼ˆæ— æ•ˆï¼‰\nChatAnywhere æä¾›äº†ä¸€ä¸ª claude-3-5-sonnet-20240620 æ¨¡å‹ã€‚\n\nbody = '{\n   \"model\": \"claude-3-5-sonnet-20240620\",\n   \"messages\": [\n      {\n         \"role\": \"system\",\n         \"content\": \"You are a helpful assistant.\"\n      },\n      {\n         \"role\": \"user\",\n         \"content\": \"Temperatureè¿™ä¸ªå•è¯ä¸­å«æœ‰å‡ ä¸ªå­—æ¯eï¼Ÿ\"\n      }\n   ],\n   \"temperature\": 2\n}';\n\nres &lt;- VERB(\"POST\", \n            url = \"https://api.chatanywhere.tech/v1/chat/completions\", \n            body = body, \n            add_headers(headers))\n\ncontent(res, 'text', encoding = \"UTF-8\") |&gt; \n  fromJSON() |&gt; \n  str()\n\nList of 1\n $ error:List of 4\n  ..$ message: chr \"æ¨¡å‹æ— è¿”å›ç»“æœï¼Œå¯èƒ½æ˜¯å†…å®¹è¿è§„ã€è¾“å…¥è¿‡é•¿ã€è¾“å…¥æ ¼å¼æœ‰è¯¯æˆ–è´Ÿè½½è¾ƒé«˜ï¼Œè¯·æ£€æŸ¥åå†è¯•ã€‚No response, please try again.\"\n  ..$ type   : chr \"chatanywhere_error\"\n  ..$ param  : NULL\n  ..$ code   : chr \"503 SERVICE_UNAVAILABLE\"",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#è¯­éŸ³ç¿»è¯‘æ¨¡å‹æ— æ•ˆ",
    "href": "chatanywhere.html#è¯­éŸ³ç¿»è¯‘æ¨¡å‹æ— æ•ˆ",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.10 è¯­éŸ³ç¿»è¯‘æ¨¡å‹ï¼ˆæ— æ•ˆï¼‰",
    "text": "6.10 è¯­éŸ³ç¿»è¯‘æ¨¡å‹ï¼ˆæ— æ•ˆï¼‰\nå°†éŸ³é¢‘ç¿»è¯‘æˆè‹±æ–‡ã€‚\n\nbody = list(\n   'file' = upload_file('output/audio-goodday.mp3'),\n   'model' = 'whisper-1',\n   'prompt' = '',\n   'response_format' = 'json',\n   'temperature' = '0'\n)\n\nres &lt;- VERB(\"POST\", \n            url = \"https://api.chatanywhere.tech/v1/audio/translations\", \n            body = body, \n            add_headers(headers_multipart), \n            encode = 'multipart')\n\ncat(content(res, 'text', encoding = \"UTF-8\"))\n\n{\n  \"text\": \"ä»Šå¤©å¤©æ°”ä¸é”™ã€‚It is a nice day today.\"\n}",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#ç”¨é‡æŸ¥è¯¢æ— æ•ˆ",
    "href": "chatanywhere.html#ç”¨é‡æŸ¥è¯¢æ— æ•ˆ",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.11 ç”¨é‡æŸ¥è¯¢ï¼ˆæ— æ•ˆï¼‰",
    "text": "6.11 ç”¨é‡æŸ¥è¯¢ï¼ˆæ— æ•ˆï¼‰\n\nbody = '{\n   \"model\": \"gpt-4o-mini\",\n   \"hours\": 24\n}';\n\nres &lt;- VERB(\"POST\", \n            url = \"https://api.chatanywhere.tech/v1/query/usage_details\", \n            body = body, \n            add_headers(headers))\n\ncat(content(res, 'text', encoding = \"UTF-8\"))\n\n{\"error\":{\"message\":\"wrong api key\",\"type\":\"chatanywhere_error\",\"param\":null,\"code\":\"401 UNAUTHORIZED\"}}",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "chatanywhere.html#è‡ªåŠ¨è¡¥å…¨æ— æ•ˆ",
    "href": "chatanywhere.html#è‡ªåŠ¨è¡¥å…¨æ— æ•ˆ",
    "title": "6Â  ChatAnyWhere æœåŠ¡",
    "section": "6.12 è‡ªåŠ¨è¡¥å…¨ï¼ˆæ— æ•ˆï¼‰",
    "text": "6.12 è‡ªåŠ¨è¡¥å…¨ï¼ˆæ— æ•ˆï¼‰\næ–‡æ¡£é‡Œè¯´ï¼šâ€œç»™å®šä¸€ä¸ªæç¤ºï¼Œè¯¥æ¨¡å‹å°†è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªé¢„æµ‹çš„å®Œæˆï¼Œå¹¶ä¸”è¿˜å¯ä»¥è¿”å›æ¯ä¸ªä½ç½®çš„æ›¿ä»£æ ‡è®°çš„æ¦‚ç‡â€ã€‚ä½†æ˜¯ï¼Œå®é™…ä¸Šè¿™ä¸ªæ¥å£ä¸å¯ç”¨ã€‚\n\nbody = '{\n   \"model\": \"gpt-4o-mini\",\n   \"prompt\": \"Say this is a test\",\n   \"max_tokens\": 7,\n   \"temperature\": 0,\n   \"top_p\": 1,\n   \"n\": 1,\n   \"stream\": false,\n   \"logprobs\": null,\n   \"stop\": \"\\\\n\"\n}';\n\nres &lt;- VERB(\"POST\", url = \"https://api.chatanywhere.tech/v1/completions\", \n            body = body, \n            add_headers(headers))\n\n# ä¼˜é›…åœ°è¾“å‡º JSON\ncontent(res, 'text', encoding = 'UTF-8') |&gt; \n  jsonlite::prettify()\n\n{\n    \"error\": {\n        \"message\": \"This is a chat model and not supported in the v1/completions endpoint. Did you mean to use v1/chat/completions?\",\n        \"type\": \"invalid_request_error\",\n        \"param\": \"model\",\n        \"code\": null\n    }\n}",
    "crumbs": [
      "<span class='chapter-number'>6</span>Â  <span class='chapter-title'>ChatAnyWhere æœåŠ¡</span>"
    ]
  },
  {
    "objectID": "moonshot-kimi.html",
    "href": "moonshot-kimi.html",
    "title": "7Â  Moonshot Kimi",
    "section": "",
    "text": "7.1 æ”¯æŒçš„æ¨¡å‹\nKimi çš„æ¨¡å‹å…·æœ‰ 3 ç§ä¸åŒè§„æ ¼çš„ä¸Šä¸‹æ–‡é•¿åº¦ã€‚\nfrom openai import OpenAI\nimport os\nfrom IPython.display import Markdown\nfrom pprint import pprint\n\n \nMOONSHOT_API_KEY = os.getenv(\"MOONSHOT_API_KEY\")\n\nclient = OpenAI(\n    api_key = MOONSHOT_API_KEY,\n    base_url = \"https://api.moonshot.cn/v1\",\n)\n \nmodel_list = client.models.list()\nmodel_data = model_list.data\n \nfor i, model in enumerate(model_data):\n    print(f\"model[{i}]:\", model.id)\n\nmodel[0]: moonshot-v1-8k\nmodel[1]: moonshot-v1-128k\nmodel[2]: moonshot-v1-32k\nmodel[3]: moonshot-v1-auto\nä½œä¸º Moonshot AI å¼€å‘çš„äººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼ŒKimi å…·å¤‡ä¸€äº›ç‹¬ç‰¹çš„æŠ€èƒ½å’Œç‰¹ç‚¹ï¼Œè¿™äº›å¯èƒ½ä¸æ–‡å¿ƒä¸€è¨€ã€é€šä¹‰åƒé—®ç­‰å…¶ä»–AIåŠ©æ‰‹æœ‰æ‰€ä¸åŒã€‚",
    "crumbs": [
      "<span class='chapter-number'>7</span>Â  <span class='chapter-title'>Moonshot Kimi</span>"
    ]
  },
  {
    "objectID": "moonshot-kimi.html#æ”¯æŒçš„æ¨¡å‹",
    "href": "moonshot-kimi.html#æ”¯æŒçš„æ¨¡å‹",
    "title": "7Â  Moonshot Kimi",
    "section": "",
    "text": "é•¿æ–‡æœ¬å¤„ç†ï¼šæˆ‘èƒ½å¤Ÿå¤„ç†æœ€å¤š 20 ä¸‡å­—çš„è¾“å…¥å’Œè¾“å‡ºï¼ˆmoonshot-v1-128kï¼‰ï¼Œè¿™ä½¿å¾— Kimi èƒ½å¤Ÿå¤„ç†é•¿ç¯‡æ–‡ç« ã€æŠ¥å‘Šå’Œä»£ç ç­‰ã€‚\næ–‡ä»¶é˜…è¯»å’Œè§£æï¼šç”¨æˆ·å¯ä»¥ä¸Šä¼ å¤šç§æ ¼å¼çš„æ–‡ä»¶ï¼Œå¦‚TXTã€PDFã€Wordæ–‡æ¡£ã€PPTå¹»ç¯ç‰‡å’ŒExcelç”µå­è¡¨æ ¼ï¼ŒKimi å¯ä»¥é˜…è¯»è¿™äº›æ–‡ä»¶çš„å†…å®¹å¹¶æ®æ­¤å›ç­”é—®é¢˜ã€‚\næœç´¢èƒ½åŠ›ï¼šKimi å¯ä»¥ç»“åˆæœç´¢ç»“æœæ¥æä¾›æ›´å…¨é¢å’Œå‡†ç¡®çš„å›ç­”ã€‚",
    "crumbs": [
      "<span class='chapter-number'>7</span>Â  <span class='chapter-title'>Moonshot Kimi</span>"
    ]
  },
  {
    "objectID": "moonshot-kimi.html#åŸºäºæ–‡æ¡£çš„å¯¹è¯",
    "href": "moonshot-kimi.html#åŸºäºæ–‡æ¡£çš„å¯¹è¯",
    "title": "7Â  Moonshot Kimi",
    "section": "7.2 åŸºäºæ–‡æ¡£çš„å¯¹è¯",
    "text": "7.2 åŸºäºæ–‡æ¡£çš„å¯¹è¯\nKimi æä¾›çš„æ–‡æ¡£ä¸Šä¼ åŠŸèƒ½é‡‡ç”¨ OpenAI ç›¸åŒçš„æ¥å£æ ‡å‡†ã€‚\nä»¥ä¸‹æ˜¯ä½¿ç”¨ Python ä»£ç å’Œ OpenAI SDK ä¸Šä¼  PDF æ–‡æ¡£å¹¶å®ç°åŸºäºæ–‡æ¡£å¯¹è¯çš„æ­¥éª¤ã€‚\n\n7.2.1 å®‰è£… OpenAI SDK\nå¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£… OpenAI SDKï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š\npip install --upgrade 'openai&gt;=1.0'\n\n\n7.2.2 ä¸Šä¼ æ–‡ä»¶\nç¼–å†™ä»£ç ä¸Šä¼ æ–‡ä»¶ï¼šä½¿ç”¨ä»¥ä¸‹ Python ä»£ç ç¤ºä¾‹ä¸Šä¼  PDF æ–‡ä»¶ã€‚è¯·ç¡®ä¿å°†$MOONSHOT_API_KEYæ›¿æ¢ä¸ºä½ çš„å®é™…APIå¯†é’¥ã€‚\n\nfrom pathlib import Path\nfrom openai import OpenAI\nimport os\n\nclient = OpenAI(\n   api_key = MOONSHOT_API_KEY,  # æ›¿æ¢ä¸ºä½ çš„APIå¯†é’¥\n   base_url = \"https://api.moonshot.cn/v1\",\n)\n\n\n# æŒ‡å®šè¦ä¸Šä¼ çš„PDFæ–‡ä»¶è·¯å¾„\npdf_file_path = Path(\"example/Kraken2.pdf\")\n\n# ä¸Šä¼ æ–‡ä»¶\nfile_object = client.files.create(file = pdf_file_path, \n                                  purpose = \"file-extract\")\n\nprint(f\"æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œæ–‡ä»¶ID: {file_object.id}\")\n\næ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œæ–‡ä»¶ID: crkm4io04rj08lpsiulg\n\n\n\n\n7.2.3 è·å–æ–‡ä»¶å†…å®¹\nä¸Šä¼ æ–‡ä»¶åï¼Œä½ å¯ä»¥ä½¿ç”¨æ–‡ä»¶IDæ¥è·å–æ–‡ä»¶å†…å®¹ã€‚\n\n# è·å–æ–‡ä»¶å†…å®¹\nfile_content = client.files.content(file_id=file_object.id).text\n\n\n# æ‰“å°å‰ 200 å­—\npprint(file_content[:200], width = 72)\n\n('{\"content\":\"åˆ©â½¤å®åŸºå› ç»„çš„readsè¿›â¾ç‰©ç§æ³¨é‡Šçš„å¸¸â½¤â¼¯å…·æœ‰å¾ˆå¤šï¼Œå®ƒä»¬é€šè¿‡â½å¯¹readsåˆ°å‚è€ƒæ•°æ®åº“æ¥è¯†åˆ«å¾®â½£ç‰©çš„åˆ†ç±»ä¿¡\\\\næ¯ã€‚ä»¥ä¸‹æ˜¯â¼ç§å¸¸â½¤çš„â¼¯å…·ï¼š\\\\n1. '\n 'Kraken2\\\\nâ¼¯ä½œåŸç†ï¼šåŸºäºk-merâ½å¯¹æŠ€æœ¯ï¼Œå°†readsâ½å¯¹åˆ°å‚è€ƒæ•°æ®åº“ä¸­çš„ç‰¹å®šk-meré›†åˆï¼Œä»¥å®ç°å¿«é€Ÿçš„åˆ†ç±»æ³¨\\\\né‡Šã€‚\\\\nä¼˜ç‚¹ï¼šé€Ÿåº¦â¾®å¸¸å¿«ï¼Œèƒ½å¤„ç†â¼¤è§„æ¨¡æ•°æ®ã€‚\\\\næ•°æ®åº“ï¼šKraken2å…è®¸ä½¿â½¤æ ‡å‡†æ•°æ®åº“ï¼ˆå¦‚NCBI ')\n\n\n\n\n7.2.4 ä½¿ç”¨æ–‡ä»¶å†…å®¹å¯¹è¯\nä½¿ç”¨æ–‡ä»¶å†…å®¹è¿›è¡Œå¯¹è¯æ˜¯ä¸€ç§å¸¸è§çš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯åœ¨éœ€è¦ç»“åˆç‰¹å®šæ–‡æ¡£å†…å®¹æ¥å›ç­”ç”¨æˆ·é—®é¢˜æ—¶ã€‚\nä¸€æ—¦ä½ è·å–äº†æ–‡ä»¶å†…å®¹ï¼Œå°±å¯ä»¥å°†å…¶ä½œä¸ºè¾“å…¥ä¼ é€’ç»™Kimiè¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†æˆ–åˆ†æã€‚å…·ä½“åšæ³•æ˜¯å°†è·å–çš„æ–‡ä»¶å†…å®¹ä½œä¸ºç³»ç»Ÿæç¤ºï¼ˆsystem messageï¼‰åŠ å…¥åˆ°å¯¹è¯ä¸­ï¼Œç„¶åå‘é€ç”¨æˆ·çš„é—®é¢˜ã€‚\n\nmessages = [\n    {\n        \"role\": \"system\",\n        \"content\": \"ä½ æ˜¯Kimiï¼Œç”±Moonshot AIæä¾›çš„äººå·¥æ™ºèƒ½åŠ©æ‰‹ã€‚\"\n    },\n    {\n        \"role\": \"system\",\n        \"content\": file_content  # å°†æ–‡ä»¶å†…å®¹ä½œä¸ºç³»ç»Ÿæç¤º\n    },\n    {\n        \"role\": \"user\",\n        \"content\": \"æ€»ç»“ä¸€ä¸‹è¿™ä»½æ–‡ä»¶ä¸­çš„å†…å®¹\"\n    }\n]\n\n# å‘é€å¯¹è¯è¯·æ±‚\nresponse = client.chat.completions.create(\n    model=\"moonshot-v1-32k\",\n    messages=messages,\n    temperature=0.3,\n)\n\n# æ‰“å°å›ç­”\nMarkdown(response.choices[0].message.content)\n\nè¿™ä»½æ–‡ä»¶æ˜¯å…³äºå¦‚ä½•ä½¿ç”¨å®åŸºå› ç»„å­¦å·¥å…·Kraken2è¿›è¡Œç‰©ç§æ³¨é‡Šçš„æŒ‡å—ã€‚ä»¥ä¸‹æ˜¯æ–‡ä»¶å†…å®¹çš„æ€»ç»“ï¼š\n\nå®åŸºå› ç»„ç‰©ç§æ³¨é‡Šå·¥å…·ï¼š\n\nKraken2ï¼šåŸºäºk-meræ¯”å¯¹æŠ€æœ¯ï¼Œå¿«é€Ÿå¤„ç†å¤§è§„æ¨¡æ•°æ®ï¼Œæ”¯æŒæ ‡å‡†æ•°æ®åº“å’Œè‡ªå®šä¹‰æ•°æ®åº“ã€‚\nMetaPhlAn (MetaPhlAn3)ï¼šä½¿ç”¨å·²çŸ¥å¾®ç”Ÿç‰©çš„æ ‡è®°åŸºå› è¿›è¡Œæ¯”å¯¹ï¼Œé€‚åˆåˆ†æç‰©ç§ç›¸å¯¹ä¸°åº¦ã€‚\nCentrifugeï¼šåŸºäºå‹ç¼©ç´¢å¼•æŠ€æœ¯ï¼Œå¤„ç†è¾ƒå¤§æ•°æ®åº“ï¼Œé€‚åˆä½è´¨é‡readsã€‚\n\nKraken2çš„Standard-8æ•°æ®åº“ï¼š\n\næ•°æ®åº“å¤§å°é™åˆ¶ï¼šé™åˆ¶ä¸º8 GBï¼Œé€‚åˆèµ„æºæœ‰é™çš„ç¯å¢ƒã€‚\né’ˆå¯¹å¸¸è§ç‰©ç§ä¼˜åŒ–ï¼šä¿ç•™äº†å¸¸è§å’Œä¸´åºŠç›¸å…³çš„å¾®ç”Ÿç‰©ç‰©ç§ã€‚\nå¿«é€Ÿåˆ†æï¼šæ•°æ®åº“è¾ƒå°ï¼Œæé«˜äº†åˆ†æé€Ÿåº¦å’Œé™ä½äº†èµ„æºéœ€æ±‚ã€‚\n\nKraken2çš„ä½¿ç”¨æ­¥éª¤ï¼š\n\nå®‰è£…Kraken2ï¼šé€šè¿‡BioCondaå®‰è£…ã€‚\nä¸‹è½½æ•°æ®åº“ï¼šå¯ä»¥é€‰æ‹©ä¸‹è½½æ ‡å‡†æ•°æ®åº“æˆ–æ„å»ºè‡ªå®šä¹‰æ•°æ®åº“ã€‚\nè¿è¡ŒKraken2ï¼šä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·è¿›è¡Œreadsçš„åˆ†ç±»æ³¨é‡Šã€‚\nåˆ†æç»“æœï¼šè¾“å‡ºåŒ…æ‹¬ç‰©ç§åˆ†ç±»ä¿¡æ¯å’Œä¸°åº¦ã€‚\n\nKraken2è¾“å‡ºæ–‡ä»¶ï¼š\n\nsample_report.txtï¼šåŒ…å«ç‰©ç§åˆ†ç±»çš„æ¯”ä¾‹å’Œç»Ÿè®¡ä¿¡æ¯ã€‚\nsample_output.txtï¼šæ¯æ¡readçš„åˆ†ç±»ç»“æœã€‚\n\nå¯è§†åŒ–ç»“æœï¼š\n\nä½¿ç”¨Ræˆ–Pythonç­‰å·¥å…·å¯¹åˆ†ç±»ç»“æœè¿›è¡Œå¯è§†åŒ–ï¼Œå¦‚Rä¸­çš„ggplot2åº“ã€‚\n\nç¤ºä¾‹ä»£ç ï¼š\n\næä¾›äº†ä¸€ä¸ªRè„šæœ¬ç¤ºä¾‹ï¼Œç”¨äºè¯»å–Kraken2çš„æŠ¥å‘Šæ–‡ä»¶å¹¶ç»˜åˆ¶å‰10ä¸ªç‰©ç§ç›¸å¯¹ä¸°åº¦çš„æŸ±çŠ¶å›¾ã€‚\n\n\næ–‡ä»¶è¿˜å¼ºè°ƒäº†Kraken2 Standard-8æ•°æ®åº“çš„ç‰¹ç‚¹ï¼ŒåŒ…æ‹¬å…¶é€‚ç”¨åœºæ™¯ï¼Œå¦‚å°å¼ç”µè„‘æœ¬åœ°åˆ†æã€äº‘è®¡ç®—ç¯å¢ƒä¸­æœ‰å­˜å‚¨é™åˆ¶çš„åˆ†æï¼Œä»¥åŠéœ€è¦å¿«é€Ÿè·å¾—åˆæ­¥ç»“æœçš„æƒ…å†µã€‚\n\n\n\n\n7.2.5 å‘èµ·è¿½é—®\nå¦‚æœä½ éœ€è¦ç»§ç»­è¿½é—® PDF æ–‡æ¡£ä¸­çš„å†…å®¹ï¼Œä½ å¯ä»¥åœ¨å¯¹è¯å†å²ä¸­æ·»åŠ ç”¨æˆ·çš„é—®é¢˜ï¼ˆuser messageï¼‰ï¼Œç„¶åè°ƒç”¨ Chat Completion æ¥å£æ¥è·å–æ¨¡å‹çš„å›ç­”ã€‚\n\n# å‘èµ·è¿½é—®\nfollow_up_question = \"è¿™ä»½æ–‡æ¡£ä¸­æåˆ°çš„å…³é”®æŠ€æœ¯æ˜¯ä»€ä¹ˆï¼Ÿ\"\nmessages.append({\"role\": \"user\", \"content\": follow_up_question})\nfollow_up_response = client.chat.completions.create(\n    model=\"moonshot-v1-32k\",\n    messages=messages,\n    temperature=0.3,\n)\n\n# æ‰“å°è¿½é—®çš„å›ç­”\nMarkdown(follow_up_response.choices[0].message.content)\n\nè¿™ä»½æ–‡æ¡£ä¸­æåˆ°çš„å…³é”®æŠ€æœ¯æ˜¯å®åŸºå› ç»„å­¦ä¸­çš„ç‰©ç§æ³¨é‡Šå·¥å…·ï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ä¸‰ç§ï¼š\n\nKraken2ï¼šä¸€ç§åŸºäºk-meræ¯”å¯¹æŠ€æœ¯çš„ç‰©ç§æ³¨é‡Šå·¥å…·ï¼Œèƒ½å¤Ÿå¿«é€Ÿå¤„ç†å¤§è§„æ¨¡æ•°æ®ï¼Œé€šè¿‡æ¯”å¯¹readsåˆ°å‚è€ƒæ•°æ®åº“ä¸­çš„ç‰¹å®šk-meré›†åˆæ¥å®ç°åˆ†ç±»æ³¨é‡Šã€‚\nMetaPhlAn (MetaPhlAn3)ï¼šä½¿ç”¨å·²çŸ¥å¾®ç”Ÿç‰©çš„æ ‡è®°åŸºå› è¿›è¡Œæ¯”å¯¹ï¼Œä¸“æ³¨äºæ¯ä¸ªç‰©ç§çš„æ ‡è®°åŸºå› è¿›è¡Œåˆ†ç±»ï¼Œé€‚åˆåˆ†æç‰©ç§ç›¸å¯¹ä¸°åº¦ï¼Œè®¡ç®—æ•ˆç‡é«˜ã€‚\nCentrifugeï¼šåŸºäºå‹ç¼©ç´¢å¼•æŠ€æœ¯ï¼Œå°†readsä¸å‹ç¼©å‚è€ƒæ•°æ®åº“ä¸­çš„åŸºå› ç»„åºåˆ—è¿›è¡Œæ¯”å¯¹ï¼Œé€‚åˆå¤„ç†ä½è´¨é‡çš„readsï¼Œå¤„ç†è¾ƒå¤§æ•°æ®åº“å¹¶ä¸”æ¯”å¯¹é€Ÿåº¦å¿«ã€‚\n\næ–‡æ¡£è¿˜ç‰¹åˆ«ä»‹ç»äº†Kraken2çš„Standard-8æ•°æ®åº“ï¼Œè¿™æ˜¯ä¸€ä¸ªä¼˜åŒ–ç‰ˆæœ¬ï¼Œæ—¨åœ¨èµ„æºæœ‰é™çš„ç¯å¢ƒä¸­æä¾›æœ‰æ•ˆçš„åˆ†ç±»èƒ½åŠ›ï¼Œå…¶ç‰¹ç‚¹åŒ…æ‹¬ï¼š\n\næ•°æ®åº“å¤§å°é™åˆ¶ä¸º8 GBï¼Œé€‚åˆè®¡ç®—èµ„æºæœ‰é™çš„åœºæ™¯ã€‚\né’ˆå¯¹å¸¸è§ç‰©ç§ä¼˜åŒ–ï¼Œä¿ç•™äº†å¸¸è§å’Œä¸´åºŠç›¸å…³æ€§è¾ƒé«˜çš„å¾®ç”Ÿç‰©ç‰©ç§å’Œåˆ†ç±»å•å…ƒã€‚\nåˆ†æé€Ÿåº¦å¿«ï¼Œå†…å­˜å’Œå­˜å‚¨éœ€æ±‚ä½ã€‚\né€‚ç”¨äºä¸€èˆ¬æ€§å®åŸºå› ç»„åˆ†æï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦å¿«é€Ÿè·å¾—åˆ†æç»“æœæˆ–èµ„æºæœ‰é™çš„æƒ…å†µä¸‹ã€‚\n\næ–‡æ¡£è¿˜æä¾›äº†ä½¿ç”¨Kraken2è¿›è¡Œå®åŸºå› ç»„æµ‹åºæ•°æ®ç‰©ç§æ³¨é‡Šåˆ†æçš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…Kraken2ã€ä¸‹è½½æ•°æ®åº“ã€è¿è¡ŒKraken2è¿›è¡Œåˆ†ç±»æ³¨é‡Šï¼Œä»¥åŠåˆ†æç»“æœã€‚æœ€åï¼Œæ–‡æ¡£æä¾›äº†ä¸€ä¸ªä½¿ç”¨Rè¯­è¨€è¿›è¡Œç»“æœå¯è§†åŒ–çš„ç¤ºä¾‹ã€‚\n\n\n\n\n7.2.6 å¤šè½®å¯¹è¯\nä¸Šé¢çš„å•è½®å¯¹è¯çš„ä¾‹å­ä¸­è¯­è¨€æ¨¡å‹å°†ç”¨æˆ·ä¿¡æ¯åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†æ¨¡å‹ç”Ÿæˆçš„ä¿¡æ¯ä½œä¸ºè¾“å‡ºè¿”å›ã€‚ æœ‰æ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†æ¨¡å‹è¾“å‡ºçš„ç»“æœç»§ç»­ä½œä¸ºè¾“å…¥çš„ä¸€éƒ¨åˆ†ä»¥å®ç°å¤šè½®å¯¹è¯ã€‚\nKimi API ä¸ Kimi æ™ºèƒ½åŠ©æ‰‹ä¸åŒï¼ŒAPI æœ¬èº«ä¸å…·æœ‰è®°å¿†åŠŸèƒ½ï¼Œå®ƒæ˜¯æ— çŠ¶æ€çš„ï¼Œè¿™æ„å‘³ç€ï¼Œå½“ä½ å¤šæ¬¡è¯·æ±‚ API æ—¶ï¼ŒKimi å¤§æ¨¡å‹å¹¶ä¸çŸ¥é“ä½ å‰ä¸€æ¬¡è¯·æ±‚çš„å†…å®¹ï¼Œä¹Ÿä¸ä¼šè®°å¿†ä»»ä½•è¯·æ±‚çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œä½ åœ¨å‰ä¸€æ¬¡è¯·æ±‚ä¸­å‘Šè¯‰ Kimi å¤§æ¨¡å‹ä½ ä»Šå¹´ 27 å²ï¼Œåœ¨ä¸‹ä¸€æ¬¡è¯·æ±‚ä¸­ï¼ŒKimi å¤§æ¨¡å‹å¹¶ä¸ä¼šè®°ä½ä½  27 å²è¿™ä»¶äº‹ã€‚\nå› æ­¤ï¼Œåœ¨å¤šè½®å¯¹è¯ä¸­æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç»´æŠ¤æ¯æ¬¡è¯·æ±‚çš„ä¸Šä¸‹æ–‡ï¼Œå³ Contextï¼ŒæŠŠä¸Šä¸€æ¬¡è¯·æ±‚è¿‡çš„å†…å®¹æ‰‹åŠ¨åŠ å…¥åˆ°ä¸‹ä¸€æ¬¡è¯·æ±‚ä¸­ï¼Œè®© Kimi å¤§æ¨¡å‹èƒ½æ­£ç¡®çœ‹åˆ°æ­¤å‰æˆ‘ä»¬éƒ½èŠäº†ä»€ä¹ˆã€‚\nä¸‹é¢æ˜¯ä¸€ç»„ç®€å•çš„å®ç°å¤šè½®å¯¹è¯çš„ä¾‹å­ï¼š\n\n# å‡è®¾éœ€è¦è¿½é—®\ndef chat(query, messages):\n    messages.append({\n        \"role\": \"user\", \n        \"content\": query\n    })\n    completion = client.chat.completions.create(\n        model=\"moonshot-v1-8k\",\n        messages=messages,\n        temperature=0.3,\n    )\n    result = completion.choices[0].message.content\n    messages.append({\n        \"role\": \"assistant\",\n        \"content\": result\n    })\n    return result\n\nä½¿ç”¨è‡ªå®šä¹‰å‡½æ•° chat() ç»§ç»­é—®æ–°çš„é—®é¢˜ã€‚\nprint(chat(\"Kraken2 æœ‰å“ªäº›æ•°æ®åº“\", messages))\næ–‡æ¡£ä¸­æåˆ°çš„å…³é”®æŠ€æœ¯æ˜¯å®åŸºå› ç»„æµ‹åºæ•°æ®çš„ç‰©ç§æ³¨é‡Šåˆ†æï¼Œä¸»è¦é€šè¿‡æ¯”å¯¹readsåˆ°å‚è€ƒæ•°æ®åº“æ¥è¯†åˆ«å¾®ç”Ÿç‰©çš„åˆ†ç±»ä¿¡æ¯ã€‚æ–‡æ¡£ä¸­æåˆ°çš„å¸¸ç”¨å·¥å…·åŒ…æ‹¬Kraken2ã€MetaPhlAnï¼ˆMetaPhlAn3ï¼‰å’ŒCentrifugeã€‚\nKraken2çš„æ•°æ®åº“åŒ…æ‹¬ï¼š 1. æ ‡å‡†æ•°æ®åº“ï¼ˆStandard Databaseï¼‰ï¼šè¿™æ˜¯Kraken2çš„é»˜è®¤æ•°æ®åº“ï¼Œé€šå¸¸åŒ…å«ç»†èŒã€ç—…æ¯’ã€çœŸèŒç­‰å¤šç§å¾®ç”Ÿç‰©çš„å‚è€ƒåºåˆ—ï¼Œæ•°æ®åº“å¤§å°é€šå¸¸åœ¨å‡ åGBåˆ°ä¸Šç™¾GBä¸ç­‰ã€‚ 2. Standard-8æ•°æ®åº“ï¼šè¿™æ˜¯æ ‡å‡†æ•°æ®åº“çš„ä¸€ä¸ªä¼˜åŒ–ç‰ˆæœ¬ï¼Œæ—¨åœ¨åœ¨èµ„æºæœ‰é™çš„ç¯å¢ƒä¸­æä¾›æœ‰æ•ˆçš„åˆ†ç±»èƒ½åŠ›ã€‚å®ƒçš„æ•°æ®åº“å¤§å°è¢«é™åˆ¶åœ¨8GBä»¥å†…ï¼Œä¿ç•™äº†å¸¸è§å’Œä¸´åºŠç›¸å…³æ€§è¾ƒé«˜çš„å¾®ç”Ÿç‰©ç‰©ç§å’Œåˆ†ç±»å•å…ƒï¼Œé€‚åˆå¿«é€Ÿåˆ†æå’Œèµ„æºæœ‰é™çš„æƒ…å†µã€‚\næ–‡æ¡£ä¸­è¿˜æåˆ°äº†å¦‚ä½•å®‰è£…Kraken2ã€ä¸‹è½½æ•°æ®åº“ã€è¿è¡ŒKraken2è¿›è¡Œç‰©ç§æ³¨é‡Šï¼Œä»¥åŠå¦‚ä½•åˆ†æKraken2çš„è¾“å‡ºç»“æœã€‚æ­¤å¤–ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªä½¿ç”¨Rè¯­è¨€è¿›è¡Œæ•°æ®å¯è§†åŒ–çš„ç®€å•ç¤ºä¾‹ã€‚\n\n\n\n\n\n\nWarning\n\n\n\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œéšç€å¯¹è¯çš„è¿›è¡Œï¼Œæ¨¡å‹æ¯æ¬¡éœ€è¦ä¼ å…¥çš„ token éƒ½ä¼šçº¿æ€§å¢åŠ ï¼Œå¿…è¦æ—¶ï¼Œéœ€è¦ä¸€äº›ç­–ç•¥è¿›è¡Œä¼˜åŒ–ï¼Œä¾‹å¦‚åªä¿ç•™æœ€è¿‘å‡ è½®å¯¹è¯ã€‚",
    "crumbs": [
      "<span class='chapter-number'>7</span>Â  <span class='chapter-title'>Moonshot Kimi</span>"
    ]
  },
  {
    "objectID": "moonshot-kimi.html#ä¸Šä¼ å¤šä¸ªæ–‡ä»¶",
    "href": "moonshot-kimi.html#ä¸Šä¼ å¤šä¸ªæ–‡ä»¶",
    "title": "7Â  Moonshot Kimi",
    "section": "7.3 ä¸Šä¼ å¤šä¸ªæ–‡ä»¶",
    "text": "7.3 ä¸Šä¼ å¤šä¸ªæ–‡ä»¶\nå¦‚æœä½ æƒ³ä¸€æ¬¡æ€§ä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶æ ¹æ®è¿™äº›æ–‡ä»¶ä¸ Kimi å¯¹è¯ï¼Œä½ å¯ä»¥å‚è€ƒå¦‚ä¸‹ç¤ºä¾‹ï¼š\nfrom typing import *\n \nimport os\nimport json\nfrom pathlib import Path\n \nfrom openai import OpenAI\n \nclient = OpenAI(\n    base_url=\"https://api.moonshot.cn/v1\",\n    # æˆ‘ä»¬ä¼šä»ç¯å¢ƒå˜é‡ä¸­è·å– MOONSHOT_API_KEY çš„å€¼ä½œä¸º API Keyï¼Œ\n    api_key=os.environ[\"MOONSHOT_API_KEY\"],\n)\n \n \ndef upload_files(files: List[str]) -&gt; List[Dict[str, Any]]:\n    \"\"\"\n    upload_files ä¼šå°†ä¼ å…¥çš„æ–‡ä»¶ï¼ˆè·¯å¾„ï¼‰å…¨éƒ¨é€šè¿‡æ–‡ä»¶ä¸Šä¼ æ¥å£ '/v1/files' ä¸Šä¼ ï¼Œ\n    å¹¶è·å–ä¸Šä¼ åçš„æ–‡ä»¶å†…å®¹ç”Ÿæˆæ–‡ä»¶ messagesã€‚æ¯ä¸ªæ–‡ä»¶ä¼šæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ messageï¼Œ\n    è¿™äº› message çš„ role å‡ä¸º systemï¼ŒKimi å¤§æ¨¡å‹ä¼šæ­£ç¡®è¯†åˆ«è¿™äº› system messages\n    ä¸­çš„æ–‡ä»¶å†…å®¹ã€‚\n \n    :param files: ä¸€ä¸ªåŒ…å«è¦ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„çš„åˆ—è¡¨ï¼Œè·¯å¾„å¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ä¹Ÿå¯ä»¥æ˜¯\n        ç›¸å¯¹è·¯å¾„ï¼Œè¯·ä½¿ç”¨å­—ç¬¦ä¸²çš„å½¢å¼ä¼ é€’æ–‡ä»¶è·¯å¾„ã€‚\n    :return: ä¸€ä¸ªåŒ…å«äº†æ–‡ä»¶å†…å®¹çš„ messages åˆ—è¡¨ï¼Œè¯·å°†è¿™äº› messages åŠ å…¥åˆ° \n        Context ä¸­ï¼Œå³è¯·æ±‚ `/v1/chat/completions` æ¥å£æ—¶çš„ messages å‚æ•°ä¸­ã€‚\n    \"\"\"\n    messages = []\n \n    # å¯¹æ¯ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œæˆ‘ä»¬éƒ½ä¼šä¸Šä¼ æ–‡ä»¶å¹¶æŠ½å–æ–‡ä»¶å†…å®¹ï¼Œæœ€åç”Ÿæˆä¸€ä¸ª role \n    # ä¸º system çš„ messageï¼Œå¹¶åŠ å…¥åˆ°æœ€ç»ˆè¿”å›çš„ messages åˆ—è¡¨ä¸­ã€‚\n    for file in files:\n        file_object = client.files.create(file=Path(file), \n                                          purpose=\"file-extract\")\n        file_content = client.files.content(file_id=file_object.id).text\n        messages.append({\n            \"role\": \"system\",\n            \"content\": file_content,\n        })\n \n    return messages\n \n \ndef main():\n    # ä½¿ç”¨globæ–¹æ³•ä¸é€šé…ç¬¦**/*æ¥è·å–ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½•ä¸­çš„æ–‡ä»¶\n    file_messages = upload_files(files=Path(\"example\").glob(\"**/*\"))\n \n    messages = [\n        # æˆ‘ä»¬ä½¿ç”¨ * è¯­æ³•ï¼Œæ¥è§£æ„ file_messages æ¶ˆæ¯ï¼Œä½¿å…¶æˆä¸º messages åˆ—è¡¨çš„å‰ N æ¡ messagesã€‚\n        *file_messages,\n        {\n            \"role\": \"system\",\n            \"content\": \"ä½ æ˜¯ Kimiï¼Œç”± Moonshot AI æä¾›çš„äººå·¥æ™ºèƒ½åŠ©æ‰‹ã€‚\",\n        },\n        {\n            \"role\": \"user\",\n            \"content\": \"æ€»ç»“ä¸€ä¸‹è¿™äº›æ–‡ä»¶çš„å†…å®¹ã€‚\",\n        },\n    ]\n \n    completion = client.chat.completions.create(\n        model=\"moonshot-v1-128k\",\n        messages=messages,\n    )\n \n    print(completion.choices[0].message.content)\n \n \nif __name__ == '__main__':\n    main()\nè¿™äº›æ–‡ä»¶åŒ…å«äº†å¤šä¸ªä¸»é¢˜çš„ä¿¡æ¯ï¼Œæˆ‘å°†åˆ†åˆ«ä¸ºæ‚¨æ€»ç»“æ¯ä¸ªæ–‡ä»¶çš„ä¸»è¦å†…å®¹ï¼š\n\nKraken2.pdfï¼š\n\nä»‹ç»äº†å‡ ç§å¸¸ç”¨çš„å®åŸºå› ç»„æ•°æ®åˆ†æå·¥å…·ï¼ŒåŒ…æ‹¬Kraken2ã€MetaPhlAn3å’ŒCentrifugeï¼Œå®ƒä»¬é€šè¿‡æ¯”å¯¹readsåˆ°å‚è€ƒæ•°æ®åº“æ¥è¯†åˆ«å¾®ç”Ÿç‰©çš„åˆ†ç±»ä¿¡æ¯ã€‚\nKraken2ä½¿ç”¨k-meræ¯”å¯¹æŠ€æœ¯ï¼Œé€Ÿåº¦å¿«ï¼Œé€‚åˆå¤§è§„æ¨¡æ•°æ®å¤„ç†ï¼Œæ”¯æŒè‡ªå®šä¹‰æ•°æ®åº“ã€‚\nMetaPhlAn3ä½¿ç”¨æ ‡è®°åŸºå› è¿›è¡Œç‰©ç§åˆ†ç±»ï¼Œé€‚åˆåˆ†æç‰©ç§ç›¸å¯¹ä¸°åº¦ï¼Œè®¡ç®—æ•ˆç‡é«˜ã€‚\nCentrifugeåŸºäºå‹ç¼©ç´¢å¼•æŠ€æœ¯ï¼Œé€‚åˆå¤„ç†ä½è´¨é‡readsï¼Œæ”¯æŒè‡ªå®šä¹‰æ•°æ®åº“ã€‚\næä¾›äº†Kraken2çš„å®‰è£…ã€æ•°æ®åº“ä¸‹è½½ã€è¿è¡Œåˆ†ç±»æ³¨é‡Šå’Œç»“æœåˆ†æçš„è¯¦ç»†æ­¥éª¤ã€‚\nä»‹ç»äº†å¦‚ä½•ä½¿ç”¨Ræˆ–Pythonè¿›è¡Œç»“æœçš„å¯è§†åŒ–ã€‚\n\nsyncom-group-library.mdï¼š\n\næè¿°äº†ä¸€ä¸ªåä¸ºâ€œåœŸå£¤ç”Ÿç‰©è†œä¸ç¯å¢ƒå¥åº·ä¹¦å±‹â€çš„å›¾ä¹¦å€Ÿé˜…æœåŠ¡ï¼Œæ—¨åœ¨æœåŠ¡äºä¸åŒé˜¶æ®µçš„å­¦ç”Ÿå’Œç ”ç©¶äººå‘˜ã€‚\næä¾›äº†ä¹¦å±‹çš„å¼€æ”¾æ—¶é—´ã€å€Ÿé˜…æœŸé™ã€æ‰¹æ³¨å’Œæ ‡è®°çš„é¼“åŠ±ä»¥åŠå›¾ä¹¦å¤–å€Ÿçš„ç™»è®°è¦æ±‚ã€‚\n\nlaboratory-instruments.docxï¼š\n\nåˆ—å‡ºäº†åä¸­å†œä¸šå¤§å­¦èµ„æºä¸ç¯å¢ƒå­¦é™¢çš„å®éªŒå®¤è®¾å¤‡ï¼ŒåŒ…æ‹¬åŸ¹å…»è®¾å¤‡ã€åˆ†å­ç”Ÿç‰©å­¦è®¾å¤‡ã€åŸºç¡€å¾®ç”Ÿç‰©å®éªŒè®¾å¤‡ã€è®¡ç®—è®¾æ–½å’Œå…¶ä»–è®¾å¤‡ã€‚\nè¯¦ç»†è¯´æ˜äº†æ¯ç§è®¾å¤‡çš„ç”¨é€”ã€ä½ç½®å’Œä½¿ç”¨æ³¨æ„äº‹é¡¹ã€‚\n\ngaoch-cv.mdï¼š\n\né«˜æ˜¥è¾‰çš„ä¸ªäººç®€ä»‹ï¼Œä»–æ˜¯åä¸­å†œä¸šå¤§å­¦èµ„æºä¸ç¯å¢ƒå­¦é™¢çš„å‰¯ç ”ç©¶å‘˜ï¼Œç¡•å£«ç”Ÿå¯¼å¸ˆã€‚\nä»–çš„ç ”ç©¶é¢†åŸŸåŒ…æ‹¬åˆ†å­ç”Ÿç‰©å­¦ã€ç”Ÿç‰©åŒ–å­¦ã€ç”Ÿç‰©ä¿¡æ¯å­¦å’ŒåŠŸèƒ½åŸºå› ç»„å­¦ï¼Œç›®å‰ä¸“æ³¨äºåˆæˆå¾®ç”Ÿç‰©ç¾¤è½çš„ç ”ç©¶ã€‚\nä»–ä¸»æŒè¿‡å¤šä¸ªç§‘ç ”é¡¹ç›®ï¼Œå¹¶åœ¨å¤šä¸ªå­¦æœ¯æœŸåˆŠä¸Šå‘è¡¨äº†ç ”ç©¶è®ºæ–‡ã€‚\n\nmachine-learning-course.mdï¼š\n\næä¾›äº†å¤šä¸ªæœºå™¨å­¦ä¹ è¯¾ç¨‹çš„åŸ¹è®­ç›®å½•ï¼Œæ¶µç›–æ·±åº¦å­¦ä¹ åœ¨åŸºå› ç»„å­¦ã€å•ç»†èƒåˆ†æã€å•ç»†èƒç©ºé—´è½¬å½•ç»„åˆ†æã€è›‹ç™½ç»„å­¦ã€å¾®ç”Ÿç‰©ç»„å­¦å’Œä»£è°¢ç»„å­¦ä¸­çš„åº”ç”¨ã€‚\næ¯ä¸ªè¯¾ç¨‹åŒ…æ‹¬ç†è®ºéƒ¨åˆ†å’Œå®æ“å†…å®¹ï¼Œæ¶‰åŠç®—æ³•ä»‹ç»ã€æ•°æ®å¤„ç†ã€æ¨¡å‹æ„å»ºå’Œè¯„ä¼°ç­‰ã€‚\n\n\nè¿™äº›æ–‡ä»¶æ¶µç›–äº†ä»å®åŸºå› ç»„æ•°æ®åˆ†æå·¥å…·çš„ä½¿ç”¨ã€å›¾ä¹¦å€Ÿé˜…è§„åˆ™ã€å®éªŒå®¤è®¾å¤‡æ¸…å•ã€ä¸ªäººç®€ä»‹åˆ°æœºå™¨å­¦ä¹ åœ¨ä¸åŒç”Ÿç‰©ä¿¡æ¯å­¦é¢†åŸŸçš„åº”ç”¨ç­‰å¤šä¸ªæ–¹é¢çš„å†…å®¹ã€‚\næ–‡ä»¶æ¥å£ä¸ Kimi æ™ºèƒ½åŠ©æ‰‹ä¸­ä¸Šä¼ æ–‡ä»¶åŠŸèƒ½æ‰€ä½¿ç”¨çš„ç›¸åŒï¼Œæ”¯æŒç›¸åŒçš„æ–‡ä»¶æ ¼å¼ï¼Œå®ƒä»¬åŒ…æ‹¬ .pdf .txt .csv .doc .docx .xls .xlsx .ppt``.pptx .md .jpeg .png .bmp .gif .svg .svgz .webp .ico .xbm .dib .pjp .tif .pjpeg .avif .dot .apng .epub .tiff``.jfif .html .json .mobi .log .go .h .c .cpp .cxx .cc .cs .java .js .css .jsp .php .py .py3 .asp .yaml .yml``.ini .conf .ts .tsx ç­‰æ ¼å¼ã€‚\nå¦‚æœæ‚¨çš„æ–‡ä»¶æ•°é‡å¤šã€ä½“ç§¯å¤§ã€å†…å®¹é•¿ï¼Œå¹¶ä¸”æ‚¨ä¸æƒ³åœ¨æ¯æ¬¡è¯·æ±‚éƒ½åŸæ ·æºå¸¦å¤§ä½“ç§¯çš„æ–‡ä»¶å†…å®¹ï¼Œæˆ–æ˜¯æƒ³å¯»æ±‚æ›´åŠ é«˜æ•ˆä¸”ä½æˆæœ¬çš„æ–‡ä»¶å¯¹è¯æ–¹å¼ï¼Œè¯·å‚è€ƒä½¿ç”¨äº† Context Caching æŠ€æœ¯çš„æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹ã€‚\n\nä¸Šä¸‹æ–‡ç¼“å­˜ Context Caching ï¼ˆä¸Šä¸‹æ–‡ç¼“å­˜ï¼‰æ˜¯ä¸€ç§é«˜æ•ˆçš„æ•°æ®ç®¡ç†æŠ€æœ¯ï¼Œå®ƒå…è®¸ç³»ç»Ÿé¢„å…ˆå­˜å‚¨é‚£äº›å¯èƒ½ä¼šè¢«é¢‘ç¹è¯·æ±‚çš„å¤§é‡æ•°æ®æˆ–ä¿¡æ¯ã€‚è¿™æ ·ï¼Œå½“æ‚¨å†æ¬¡è¯·æ±‚ç›¸åŒä¿¡æ¯æ—¶ï¼Œç³»ç»Ÿå¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­å¿«é€Ÿæä¾›ï¼Œè€Œæ— éœ€é‡æ–°è®¡ç®—æˆ–ä»åŸå§‹æ•°æ®æºä¸­æ£€ç´¢ï¼Œä»è€ŒèŠ‚çœæ—¶é—´å’Œèµ„æºã€‚ä½¿ç”¨ Context Caching æ—¶ï¼Œé¦–å…ˆéœ€è¦é€šè¿‡ API åˆ›å»ºç¼“å­˜ï¼ŒæŒ‡å®šè¦å­˜å‚¨çš„æ•°æ®ç±»å‹å’Œå†…å®¹ï¼Œç„¶åè®¾ç½®ä¸€ä¸ªåˆé€‚çš„è¿‡æœŸæ—¶é—´ä»¥ä¿æŒæ•°æ®çš„æœ‰æ•ˆæ€§ã€‚ä¸€æ—¦ç¼“å­˜åˆ›å»ºå®Œæˆï¼Œä»»ä½•å¯¹è¯¥æ•°æ®çš„è¯·æ±‚éƒ½ä¼šé¦–å…ˆæ£€æŸ¥ç¼“å­˜ï¼Œå¦‚æœç¼“å­˜æœ‰æ•ˆï¼Œåˆ™ç›´æ¥ä½¿ç”¨ç¼“å­˜ï¼ˆæ­¤æ—¶å·²ç¼“å­˜çš„å†…å®¹å°†ä¸å†æ”¶å– Tokens è´¹ç”¨ï¼‰ï¼Œå¦åˆ™éœ€è¦é‡æ–°ç”Ÿæˆå¹¶æ›´æ–°ç¼“å­˜ã€‚è¿™ç§æ–¹æ³•ç‰¹åˆ«é€‚ç”¨äºéœ€è¦å¤„ç†å¤§é‡é‡å¤è¯·æ±‚çš„åº”ç”¨ç¨‹åºï¼Œå¯ä»¥æ˜¾è‘—æé«˜å“åº”é€Ÿåº¦å’Œç³»ç»Ÿæ€§èƒ½ã€‚",
    "crumbs": [
      "<span class='chapter-number'>7</span>Â  <span class='chapter-title'>Moonshot Kimi</span>"
    ]
  },
  {
    "objectID": "bigmodel.html",
    "href": "bigmodel.html",
    "title": "8Â  æ™ºè°±å¼€æ”¾å¹³å°",
    "section": "",
    "text": "8.1 æ¨¡å‹æ¸…å•\næ™ºè°±AI å¼€æ”¾å¹³å°æä¾›äº†åŒ…æ‹¬é€šç”¨å¤§æ¨¡å‹ã€å›¾åƒå¤§æ¨¡å‹ã€è¶…æ‹Ÿäººå¤§æ¨¡å‹ã€å‘é‡å¤§æ¨¡å‹ç­‰å¤šç§æ¨¡å‹ã€‚",
    "crumbs": [
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>æ™ºè°±å¼€æ”¾å¹³å°</span>"
    ]
  },
  {
    "objectID": "bigmodel.html#æ¨¡å‹æ¸…å•",
    "href": "bigmodel.html#æ¨¡å‹æ¸…å•",
    "title": "8Â  æ™ºè°±å¼€æ”¾å¹³å°",
    "section": "",
    "text": "8.1.1 è¯­è¨€æ¨¡å‹\n\n\n\n\n\n\n\n\n\næ¨¡å‹\næè¿°\nä¸Šä¸‹æ–‡\næœ€å¤§è¾“å‡º\n\n\n\n\nGLM-4-Plus\né«˜æ™ºèƒ½æ——èˆ°: æ€§èƒ½å…¨é¢æå‡ï¼Œé•¿æ–‡æœ¬å’Œå¤æ‚ä»»åŠ¡èƒ½åŠ›æ˜¾è‘—å¢å¼º\n128K\n4K\n\n\nGLM-4-0520\né«˜æ™ºèƒ½æ¨¡å‹ï¼šé€‚ç”¨äºå¤„ç†é«˜åº¦å¤æ‚å’Œå¤šæ ·åŒ–çš„ä»»åŠ¡\n128K\n4K\n\n\nGLM-4-Long\nè¶…é•¿è¾“å…¥ï¼šä¸“ä¸ºå¤„ç†è¶…é•¿æ–‡æœ¬å’Œè®°å¿†å‹ä»»åŠ¡è®¾è®¡\n1M\n4K\n\n\nGLM-4-AirX\næé€Ÿæ¨ç†ï¼šå…·æœ‰è¶…å¿«çš„æ¨ç†é€Ÿåº¦å’Œå¼ºå¤§çš„æ¨ç†æ•ˆæœ\n8K\n4K\n\n\nGLM-4-Air\né«˜æ€§ä»·æ¯”ï¼šæ¨ç†èƒ½åŠ›å’Œä»·æ ¼ä¹‹é—´æœ€å¹³è¡¡çš„æ¨¡å‹\n128K\n4K\n\n\nGLM-4-Flash\nå…è´¹è°ƒç”¨ï¼šæ™ºè°±AIé¦–ä¸ªå…è´¹APIï¼Œé›¶æˆæœ¬è°ƒç”¨å¤§æ¨¡å‹ã€‚\n128K\n4K\n\n\nGLM-4V\nå›¾åƒç†è§£ï¼šå…·å¤‡å›¾åƒç†è§£èƒ½åŠ›å’Œæ¨ç†èƒ½åŠ›\n2K\n1k\n\n\nGLM-4-AllTools\nAgentæ¨¡å‹ï¼šè‡ªä¸»è§„åˆ’å’Œæ‰§è¡Œå¤æ‚ä»»åŠ¡\n128K\n4K\n\n\nGLM-4\næ—§ç‰ˆæ——èˆ°ï¼šå‘å¸ƒäº2024å¹´1æœˆ16æ—¥ï¼Œç›®å‰å·²è¢«GLM-4-0520å–ä»£\n128K\n4K\n\n\n\n\n\n8.1.2 å¤šæ¨¡æ€æ¨¡å‹\n\n\n\n\n\n\n\n\n\næ¨¡å‹\næè¿°\næœ€å¤§è¾“å…¥\nè¾“å‡ºåˆ†è¾¨ç‡\n\n\n\n\nGLM-4V-Plus\nè§†é¢‘å’Œå›¾åƒç†è§£ï¼šå…·å¤‡è§†é¢‘å†…å®¹å’Œå¤šå›¾ç‰‡çš„ç†è§£èƒ½åŠ›\n8K\n-\n\n\nGLM-4V\nå›¾åƒç†è§£ï¼šå…·å¤‡å›¾åƒç†è§£èƒ½åŠ›å’Œæ¨ç†èƒ½åŠ›\n2K\n-\n\n\nCogVideoX\nè§†é¢‘ç”Ÿæˆï¼šè¾“å…¥æ–‡æœ¬æˆ–å›¾ç‰‡å³å¯è½»æ¾åˆ¶ä½œè§†é¢‘\n0.5K\n1440x960\n\n\nCogView-3.5\nå›¾ç‰‡ç”Ÿæˆï¼šæ ¹æ®ç”¨æˆ·æ–‡å­—æè¿°ç”Ÿæˆé«˜è´¨é‡å›¾åƒï¼Œæ”¯æŒå¤šå›¾ç‰‡å°ºå¯¸\n1k\n1024x1024\n768x1344\n864x1152 ç­‰\n\n\nCogView-3\nå›¾ç‰‡ç”Ÿæˆï¼šæ ¹æ®ç”¨æˆ·æ–‡å­—æè¿°å¿«é€Ÿã€ç²¾å‡†ç”Ÿæˆå›¾åƒ\n1k\n1024x1024\n\n\n\n\n\n8.1.3 å‘é‡æ¨¡å‹\n\n\n\n\n\n\n\n\n\næ¨¡å‹\næè¿°\næœ€å¤§è¾“å…¥\nå‘é‡ç»´åº¦\n\n\n\n\nEmbedding-3\næœ€æ–°æ¨¡å‹ï¼šæ”¯æŒè‡ªå®šä¹‰å‘é‡ç»´åº¦\n8K\n2048\n\n\nEmbedding-2\næ—§ç‰ˆæ¨¡å‹ï¼šç›®å‰å·²è¢«Embedding-3å–ä»£\n8K\n1024\n\n\n\n\n\n8.1.4 å…¶ä»–æ¨¡å‹\n\n\n\n\n\n\n\n\n\næ¨¡å‹\næè¿°\nä¸Šä¸‹æ–‡\næœ€å¤§è¾“å‡º\n\n\n\n\nChatGLM-3\næ‹Ÿäººæ¨¡å‹ï¼šé€‚ç”¨äºæƒ…æ„Ÿé™ªä¼´å’Œè™šæ‹Ÿè§’è‰²ã€‚\n4K\n2K\n\n\nEmohaa\nå¿ƒç†æ¨¡å‹ï¼šå…·å¤‡ä¸“ä¸šå’¨è¯¢èƒ½åŠ›ï¼Œå¸®åŠ©ç”¨æˆ·ç†è§£æƒ…æ„Ÿå¹¶åº”å¯¹æƒ…ç»ªé—®é¢˜ã€‚\n8K\n4k\n\n\nCodeGeeX-4\nä»£ç æ¨¡å‹ï¼šé€‚ç”¨äºä»£ç è‡ªåŠ¨è¡¥å…¨ä»»åŠ¡\n128K\n4k\n\n\n\n\n\n\n\n\n\nå…³é”®æ¦‚å¿µ\n\n\n\nGLM\nGLM å…¨å General Language Model ï¼Œæ˜¯ä¸€æ¬¾åŸºäºè‡ªå›å½’å¡«ç©ºçš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ã€‚ChatGLMç³»åˆ—æ¨¡å‹ï¼Œæ”¯æŒç›¸å¯¹å¤æ‚çš„è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼Œå¹¶ä¸”èƒ½å¤Ÿè§£å†³å›°éš¾çš„æ¨ç†ç±»é—®é¢˜ã€‚è¯¥æ¨¡å‹é…å¤‡äº†æ˜“äºä½¿ç”¨çš„ API æ¥å£ï¼Œå…è®¸å¼€å‘è€…è½»æ¾å°†å…¶èå…¥å„ç±»åº”ç”¨ï¼Œå¹¿æ³›åº”ç”¨äºæ™ºèƒ½å®¢æœã€è™šæ‹Ÿä¸»æ’­ã€èŠå¤©æœºå™¨äººç­‰è¯¸å¤šé¢†åŸŸã€‚\nEmbedding\nEmbedding æ˜¯ä¸€ç§å°†æ•°æ®ï¼ˆå¦‚æ–‡æœ¬ï¼‰è½¬åŒ–ä¸ºå‘é‡å½¢å¼çš„è¡¨ç¤ºæ–¹æ³•ï¼Œè¿™ç§è¡¨ç¤ºæ–¹å¼ç¡®ä¿äº†åœ¨æŸäº›ç‰¹å®šæ–¹é¢ç›¸ä¼¼çš„æ•°æ®åœ¨å‘é‡ç©ºé—´ä¸­å½¼æ­¤æ¥è¿‘ï¼Œè€Œä¸ä¹‹ä¸ç›¸å…³çš„æ•°æ®åˆ™ç›¸è·è¾ƒè¿œã€‚é€šè¿‡å°†æ–‡æœ¬å­—ç¬¦ä¸²è½¬æ¢ä¸ºå‘é‡ï¼Œä½¿å¾—æ•°æ®èƒ½å¤Ÿæœ‰æ•ˆç”¨äºæœç´¢ã€èšç±»ã€æ¨èç³»ç»Ÿã€å¼‚å¸¸æ£€æµ‹å’Œåˆ†ç±»ç­‰åº”ç”¨åœºæ™¯ã€‚\nToken\nToken æ˜¯æ¨¡å‹ç”¨æ¥è¡¨ç¤ºè‡ªç„¶è¯­è¨€æ–‡æœ¬çš„åŸºæœ¬å•ä½ï¼Œå¯ä»¥ç›´è§‚çš„ç†è§£ä¸ºâ€œå­—â€æˆ–â€œè¯â€ï¼›é€šå¸¸ 1 ä¸ªä¸­æ–‡è¯è¯­ã€1 ä¸ªè‹±æ–‡å•è¯ã€1 ä¸ªæ•°å­—æˆ– 1 ä¸ªç¬¦å·è®¡ä¸º 1 ä¸ªtokenã€‚\nä¸€èˆ¬æƒ…å†µä¸‹ ChatGLM ç³»åˆ—æ¨¡å‹ä¸­ token å’Œå­—æ•°çš„æ¢ç®—æ¯”ä¾‹çº¦ä¸º 1:1.8 ï¼Œä½†å› ä¸ºä¸åŒæ¨¡å‹çš„åˆ†è¯ä¸åŒï¼Œæ‰€ä»¥æ¢ç®—æ¯”ä¾‹ä¹Ÿå­˜åœ¨å·®å¼‚ï¼Œæ¯ä¸€æ¬¡å®é™…å¤„ç† token æ•°é‡ä»¥æ¨¡å‹è¿”å›ä¸ºå‡†ï¼Œæ‚¨å¯ä»¥ä»è¿”å›ç»“æœçš„ usage ä¸­æŸ¥çœ‹ã€‚",
    "crumbs": [
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>æ™ºè°±å¼€æ”¾å¹³å°</span>"
    ]
  },
  {
    "objectID": "bigmodel.html#è¯­è¨€æ¨¡å‹-1",
    "href": "bigmodel.html#è¯­è¨€æ¨¡å‹-1",
    "title": "8Â  æ™ºè°±å¼€æ”¾å¹³å°",
    "section": "8.2 è¯­è¨€æ¨¡å‹",
    "text": "8.2 è¯­è¨€æ¨¡å‹\nGLM-4 æä¾›äº†å¤šæ¬¾æ¨¡å‹ï¼Œé€‚ç”¨äºå„ç§åº”ç”¨åœºæ™¯ã€‚\næ¨¡å‹ç¼–ç ï¼šglm-4-plusã€glm-4-0520ã€glm-4 ã€glm-4-airã€glm-4-airxã€glm-4-longã€ glm-4-flashã€‚\n\n8.2.1 ä½¿ç”¨ OpenAI SDK\nä½¿ç”¨ OpenAI SDK åˆ›å»º Clientï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š\n\nfrom openai import OpenAI\nimport os\n\n# format output\nfrom IPython.display import Markdown\nfrom pprint import pprint\n\n\nclient = OpenAI(\n    api_key= os.getenv(\"ZHIPUAI_API_KEY\"),\n    base_url=\"https://open.bigmodel.cn/api/paas/v4/\"\n) \n\nä»¥ä¸‹ä»£ç æ˜¯ GLM-4 çš„å¯¹è¯è°ƒç”¨ç¤ºä¾‹ï¼Œè¯·æ³¨æ„ï¼š\n\ntemperatureï¼šå‚æ•°çš„åŒºé—´ä¸º (0,1)\ndo_sample = False (temperature = 0)ï¼šåœ¨ OpenAI è°ƒç”¨ä¸­å¹¶ä¸é€‚ç”¨\n\n# æäº¤å¯¹è¯è¯·æ±‚\ncompletion = client.chat.completions.create(\n    model=\"GLM-4-Flash\",\n    messages=[\n        {\n            \"role\": \"system\",\n            \"content\": \"ä½ æ˜¯ä¸€ä¸ªèªæ˜ä¸”å¯Œæœ‰åˆ›é€ åŠ›çš„å°è¯´ä½œå®¶\"\n        },\n        {\n            \"role\": \"user\",\n            \"content\": (\n                \"è¯·ä½ ä½œä¸ºç«¥è¯æ•…äº‹å¤§ç‹ï¼Œå†™ä¸€ç¯‡çŸ­ç¯‡ç«¥è¯æ•…äº‹ï¼Œ\"\n                \"æ•…äº‹çš„ä¸»é¢˜æ˜¯è¦æ°¸è¿œä¿æŒä¸€é¢—å–„è‰¯çš„å¿ƒï¼Œè¦èƒ½å¤Ÿ\"\n                \"æ¿€å‘å„¿ç«¥çš„å­¦ä¹ å…´è¶£å’Œæƒ³è±¡åŠ›ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿå¸®åŠ©\"\n                \"å„¿ç«¥æ›´å¥½åœ°ç†è§£å’Œæ¥å—æ•…äº‹ä¸­æ‰€è•´å«çš„é“ç†å’Œä»·å€¼è§‚ã€‚\"\n            )\n        }\n    ],\n    top_p=0.7,\n    temperature=0.9\n)\n\nprint(completion.choices[0].message.content)\næ ‡é¢˜ï¼šã€Šæ˜Ÿæ˜Ÿçš„é­”æ³•ä¹¦ã€‹\nä»å‰ï¼Œåœ¨ä¸€ä¸ªé¥è¿œçš„æ˜Ÿæ˜Ÿç‹å›½é‡Œï¼Œä½ç€ä¸€ç¾¤æ‹¥æœ‰æ˜Ÿæ˜Ÿå…‰èŠ’çš„å­©å­ä»¬ã€‚ä»–ä»¬æ¯å¤©åœ¨å¤œç©ºä¸­é—ªçƒï¼Œä¸ºäººä»¬å¸¦æ¥æ¸©æš–å’Œå¸Œæœ›ã€‚åœ¨è¿™ä¸ªç‹å›½é‡Œï¼Œæœ‰ä¸€é¢—ç‰¹åˆ«æ˜äº®çš„æ˜Ÿæ˜Ÿï¼Œåå«å°æ˜Ÿã€‚å°æ˜Ÿä¸ä»…å…‰èŠ’ç’€ç’¨ï¼Œè¿˜æ‹¥æœ‰ä¸€æœ¬ç¥å¥‡çš„é­”æ³•ä¹¦ã€‚\nè¿™æœ¬é­”æ³•ä¹¦é‡Œè®°è½½ç€æ— æ•°çš„æ™ºæ…§å’Œæ•…äº‹ï¼Œå®ƒèƒ½å¤ŸæŠŠä¹¦ä¸­çš„æ–‡å­—å˜æˆçœŸå®çš„ä¸–ç•Œã€‚å°æ˜Ÿçš„é­”æ³•ä¹¦æ˜¯æ˜Ÿæ˜Ÿç‹å›½çš„å®è—ï¼Œè€Œå°æ˜Ÿæ˜¯è¿™æœ¬ä¹¦çš„å®ˆæŠ¤è€…ã€‚\næœ‰ä¸€å¤©ï¼Œå°æ˜Ÿåœ¨ç¿»é˜…é­”æ³•ä¹¦æ—¶ï¼Œå‘ç°äº†ä¸€ä¸ªæ–°æ•…äº‹ã€‚æ•…äº‹è®²è¿°äº†ä¸€ä¸ªåå«å°å…”çš„æ£®æ—å°åŠ¨ç‰©ï¼Œå®ƒå› ä¸ºå–„è‰¯å’Œå‹‡æ•¢ï¼Œå¾—åˆ°äº†æ˜Ÿæ˜Ÿçš„ç¥ç¦ï¼Œæ‹¥æœ‰äº†ç¥å¥‡çš„åŠ›é‡ã€‚\nå°æ˜Ÿè¢«è¿™ä¸ªæ•…äº‹æ·±æ·±å¸å¼•ï¼Œå®ƒå†³å®šå°†è¿™ä¸ªæ•…äº‹å˜æˆç°å®ï¼Œè®©æ£®æ—é‡Œçš„å­©å­ä»¬éƒ½èƒ½æ„Ÿå—åˆ°å–„è‰¯çš„åŠ›é‡ã€‚äºæ˜¯ï¼Œå°æ˜Ÿå°†é­”æ³•ä¹¦ä¸­çš„æ–‡å­—å¬å”¤åˆ°ç°å®ä¸–ç•Œï¼Œåˆ›é€ äº†ä¸€ä¸ªå……æ»¡å¥‡å¹»è‰²å½©çš„æ£®æ—ã€‚\næ£®æ—é‡Œï¼Œå°å…”å’Œå®ƒçš„æœ‹å‹ä»¬ä½åœ¨ä¸€åº§ç¾ä¸½çš„å°æœ¨å±‹é‡Œã€‚ä»–ä»¬æ¯å¤©åœ¨æ£®æ—é‡Œç©è€ï¼Œå¸®åŠ©å…¶ä»–å°åŠ¨ç‰©è§£å†³é—®é¢˜ã€‚å°å…”æ€»æ˜¯ç”¨å¿ƒå€¾å¬ï¼Œç”¨å–„è‰¯çš„è¡ŒåŠ¨æ¸©æš–ç€æ¯ä¸€ä¸ªæœ‹å‹çš„å¿ƒã€‚\næœ‰ä¸€å¤©ï¼Œæ£®æ—é‡Œçš„å°æ²³è¢«ä¸€å—å·¨å¤§çš„çŸ³å¤´å µä½äº†ï¼Œæ°´æ— æ³•æµæ·Œï¼Œå°åŠ¨ç‰©ä»¬éƒ½éå¸¸è‹¦æ¼ã€‚å°å…”æƒ³èµ·äº†å°æ˜Ÿçš„é­”æ³•ä¹¦ï¼Œå®ƒå†³å®šå»å¯»æ‰¾å¸®åŠ©ã€‚\nå°å…”æ¥åˆ°äº†å°æ˜Ÿçš„æ£®æ—ï¼Œå®ƒè¯·æ±‚å°æ˜Ÿå¸®åŠ©è§£å†³æ²³æµçš„é—®é¢˜ã€‚å°æ˜Ÿå¾®ç¬‘ç€å‘Šè¯‰å°å…”ï¼ŒçœŸæ­£çš„å¸®åŠ©æ¥è‡ªäºå†…å¿ƒçš„å–„è‰¯å’Œå‹‡æ°”ã€‚äºæ˜¯ï¼Œå°æ˜Ÿç»™äº†å°å…”ä¸€æœ¬å°ä¹¦ï¼Œä¹¦ä¸­è®°è½½ç€å¦‚ä½•ç”¨å–„è‰¯çš„åŠ›é‡å»æ”¹å˜ä¸–ç•Œã€‚\nå°å…”å¸¦ç€å°ä¹¦å›åˆ°äº†æ£®æ—ï¼Œå®ƒç”¨è‡ªå·±çš„å–„è‰¯æ„ŸæŸ“äº†æ¯ä¸€ä¸ªåŠ¨ç‰©ã€‚å¤§å®¶é½å¿ƒååŠ›ï¼Œç”¨æ ‘æå’Œå¶å­æ­å»ºäº†ä¸€ä¸ªå°æ¡¥ï¼Œè®©æ²³æ°´é‡æ–°æµæ·Œèµ·æ¥ã€‚\næ£®æ—é‡Œçš„åŠ¨ç‰©ä»¬ä¸ºå°å…”çš„å–„è‰¯æ¬¢å‘¼ï¼Œä»–ä»¬å¼€å§‹æ˜ç™½ï¼Œæ¯ä¸ªäººéƒ½æœ‰èƒ½åŠ›ç”¨å–„è‰¯çš„å¿ƒå»æ”¹å˜ä¸–ç•Œã€‚å°å…”çš„æ•…äº‹åœ¨æ£®æ—é‡Œä¼ å¼€äº†ï¼Œæ¯ä¸ªå­©å­éƒ½å—åˆ°äº†å¯å‘ã€‚\næ˜Ÿæ˜Ÿç‹å›½çš„å­©å­ä»¬ä¹Ÿè¢«è¿™ä¸ªæ•…äº‹æ„ŸåŠ¨ï¼Œä»–ä»¬çº·çº·æ•ˆä»¿å°å…”ï¼Œç”¨è‡ªå·±çš„å–„è‰¯å»å¸®åŠ©ä»–äººã€‚å°æ˜Ÿçš„é­”æ³•ä¹¦æˆä¸ºäº†ä»–ä»¬å­¦ä¹ å’Œæˆé•¿çš„æŒ‡å—ã€‚\nä»æ­¤ï¼Œæ˜Ÿæ˜Ÿç‹å›½çš„å­©å­ä»¬åœ¨å¤œç©ºä¸­é—ªçƒç€æ›´åŠ æ˜äº®çš„å…‰èŠ’ï¼Œä»–ä»¬ç”¨å–„è‰¯çš„å¿ƒç…§äº®äº†æ•´ä¸ªä¸–ç•Œã€‚è€Œå°æ˜Ÿçš„é­”æ³•ä¹¦ï¼Œä¹Ÿæˆä¸ºäº†æ°¸æ’çš„ä¼ è¯´ï¼Œæ¿€åŠ±ç€æ¯ä¸€ä¸ªå­©å­æ°¸è¿œä¿æŒä¸€é¢—å–„è‰¯çš„å¿ƒã€‚\næ•…äº‹ç»“æŸï¼Œä½†å–„è‰¯çš„åŠ›é‡æ°¸è¿œæµä¼ ã€‚æ„¿æ¯ä¸€ä¸ªå­©å­éƒ½èƒ½åœ¨æˆé•¿çš„é“è·¯ä¸Šï¼Œæ‹¥æœ‰è¿™æ ·ä¸€é¢—å…‰èŠ’å››å°„çš„å–„è‰¯ä¹‹å¿ƒã€‚\n\n\n8.2.2 ä½¿ç”¨æ™ºè°±AI SDK\nä½¿ç”¨æ™ºè°±AI SDK å¯ä»¥æ›´æ–¹ä¾¿çš„åˆ›å»º client å’Œä½¿ç”¨æ¨¡å‹æä¾›çš„é™„åŠ åŠŸèƒ½ã€‚\n\nfrom zhipuai import ZhipuAI\n\nclient = ZhipuAI(api_key=os.getenv(\"ZHIPUAI_API_KEY\")) # è¯·å¡«å†™æ‚¨è‡ªå·±çš„APIKey\n\ntools = [{\n    \"type\": \"web_search\",\n    \"web_search\": {\n        \"enable\": True #é»˜è®¤ä¸ºå…³é—­çŠ¶æ€ï¼ˆFalseï¼‰ ç¦ç”¨ï¼šFalseï¼Œå¯ç”¨ï¼šTrueã€‚\n    }\n}]\n\nmessages = [{\n    \"role\": \"user\",\n    \"content\": \"ä¸­å›½ 2024 å¹´ä¸€å­£åº¦çš„GDPæ˜¯å¤šå°‘ \"\n}]\n\nresponse = client.chat.completions.create(\n    model=\"GLM-4-Flash\",\n    messages=messages,\n    tools=tools\n)\n\nprint(response.choices[0].message)\n\nCompletionMessage(content='ä¸­å›½2024å¹´ä¸€å­£åº¦çš„å›½å†…ç”Ÿäº§æ€»å€¼ï¼ˆGDPï¼‰ä¸º296299äº¿å…ƒäººæ°‘å¸ã€‚è¿™ä¸€æ•°æ®æ˜¯æ ¹æ®å›½å®¶ç»Ÿè®¡å±€çš„åˆæ­¥æ ¸ç®—å¾—å‡ºçš„ï¼ŒæŒ‰ä¸å˜ä»·æ ¼è®¡ç®—ï¼ŒåŒæ¯”å¢é•¿5.3%ï¼Œæ¯”ä¸Šå¹´å››å­£åº¦ç¯æ¯”å¢é•¿1.6%ã€‚', role='assistant', tool_calls=None)",
    "crumbs": [
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>æ™ºè°±å¼€æ”¾å¹³å°</span>"
    ]
  },
  {
    "objectID": "bigmodel.html#å¤šæ¨¡æ€æ¨¡å‹-1",
    "href": "bigmodel.html#å¤šæ¨¡æ€æ¨¡å‹-1",
    "title": "8Â  æ™ºè°±å¼€æ”¾å¹³å°",
    "section": "8.3 å¤šæ¨¡æ€æ¨¡å‹",
    "text": "8.3 å¤šæ¨¡æ€æ¨¡å‹\n\n8.3.1 æ–‡ç”Ÿè§†é¢‘\nCogVideoX æ˜¯ç”±æ™ºè°±AIå¼€å‘çš„è§†é¢‘ç”Ÿæˆå¤§æ¨¡å‹ï¼Œå…·å¤‡å¼ºå¤§çš„è§†é¢‘ç”Ÿæˆèƒ½åŠ›ã€åªéœ€è¾“å…¥æ–‡æœ¬æˆ–å›¾ç‰‡å°±å¯ä»¥è½»æ¾å®Œæˆè§†é¢‘åˆ¶ä½œã€‚æœ¬æŒ‡å—å°†æ•™æ‚¨å¦‚ä½•ç³»ç»Ÿåœ°æ„å»ºæç¤ºè¯ï¼Œä»è€Œç”Ÿæˆä¸“ä¸šçº§åˆ«çš„è§†é¢‘ä½œå“ã€‚\næç¤ºè¯çš„ç²¾ç¡®åº¦ä¸ç»†èŠ‚æ°´å¹³ç›´æ¥å½±å“è§†é¢‘å†…å®¹çš„è´¨é‡ã€‚é‡‡ç”¨ç»“æ„åŒ–æç¤ºè¯å¯ä»¥æå¤§æå‡è§†é¢‘å†…å®¹çš„ç¬¦åˆåº¦å’Œä¸“ä¸šæ€§ã€‚ä»¥ä¸‹æ˜¯æ„å»ºæç¤ºè¯çš„å…³é”®ç»„æˆéƒ¨åˆ†ï¼š\næç¤ºè¯ = (é•œå¤´è¯­è¨€ +æ™¯åˆ«è§’åº¦+ å…‰å½±) + ä¸»ä½“ (ä¸»ä½“æè¿°) + ä¸»ä½“è¿åŠ¨ +åœºæ™¯ (åœºæ™¯æè¿°) + (æ°›å›´)\n\né•œå¤´è¯­è¨€:é€šè¿‡é•œå¤´çš„å„ç§åº”ç”¨ä»¥åŠé•œå¤´ä¹‹é—´çš„è¡”æ¥å’Œåˆ‡æ¢æ¥ä¼ è¾¾æ•…äº‹æˆ–ä¿¡æ¯ï¼Œå¹¶åˆ›é€ å‡ºç‰¹å®šçš„è§†è§‰æ•ˆæœå’Œæƒ…æ„Ÿæ°›å›´ã€‚å¦‚é•œå¤´å¹³ç§»ï¼Œæ¨è¿‘ã€æ‹‰è¿œã€å‡é™æ‹æ‘„ã€æ‘‡æ‘„ã€è·Ÿéšæ‹æ‘„ã€æ‰‹æŒæ‹æ‘„ã€æ— äººæœºèˆªæ‹ç­‰;\næ™¯åˆ«è§’åº¦ï¼šæ§åˆ¶ç›¸æœºä¸è¢«æ‘„å¯¹è±¡ä¹‹é—´è·ç¦»å’Œè§’åº¦ï¼Œå®ç°ä¸åŒçš„è§†è§‰æ•ˆæœå’Œæƒ…æ„Ÿè¡¨è¾¾ã€‚å¦‚å¤§å…¨æ™¯ã€ä¸­æ™¯ã€è¿‘æ™¯ ã€é¸Ÿç°è§†è§’ ã€è·Ÿéšè§†è§’ã€é±¼çœ¼æ•ˆæœç­‰;\nå…‰å½±:å…‰å½±æ˜¯èµ‹äºˆæ‘„å½±ä½œå“çµé­‚çš„å…³é”®å…ƒç´ ï¼Œå…‰å½±çš„è¿ç”¨å¯ä»¥ä½¿ç…§ç‰‡æ›´å…·æ·±åº¦ï¼Œæ›´å…·æƒ…æ„Ÿï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…‰å½±åˆ›é€ å‡ºå¯Œæœ‰å±‚æ¬¡æ„Ÿå’Œæƒ…æ„Ÿè¡¨è¾¾åŠ›çš„ä½œå“ã€‚å¦‚è‡ªç„¶å…‰ã€ä¸è¾¾å°”æ•ˆåº”ã€æŸ”å’Œæ•£å°„ã€ç¡¬å…‰ç›´å°„ ã€é€†å…‰å‰ªå½±ã€ä¸‰ç‚¹å¸ƒå…‰ç­‰;\nä¸»ä½“:ä¸»ä½“æ˜¯è§†é¢‘ä¸­çš„ä¸»è¦è¡¨ç°å¯¹è±¡ã€‚å¦‚å„¿ç«¥ã€ç‹®å­ã€å‘æ—¥è‘µï¼Œæ±½è½¦ã€åŸå ¡ç­‰;\nä¸»ä½“æè¿°:å¯¹ä¸»ä½“å¤–è²Œç»†èŠ‚å’Œè‚¢ä½“å§¿æ€ç­‰çš„æè¿°ï¼Œå¦‚äººç‰©çš„æœé¥°ã€åŠ¨ç‰©çš„æ¯›è‰²ã€æ¤ç‰©çš„é¢œè‰²ã€ç‰©ä½“çš„çŠ¶æ€å’Œå»ºç­‘çš„é£æ ¼;\nä¸»ä½“è¿åŠ¨:å¯¹ä¸»ä½“è¿åŠ¨çŠ¶æ€çš„æè¿°ï¼ŒåŒ…æ‹¬é™æ­¢å’Œè¿åŠ¨ç­‰ï¼Œè¿åŠ¨çŠ¶æ€ä¸å®œè¿‡äºå¤æ‚ï¼Œç¬¦åˆ6sè§†é¢‘å†…å¯ä»¥å±•ç°çš„ç”»é¢å³å¯ï¼Œ\nåœºæ™¯: åœºæ™¯æ˜¯ä¸»ä½“æ‰€å¤„çš„ç¯å¢ƒï¼ŒåŒ…æ‹¬å‰æ™¯ã€èƒŒæ™¯ç­‰;\nåœºæ™¯æè¿°:å¯¹ä¸»ä½“æ‰€å¤„ç¯å¢ƒçš„ç»†èŠ‚æè¿°ã€‚å¦‚éƒ½å¸‚ç¯å¢ƒã€ä¹¡æ‘é£å…‰ã€å·¥ä¸šåŒºç­‰;\næ°›å›´:å¯¹é¢„æœŸè§†é¢‘ç”»é¢çš„æ°›å›´æè¿°ã€‚å¦‚å–§åš£ç¹å¿™ã€æ‚¬ç–‘æƒŠæ‚šã€å®é™èˆ’é€‚ç­‰;\n\n\n\n8.3.2 å›¾ç”Ÿè§†é¢‘\nCogVideoX å¯ä»¥å°†ç”¨æˆ·æä¾›çš„é™æ€å›¾åƒè½¬åŒ–ä¸º 6 ç§’çš„åŠ¨æ€è§†é¢‘ã€‚ä¸ºè¾¾åˆ°æœ€ä½³æ•ˆæœï¼Œæ¨èä¸Šä¼ æ¯”ä¾‹ä¸º3:2çš„å›¾ç‰‡ï¼Œå¹¶ä¸”æ–‡ä»¶æ ¼å¼ä¸º PNG æˆ– JPEGï¼Œæ–‡ä»¶å¤§å°ä¸è¶…è¿‡5MBã€‚æç¤ºè¯å»ºè®®ä½¿ç”¨â€œä¸»ä½“ï¼ˆèƒŒæ™¯ï¼‰+ è¿åŠ¨æè¿°â€çš„è¡¨è¾¾æ–¹å¼ã€‚\n\n\n8.3.3 æ–‡ç”Ÿå›¾ç‰‡\nCogView-3-Plusä½¿ç”¨Transformeræ¶æ„è®­ç»ƒæ‰©æ•£æ¨¡å‹ï¼Œä¼˜åŒ–äº†æ•ˆæœå¹¶éªŒè¯äº†å‚æ•°é‡æå‡çš„æ•ˆç›Šã€‚æˆ‘ä»¬è¿˜æ„å»ºäº†é«˜è´¨é‡å›¾åƒå¾®è°ƒæ•°æ®é›†ï¼Œä½¿æ¨¡å‹ç”Ÿæˆæ›´ç¬¦åˆæŒ‡ä»¤ä¸”ç¾å­¦è¯„åˆ†æ›´é«˜çš„å›¾åƒï¼Œæ•ˆæœæ¥è¿‘MJ-V6å’ŒFLUXç­‰ä¸€æµæ¨¡å‹ã€‚\n\n\n8.3.4 å›¾ç‰‡è§†é¢‘ç†è§£\nGLM-4V-Plus é›†å›¾åƒç†è§£ä¸è§†é¢‘ç†è§£èƒ½åŠ›äºä¸€ä½“çš„å¤šæ¨¡æ€æ¨¡å‹ã€‚",
    "crumbs": [
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>æ™ºè°±å¼€æ”¾å¹³å°</span>"
    ]
  },
  {
    "objectID": "bigmodel.html#å¢å¼ºæ£€ç´¢",
    "href": "bigmodel.html#å¢å¼ºæ£€ç´¢",
    "title": "8Â  æ™ºè°±å¼€æ”¾å¹³å°",
    "section": "8.4 å¢å¼ºæ£€ç´¢",
    "text": "8.4 å¢å¼ºæ£€ç´¢\né€šè¿‡åœ¨å¤§è¯­è¨€æ¨¡å‹ç”Ÿæˆç­”æ¡ˆä¹‹å‰ï¼Œå…ˆä»çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³çŸ¥è¯†ï¼Œç„¶åå°†ç›¸å…³çŸ¥è¯†ä½œä¸ºèƒŒæ™¯ä¿¡æ¯è¾“å…¥ç»™å¤§æ¨¡å‹ï¼Œæœ‰æ•ˆåœ°æå‡å†…å®¹çš„å‡†ç¡®æ€§å’Œç›¸å…³æ€§ã€‚\n\n8.4.1 åˆ›å»ºçŸ¥è¯†åº“\nç”¨äºç®¡ç†æ–‡ä»¶ï¼Œæ”¯æŒä¸Šä¼ å¤šä¸ªæ–‡ä»¶ï¼Œå¹¶é€šè¿‡å…³è”çŸ¥è¯†åº“ ID åè¿›è¡Œè°ƒç”¨ã€‚\n\nknowledgeDB = client.knowledge.create(\n    embedding_id=3,\n    name=\"default\",\n    description=\"the default knowledge database\"\n)\nprint(knowledgeDB.id)\n\n\n\n1835987442205917184\n\n\n\n\n8.4.2 è¯·æ±‚çŸ¥è¯†åº“æ–‡ä»¶åˆ—è¡¨\n\n# è¯·æ±‚çŸ¥è¯†åº“æ–‡ä»¶åˆ—è¡¨\nknowledge_files = client.knowledge.document.list(\n    purpose=\"retrieval\",   #æ”¯æŒretrieval\n    knowledge_id=knowledgeDB.id\n)\nprint(knowledge_files)\n\nDocumentPage(list=[DocumentData(id='1835992620149698560', custom_separator=['\\n'], sentence_size=202, length=123750, word_num=1469, name='Kraken2.pdf', url='https://cdn-enterprise-document.bigmodel.cn/knowledge/93037CDE114D4C72A23FC15189EF8FBD.pdf?e=1727637428&token=YsX0TFbWddOwmx008e_eINoC4Oe-PFD_fGIbivRa:WTwlabzg5hvea03zmdUBsqKl5WU=', embedding_stat=1, failInfo=None, knowledge_type=1, parse_image=0), DocumentData(id='1835989396608970752', custom_separator=['\\n'], sentence_size=202, length=123750, word_num=1469, name='Kraken2.pdf', url='https://cdn-enterprise-document.bigmodel.cn/knowledge/CBC4FE6CDC1D41B090CA8670F85CB092.pdf?e=1727637428&token=YsX0TFbWddOwmx008e_eINoC4Oe-PFD_fGIbivRa:6sCGlbkbuPA8uv0u9zws8Rd7618=', embedding_stat=1, failInfo=None, knowledge_type=1, parse_image=0)], object=None, total=2)\n\n\n\n\n8.4.3 ä¸Šä¼ æ–‡ä»¶\næ”¯æŒå°†docã€docxã€pdfã€xlsxç±»å‹æ–‡ä»¶ä¸Šä¼ åˆ°çŸ¥è¯†åº“ï¼Œæ”¯æŒè‡ªå®šä¹‰æ–‡ä»¶åˆ‡ç‰‡çš„å¤§å°å’Œè§„åˆ™ã€‚æ–‡ä»¶å¤§å°ä¸å¾—è¶…è¿‡ 50 MBï¼Œæ€»æ•°ä¸º 100 ä¸ªæ–‡ä»¶ã€‚\n#| output: asis\nresp = client.knowledge.document.create(\n    file=open(\"example/Kraken2.pdf\", \"rb\"),\n    purpose=\"retrieval\",\n    knowledge_id=knowledgeDB.id,\n    sentence_size=202,\n    custom_separator=[\"\\n\"]\n)\n\nprint(resp)\n\n\nDocumentData(id='1835992620149698560', custom_separator=['\\n'], sentence_size=202, length=123750, word_num=1469, name='Kraken2.pdf', url='https://cdn-enterprise-document.bigmodel.cn/knowledge/93037CDE114D4C72A23FC15189EF8FBD.pdf?e=1727637428&token=YsX0TFbWddOwmx008e_eINoC4Oe-PFD_fGIbivRa:WTwlabzg5hvea03zmdUBsqKl5WU=', embedding_stat=1, failInfo=None, knowledge_type=1, parse_image=0)\n\n\n\n\n8.4.4 æ–‡ä»¶å†…å®¹æå–\næ–‡ä»¶å†…å®¹æå–ä»…é€‚ç”¨äºä»¥ purpose=\"file-extract\" ä¸ºç›®çš„ä¸Šä¼ çš„æ–‡ä»¶ã€‚\n# æ–‡ä»¶å†…å®¹æŠ½å–\nfile_content = client.files.content(file_id=knowledge_files.list[0].id)\nprint(file_content)\n\n\n8.4.5 æ£€ç´¢çŸ¥è¯†åº“\n\nknowledge_list = client.knowledge.query(\n    page=1,\n    size=10,\n)\npprint(knowledge_list.model_dump())\n\n{'list': [{'background': 'blue',\n           'bucket_id': None,\n           'customer_identifier': '',\n           'description': 'the default knowledge database',\n           'document_size': 2,\n           'embedding_id': 3,\n           'icon': 'question',\n           'id': '1835987442205917184',\n           'length': 247500,\n           'name': 'default',\n           'word_num': 2938}],\n 'object': None,\n 'total': 1}\n\n\nåˆ›å»ºçŸ¥è¯†åº“åï¼Œæ‚¨å°†è·å¾—ä¸€ä¸ªçŸ¥è¯†åº“IDã€‚è°ƒç”¨æ¨¡å‹æœåŠ¡æ—¶ï¼Œä¼ å…¥çŸ¥è¯†åº“IDï¼Œä½¿å¤§æ¨¡å‹èƒ½è·å–ç›¸å…³å†…å®¹ä»¥å“åº”ç”¨æˆ·æŸ¥è¯¢ã€‚\n\n\n8.4.6 è°ƒç”¨çŸ¥è¯†åº“\nåˆ›å»ºçŸ¥è¯†åº“åï¼Œæ‚¨å°†è·å¾—ä¸€ä¸ªçŸ¥è¯†åº“IDã€‚è°ƒç”¨æ¨¡å‹æœåŠ¡æ—¶ï¼Œä¼ å…¥çŸ¥è¯†åº“IDï¼Œä½¿å¤§æ¨¡å‹èƒ½è·å–ç›¸å…³å†…å®¹ä»¥å“åº”ç”¨æˆ·æŸ¥è¯¢ã€‚\n\nquestion = \"Kraken2çš„å®‰è£…æ–¹æ³•\"\nknowledge = \"é»˜è®¤çŸ¥è¯†åº“\"\nresponse = client.chat.completions.create(\n    model=\"GLM-4-Flash\",  # å¡«å†™éœ€è¦è°ƒç”¨çš„æ¨¡å‹åç§°\n    messages=[\n        {\"role\": \"user\", \"content\": question},\n    ],\n    tools=[\n            {\n                \"type\": \"retrieval\",\n                \"retrieval\": {\n                    \"knowledge_id\": knowledgeDB.id,\n                    \"prompt_template\": \"ä»æ–‡æ¡£â€œ{{knowledge}}â€ ä¸­æ‰¾é—®é¢˜â€œ{{question}}â€çš„ç­”æ¡ˆï¼Œæ‰¾åˆ°ç­”æ¡ˆå°±ä»…ä½¿ç”¨æ–‡æ¡£è¯­å¥å›ç­”é—®é¢˜ï¼Œæ‰¾ä¸åˆ°ç­”æ¡ˆå°±ç”¨è‡ªèº«çŸ¥è¯†å›ç­”å¹¶ä¸”å‘Šè¯‰ç”¨æˆ·è¯¥ä¿¡æ¯ä¸æ˜¯æ¥è‡ªæ–‡æ¡£ã€‚\\nä¸è¦å¤è¿°é—®é¢˜ï¼Œç›´æ¥å¼€å§‹å›ç­”ã€‚\"\n                }\n            }\n            ],\n    stream=False,\n)\n\nMarkdown(response.choices[0].message.content)\n\nKraken2æ˜¯ä¸€æ¬¾å¹¿æ³›ä½¿ç”¨çš„åŸºå› æ¯”å¯¹è½¯ä»¶ï¼Œé€‚ç”¨äºå°†åºåˆ—ä¸å‚è€ƒåŸºå› ç»„è¿›è¡Œæ¯”å¯¹ã€‚ä»¥ä¸‹æ˜¯å®‰è£…Kraken2çš„æ­¥éª¤ï¼Œä»¥Linuxæ“ä½œç³»ç»Ÿä¸ºä¾‹ï¼š\n\n8.4.7 1. å®‰è£…ä¾èµ–\nKraken2éœ€è¦ä¸€äº›ä¾èµ–åº“ï¼Œé¦–å…ˆéœ€è¦å®‰è£…è¿™äº›ä¾èµ–ã€‚\n# å®‰è£…ä¾èµ–\nsudo apt-get update\nsudo apt-get install -y automake autoconf libtool libboost-all-dev zlib1g-dev libssl-dev libncurses5-dev libbz2-dev\n\n\n8.4.8 2. ä¸‹è½½Kraken2\nä»Kraken2çš„GitHubé¡µé¢ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„æºä»£ç ã€‚\n# ä¸‹è½½æºä»£ç \ngit clone https://github.com/DerrickWood/Kraken2.git\ncd Kraken2\n\n\n8.4.9 3. ç¼–è¯‘å®‰è£…\nåœ¨ä¸‹è½½çš„æºä»£ç ç›®å½•ä¸­ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œç¼–è¯‘å’Œå®‰è£…ã€‚\n# é…ç½®ç¼–è¯‘\n./configure --prefix=/usr/local/kraaken2\n\n# ç¼–è¯‘\nmake\n\n# å®‰è£…\nsudo make install\n\n\n8.4.10 4. æ£€æŸ¥å®‰è£…\nç¡®ä¿Kraken2å·²ç»æ­£ç¡®å®‰è£…ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ã€‚\n# æ£€æŸ¥Kraken2ç‰ˆæœ¬\nkraken2 --version\n\n\n8.4.11 5. ä½¿ç”¨Kraken2\nå®‰è£…å®Œæˆåï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Kraken2è¿›è¡ŒåŸºå› æ¯”å¯¹ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š\n# ä½¿ç”¨Kraken2è¿›è¡Œæ¯”å¯¹\nkraken2 -t 4 -o output kraken_db/kraaken_db.kdb reads.fna\nè¿™é‡Œï¼Œ-t 4è¡¨ç¤ºä½¿ç”¨4ä¸ªçº¿ç¨‹ï¼Œ-o outputæŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„ç›®å½•ï¼Œkraken_db/kraaken_db.kdbæ˜¯Kraken2çš„å‚è€ƒæ•°æ®åº“ï¼Œreads.fnaæ˜¯æ‚¨è¦æ¯”å¯¹çš„åºåˆ—æ–‡ä»¶ã€‚\n\n\n8.4.12 æ³¨æ„äº‹é¡¹\n\næ ¹æ®æ‚¨çš„ç³»ç»Ÿç¯å¢ƒï¼Œå¯èƒ½éœ€è¦è°ƒæ•´ä¾èµ–å®‰è£…å‘½ä»¤ã€‚\nå¦‚æœæ‚¨éœ€è¦å°†Kraken2å®‰è£…åˆ°å…¶ä»–è·¯å¾„ï¼Œå¯ä»¥åœ¨configureå‘½ä»¤ä¸­æŒ‡å®š--prefixã€‚\n\nå¸Œæœ›è¿™äº›æ­¥éª¤èƒ½å¤Ÿå¸®åŠ©æ‚¨æˆåŠŸå®‰è£…å’Œä½¿ç”¨Kraken2ï¼\n\n\n\n\n\n8.4.13 åˆ é™¤æ–‡ä»¶\nresult = client.files.delete(\n    file_id=\"æ–‡ä»¶id\"      #æ”¯æŒretrievalã€batchã€fine-tuneã€file-extractæ–‡ä»¶\n)\n\n\n8.4.14 åˆ é™¤çŸ¥è¯†åº“\nä½¿ç”¨ä¸‹é¢çš„è¯­å¥åˆ é™¤çŸ¥è¯†åº“ã€‚\nresult = client.knowledge.delete(\n    knowledge_id=\"xxxxxxxxxxxx\"\n)\n\n\n8.4.15 ç”¨é‡æŸ¥è¯¢\nresult = client.knowledge.used()\npprint(result.model_dump_json(), width = 72)\nâ€˜{â€œusedâ€:{â€œword_numâ€:2938,â€œlengthâ€:247500},â€œtotalâ€:{â€œword_numâ€:5000000,â€œlengthâ€:1073741824}}â€™",
    "crumbs": [
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>æ™ºè°±å¼€æ”¾å¹³å°</span>"
    ]
  },
  {
    "objectID": "bigmodel.html#åŸºäºæ–‡ä»¶çš„é—®ç­”",
    "href": "bigmodel.html#åŸºäºæ–‡ä»¶çš„é—®ç­”",
    "title": "8Â  æ™ºè°±å¼€æ”¾å¹³å°",
    "section": "8.5 åŸºäºæ–‡ä»¶çš„é—®ç­”",
    "text": "8.5 åŸºäºæ–‡ä»¶çš„é—®ç­”\nGLM-4-Long æœ€é•¿æ”¯æŒ200ä¸‡å­—ç¬¦ä¸Šä¸‹æ–‡ï¼Œç»“åˆæ–‡ä»¶é—®ç­”åŠŸèƒ½ã€‚\n\nfrom pathlib import Path\nimport json\n\n# ä¸Šä¼ å¹¶æå–æ–‡æœ¬å†…å®¹\nfile_01 = client.files.create(file=Path(\"example/Kraken2.pdf\"), purpose=\"file-extract\")\ncontent_01 = json.loads(client.files.content(file_01.id).content)[\"content\"]\n\n# ä¸Šä¼ å¹¶æå–æ–‡æœ¬å†…å®¹\nfile_02 = client.files.create(file=Path(\"example/gaoch-cv.md\"), purpose=\"file-extract\")\ncontent_02 = json.loads(client.files.content(file_02.id).content)[\"content\"]\n\n# ç”Ÿæˆè¯·æ±‚æ¶ˆæ¯ï¼Œå°†ä¸åŒæ–‡ä»¶çš„å†…å®¹æ”¾å…¥æ¶ˆæ¯ä¸­\nmessage_content = (\n    \"è¯·å¯¹ä»¥ä¸‹è®ºæ–‡è¿›è¡Œåˆ†æï¼Œå¹¶ä¸”ç”Ÿæˆä¸€ä»½è®ºæ–‡ç»¼è¿°ï¼š\\n\\n\"\n    \"ç¬¬ä¸€ç¯‡è®ºæ–‡å†…å®¹å¦‚ä¸‹ï¼š\\n\"    \n    f\"{content_01}\\n\\n\"\n    \"ç¬¬äºŒç¯‡è®ºæ–‡å†…å®¹å¦‚ä¸‹ï¼š\\n\"\n    f\"{content_02}\"\n)\n\nresponse = client.chat.completions.create(\n    model=\"glm-4-long\",  \n    messages=[\n        {\"role\": \"user\", \"content\": message_content}\n    ],\n)\n\nprint(response.choices[0].message)\n\n\n8.5.1 åˆ é™¤æ–‡ä»¶\nè¯·æ±‚æ–‡ä»¶åˆ—è¡¨ï¼Œç„¶ååˆ©ç”¨ file_id åˆ é™¤æ–‡ä»¶ã€‚\n# è¯·æ±‚æ–‡ä»¶åˆ—è¡¨\nresult = client.files.list(\n    purpose=\"file-extract\",    #æ”¯æŒbatchã€file-extractã€fine-tune\n)\npprint(result)\nresult = client.files.delete(\n    file_id=\"æ–‡ä»¶id\"      #æ”¯æŒretrievalã€batchã€fine-tuneã€file-extractæ–‡ä»¶\n)",
    "crumbs": [
      "<span class='chapter-number'>8</span>Â  <span class='chapter-title'>æ™ºè°±å¼€æ”¾å¹³å°</span>"
    ]
  },
  {
    "objectID": "grounding-dino.html",
    "href": "grounding-dino.html",
    "title": "9Â  DDS Could",
    "section": "",
    "text": "9.1 Grounding DINO\nGrounding DINO èƒ½å¤Ÿæ ¹æ®ç”¨æˆ·æä¾›çš„ç±»åˆ«åï¼ˆæ–‡æœ¬ï¼‰ï¼Œæ™ºèƒ½åœ°è¯†åˆ«å›¾åƒä¸­ä¸ç”¨æˆ·æä¾›çš„ç±»åˆ«åç›¸å…³çš„ç‰©ä½“çš„ä½ç½®å’Œç½®ä¿¡åº¦ï¼Œè®©å„ç§åœºæ™¯çš„æ£€æµ‹å˜å¾—æ›´åŠ ç®€å•ï¼ŒåŒ…æ‹¬äº†å¸¸è§ç‰©ä½“ç›®æ ‡æ£€æµ‹ï¼Œé•¿å°¾ç‰©ä½“ç›®æ ‡æ£€æµ‹ï¼Œå¯†é›†åœºæ™¯æ£€æµ‹ï¼Œé•¿çŸ­æ–‡æœ¬ç‰©ä½“å®šä½ç­‰ã€‚\nimport json\nimport time\nimport os\n\nimport requests\n\n# 1. å°è£… Headerï¼Œå¸¦ä¸Š Token\nheaders = {\n    \"Content-Type\": \"application/json\",\n    \"Token\"       : os.getenv(\"DINO_API_KEY\")\n}",
    "crumbs": [
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>DDS Could</span>"
    ]
  },
  {
    "objectID": "grounding-dino.html#grounding-dino",
    "href": "grounding-dino.html#grounding-dino",
    "title": "9Â  DDS Could",
    "section": "",
    "text": "Note\n\n\n\nGrounding DINO æ˜¯ä¸€ç§å…ˆè¿›çš„è§†è§‰è¯­è¨€æ¨¡å‹ï¼Œä¸“é—¨ç”¨äºå¼€æ”¾é¢†åŸŸç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚è¿™æ„å‘³ç€å®ƒä¸ä»…å¯ä»¥æ£€æµ‹å’Œè¯†åˆ«ç‰¹å®šç±»åˆ«çš„ç›®æ ‡ï¼Œè¿˜èƒ½å¤Ÿæ ¹æ®è‡ªç„¶è¯­è¨€æç¤ºï¼Œæ£€æµ‹å›¾åƒä¸­ä»»æ„å¯¹è±¡ã€‚è¿™ç§æ¨¡å‹ç»“åˆäº†ç›®æ ‡æ£€æµ‹ï¼ˆå¦‚ DINOï¼‰å’Œè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆgroundingï¼‰çš„èƒ½åŠ›ï¼Œå› æ­¤å…·å¤‡äº†å¼ºå¤§çš„çµæ´»æ€§å’Œå¹¿æ³›çš„é€‚åº”æ€§ã€‚\nGrounding DINO çš„æ ¸å¿ƒç‰¹æ€§ï¼š\n\nå¼€æ”¾é¢†åŸŸç›®æ ‡æ£€æµ‹ï¼šæ¨¡å‹èƒ½å¤Ÿè¯†åˆ«å¹¶æ£€æµ‹å›¾åƒä¸­ä»»æ„ç±»åˆ«çš„å¯¹è±¡ï¼Œè€Œæ— éœ€äº‹å…ˆå®šä¹‰ç‰¹å®šçš„æ ‡ç­¾é›†ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è¾“å…¥ä»»æ„çš„æ–‡æœ¬æç¤ºï¼Œæ¨¡å‹ä¼šä¾æ®æç¤ºåœ¨å›¾åƒä¸­æ‰¾åˆ°ç›¸åº”çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œè¾“å…¥ â€œfind a person with a red shirtâ€ è¿™æ ·çš„æŒ‡ä»¤ï¼Œæ¨¡å‹å¯ä»¥åœ¨å›¾åƒä¸­å®šä½å¹¶æ ‡å‡ºçº¢è‰²è¡¬è¡«çš„äººã€‚\nç»“åˆè§†è§‰å’Œæ–‡æœ¬ç‰¹å¾ï¼šGrounding DINO èƒ½å¤Ÿå°†æ–‡æœ¬çš„è¯­ä¹‰ä¿¡æ¯ä¸è§†è§‰ç‰¹å¾ç›¸ç»“åˆï¼Œåœ¨ç†è§£è‡ªç„¶è¯­è¨€çš„åŒæ—¶ï¼Œè¿˜èƒ½å¤Ÿé«˜æ•ˆå¤„ç†å›¾åƒä¸­çš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚å®ƒé‡‡ç”¨äº† Transformer æ¶æ„ï¼ˆå¦‚ DINOï¼‰è¿›è¡Œå›¾åƒçš„ç›®æ ‡æ£€æµ‹ï¼ŒåŒæ—¶ä¸è¯­è¨€æ¨¡å‹ç´§å¯†ç»“åˆï¼Œå®ç°å¯¹å›¾åƒå’Œæ–‡æœ¬çš„è”åˆç†è§£ã€‚\nåº”ç”¨åœºæ™¯å¹¿æ³›ï¼šGrounding DINO å¯ä»¥åº”ç”¨åœ¨è®¸å¤šéœ€è¦å›¾åƒä¸è¯­è¨€äº¤äº’çš„åœºæ™¯ä¸­ï¼Œæ¯”å¦‚å›¾åƒæ ‡æ³¨ã€è‡ªåŠ¨é©¾é©¶ã€æœºå™¨äººå¯¼èˆªã€å¢å¼ºç°å®ï¼ˆARï¼‰ç­‰é¢†åŸŸã€‚å®ƒçš„å¼€æ”¾é¢†åŸŸæ£€æµ‹ç‰¹æ€§ä½¿å¾—å®ƒéå¸¸é€‚åˆåœ¨æ²¡æœ‰æ˜ç¡®ç±»åˆ«æ ‡ç­¾çš„æƒ…å†µä¸‹æ‰§è¡Œå¤æ‚çš„ç›®æ ‡æ£€æµ‹ä»»åŠ¡ã€‚\n\nç›¸å…³å·¥ä½œï¼š\n\nDINOï¼ˆDEtection Transformer with Improved Optimizationï¼‰ï¼šæ˜¯ä¸€ç§åŸºäº Transformer çš„ç›®æ ‡æ£€æµ‹æ¨¡å‹ã€‚Grounding DINO ç»§æ‰¿äº† DINO æ¨¡å‹åœ¨ç›®æ ‡æ£€æµ‹ä¸­çš„å¼ºå¤§æ€§èƒ½ï¼ŒåŒæ—¶æ‰©å±•äº†å…¶ä¸è‡ªç„¶è¯­è¨€æç¤ºäº¤äº’çš„èƒ½åŠ›ã€‚\nè§†è§‰è¯­è¨€æ¨¡å‹ï¼šGrounding DINO å±äºè§†è§‰è¯­è¨€æ¨¡å‹å®¶æ—çš„ä¸€å‘˜ï¼Œè¿™äº›æ¨¡å‹è‡´åŠ›äºå¤„ç†è§†è§‰å’Œæ–‡æœ¬çš„äº¤äº’é—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒCLIP ç­‰æ¨¡å‹èƒ½å¤Ÿä»æ–‡æœ¬æè¿°ä¸­æ‰¾åˆ°ä¸ä¹‹å¯¹åº”çš„å›¾åƒï¼Œè€Œ Grounding DINO æ›´ä¾§é‡åœ¨å›¾åƒä¸­æ‰¾åˆ°æŒ‡å®šçš„å¯¹è±¡ã€‚\n\nGrounding DINO çš„å·¥ä½œæµç¨‹ï¼š\n\nè¾“å…¥ï¼šä¸€å¼ å›¾åƒå’Œä¸€ä¸ªæ–‡æœ¬æç¤ºã€‚\nå¤„ç†ï¼šæ¨¡å‹é€šè¿‡è§†è§‰ç¼–ç å™¨å¯¹å›¾åƒè¿›è¡Œå¤„ç†ï¼Œå¹¶é€šè¿‡è¯­è¨€ç¼–ç å™¨å¯¹æ–‡æœ¬è¿›è¡Œç¼–ç ï¼Œç„¶åç»“åˆè¿™ä¸¤éƒ¨åˆ†ä¿¡æ¯ã€‚\nè¾“å‡ºï¼šæ¨¡å‹æ ¹æ®æ–‡æœ¬æç¤ºè¿”å›å›¾åƒä¸­æ£€æµ‹åˆ°çš„ç›®æ ‡ä½ç½®ï¼ˆé€šå¸¸æ˜¯è¾¹ç•Œæ¡†ï¼‰ã€‚\n\nGrounding DINO åœ¨å¼€æ”¾åœºæ™¯ç›®æ ‡æ£€æµ‹ä¸­å±•ç°å‡ºäº†å¼ºå¤§çš„è¡¨ç°ï¼Œå¹¶åœ¨å¾ˆå¤šç ”ç©¶å’Œåº”ç”¨ä¸­å–å¾—äº†æ˜¾è‘—æˆæœã€‚\n\n\n\n\n9.1.1 å‚æ•°\n\n\n\n\n\n\n\n\n\n\nå‚æ•°\nè¯´æ˜\nç±»å‹\né»˜è®¤å€¼\næ˜¯å¦å¿…å¡«\n\n\n\n\nimage\nç›®æ ‡å›¾ç‰‡ï¼Œ base64 æˆ–è€… http(s) é“¾æ¥å›¾ç‰‡ url\nString\næ— \næ˜¯\n\n\nprompts\næç¤ºç±»åˆ«ï¼Œå¤šä¸ªæç¤ºç±»åˆ«ï¼Œæ•°ç»„è®¾ç½®å¤šé¡¹\nArray\næ— \næ˜¯\n\n\nprompts[].type\nprompt ç±»åˆ«ï¼Œç›®å‰æ”¯æŒæ–‡æœ¬ï¼Œå›ºå®šå€¼ä¸º â€œtextâ€\nString\næ— \næ˜¯\n\n\nprompts[].text\nprompt æç¤ºæ–‡æœ¬\nString\næ— \næ˜¯\n\n\nmodel\ndino æ¨¡å‹ï¼Œå€¼å¯ä¸ºï¼šGroundingDino-1, GroundingDino-1.5-Edge, GroundingDino-1.5-Pro\nEnum\næ— \næ˜¯\n\n\ntargets\næ£€æµ‹ç›®æ ‡ç±»å‹ï¼Œ æœ€å¤šæ”¯æŒåŒæ—¶ â€œbboxâ€å’Œ â€œmaskâ€ï¼Œbbox ä¸ºæ£€æµ‹è¾¹ç•Œæ¡† mask ä¸ºåˆ†å‰²æ©ç ï¼Œå¦‚[â€œbboxâ€]\nArray\næ— \nå¦\n\n\nbbox_threshold\nè¾¹æ¡†ç½®ä¿¡åº¦é˜ˆå€¼, èŒƒå›´æ˜¯ 0-1\nNumber\n0.25\nå¦\n\n\niou_threshold\näº¤å¹¶æ¯”é˜ˆå€¼ï¼ŒIoU é˜ˆå€¼ï¼ŒèŒƒå›´æ˜¯ 0-1\nNumber\n0.8\nå¦\n\n\n\n\n\n9.1.2 æäº¤ä»»åŠ¡\nè®¾ç½® Bodyã€‚\n\nbody = {\n    \"image\": \"https://playground/grounding_DINO-1.5/02.jpg\",\n    \"prompts\": [\n        {\"type\": \"text\", \"text\": \"window covering\"},\n        {\"type\": \"text\", \"text\": \"dinner table\"}\n    ],\n    \"model\": 'GroundingDino-1.5-Pro',\n    \"targets\": [\"bbox\"]\n}\n\nå¦‚æœä½¿ç”¨æœ¬åœ°å›¾ç‰‡ï¼Œéœ€è¦è¿›è¡Œ base64 ç¼–ç è½¬æ¢ã€‚\n\nimport base64\n\ndef image_base64(image_path):\n    # è¯»å–å›¾ç‰‡å¹¶å°†å…¶è½¬æ¢ä¸º base64\n    with open(image_path, \"rb\") as image_file:\n        # è¯»å–å›¾ç‰‡çš„äºŒè¿›åˆ¶æ•°æ®\n        image_data = image_file.read()\n        \n        # å°†å›¾ç‰‡æ•°æ®è½¬æ¢ä¸º base64 ç¼–ç \n        encoded_image = base64.b64encode(image_data)\n        \n        # å°† base64 æ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²å½¢å¼\n        encoded_image_str = encoded_image.decode('utf-8')\n        \n        return encoded_image_str\n\n# æ‰“å°æˆ–ä½¿ç”¨ base64 ç¼–ç å­—ç¬¦ä¸²\nimage_path = \"example/images/leaf-plate.jpg\"\nprint(image_base64(image_path)[:70])\n\n/9j/4Q/+RXhpZgAATU0AKgAAAAgABgESAAMAAAABAAEAAAEaAAUAAAABAAAAVgEbAAUAAA\n\n\nå°†å›¾ç‰‡çš„ base64 ç¼–ç ä¸ mime type ç»„æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä¼ é€’ç»™ body å‚æ•°ã€‚\n\nimport mimetypes\n\ndef image2base64_with_mime(image_path):\n    # è·å–æ–‡ä»¶çš„ MIME ç±»å‹\n    mime_type, _ = mimetypes.guess_type(image_path)\n    \n    # è¯»å–å›¾ç‰‡å¹¶å°†å…¶è½¬æ¢ä¸º base64\n    encoded_image_str = image_base64(image_path)\n\n    # å¦‚æœæœªèƒ½è¯†åˆ«å‡º MIME ç±»å‹ï¼ŒæŠ›å‡ºå¼‚å¸¸\n    if mime_type is None:\n        raise ValueError(\"æ— æ³•è¯†åˆ«æ–‡ä»¶çš„ MIME ç±»å‹\")\n    \n    # æ„å»ºå¸¦æœ‰å‰ç¼€çš„ base64 æ•°æ®\n    data_uri = f\"data:{mime_type};base64,{encoded_image_str}\"\n    \n    return data_uri\n\nimage = image2base64_with_mime(image_path)\nprint(image[:70])\n\ndata:image/jpeg;base64,/9j/4Q/+RXhpZgAATU0AKgAAAAgABgESAAMAAAABAAEAAAE\n\n\næç¤ºæ–‡æœ¬ä¹Ÿæ˜¯å¿…éœ€å‚æ•°ã€‚\n\nprompts = [\n        {\"type\": \"text\", \"text\": \"leaf\"},\n        {\"type\": \"text\", \"text\": \"root\"},\n        {\"type\": \"text\", \"text\": \"plate\"},\n        {\"type\": \"text\", \"text\": \"mark\"},\n        {\"type\": \"text\", \"text\": \"seedling\"},\n        {\"type\": \"text\", \"text\": \"green leaf\"},\n        {\"type\": \"text\", \"text\": \"withered leaf\"},\n    ]\n\n# å®Œæ•´çš„ body ä¿¡æ¯\nbody = {\n    \"image\": image,\n    \"prompts\": prompts,\n    \"model\": 'GroundingDino-1.5-Pro',\n    \"targets\": [\"bbox\"]\n}\n\næäº¤å¹¶è·å–ç»“æœã€‚\nmax_retries = 60  # max retry times\nretry_count = 0\n\n# send request\nresp = requests.post(\n    'https://api.deepdataspace.com/tasks/detection',\n    json=body,\n    headers=headers\n)\n\nif resp.status_code == 200:\n    json_resp = resp.json()\n    print(json_resp)\n    # {'code': 0, 'data': {'task_uuid': '092ccde4-a51a-45'}, 'msg': 'ok'}\n\n    # get task_uuid\n    task_uuid = json_resp[\"data\"][\"task_uuid\"]\n    print(f'task_uuid:{task_uuid}')\n\n    # poll get task result\n    while retry_count &lt; max_retries:\n        url = f'https://api.deepdataspace.com/task_statuses/{task_uuid}'\n        resp = requests.get(url, headers=headers)\n        if resp.status_code != 200:\n            break\n        json_resp = resp.json()\n        if json_resp[\"data\"][\"status\"] not in [\"waiting\", \"running\"]:\n            break\n        time.sleep(1)\n        retry_count += 1\n\n    if json_resp[\"data\"][\"status\"] == \"failed\":\n        print(f'failed resp: {json_resp}')\n    elif json_resp[\"data\"][\"status\"] == \"success\":\n        print(f'success resp: {json_resp}')\n    else:\n        print(f'get task resp: {resp.status_code} - {resp.text}')\nelse:\n    print(f'Error: {resp.status_code} - {resp.text}')\n\n\n{'code': 0,\n 'data': {'task_uuid': '4cc0ca70-9e00-4698-9386-2776cbd9bc0d'},\n 'msg': 'ok'}\n'task_uuid:4cc0ca70-9e00-4698-9386-2776cbd9bc0d'\n{'code': 0,\n 'data': {'error': None,\n          'result': {'mask_url': None,\n                     'objects': [{'bbox': [-0.19334310293197632,\n                                           1.469710350036621,\n                                           1773.765869140625,\n                                           1747.221435546875],\n                                  'category': 'plate',\n                                  'score': 0.6576007008552551},\n                                 {'bbox': [143.88165283203125,\n                                           73.70735931396484,\n                                           432.5969543457031,\n                                           248.65553283691406],\n                                  'category': 'mark',\n                                  'score': 0.3864704370498657},\n                                 {'bbox': [1368.73193359375,\n                                           1434.9140625,\n                                           1633.30908203125,\n                                           1605.239013671875],\n                                  'category': 'mark',\n                                  'score': 0.3484154939651489},\n                                 {'bbox': [1112.5635986328125,\n                                           180.6923370361328,\n                                           1361.9908447265625,\n                                           303.2415466308594],\n                                  'category': 'green leaf',\n                                  'score': 0.3173876404762268},\n                                 {'bbox': [1439.4031982421875,\n                                           387.93609619140625,\n                                           1567.3350830078125,\n                                           563.5098266601562],\n                                  'category': 'green leaf',\n                                  'score': 0.28551268577575684},\n                                 {'bbox': [1212.9088134765625,\n                                           558.487548828125,\n                                           1326.8262939453125,\n                                           646.2600708007812],\n                                  'category': 'green leaf',\n                                  'score': 0.2655079662799835},\n                                 {'bbox': [1361.4508056640625,\n                                           172.87673950195312,\n                                           1473.9033203125,\n                                           267.9229431152344],\n                                  'category': 'green leaf',\n                                  'score': 0.256084144115448}]},\n          'session_id': '50d8c56e8548497aaf2e91a310f128de',\n          'status': 'success',\n          'uuid': '9248e4dd-8050-4edf-8e95-f1c03a690648'},\n 'msg': 'ok'}\n\n\n\n\n9.1.3 å¤„ç†ç»“æœ\nå°†æ£€æµ‹çš„ç»“æœæ ‡åœ¨å›¾ç‰‡ä¸Šé¢ã€‚\n\n# è®¡ç®—è¯†åˆ«åˆ°çš„ç±»å‹æ•°ç›®\ndef category_num(data):\n    # åˆå§‹åŒ–ä¸€ä¸ªå­—å…¸ç”¨äºå­˜å‚¨æ¯ä¸ª category çš„è®¡æ•°\n    category_count = {}\n    \n    # è·å– JSON æ•°æ®ä¸­çš„ objects åˆ—è¡¨\n    objects = data['data']['result']['objects']\n    \n    # éå†æ¯ä¸ª object\n    for obj in objects:\n        category = obj.get('category')\n        \n        # å¦‚æœ category å·²å­˜åœ¨äºå­—å…¸ä¸­ï¼Œåˆ™è®¡æ•°åŠ 1ï¼Œå¦åˆ™åˆå§‹åŒ–ä¸º1\n        if category in category_count:\n            category_count[category] += 1\n        else:\n            category_count[category] = 1\n    \n    return category_count\n\n\nimport matplotlib.pyplot as plt\nfrom PIL import Image\nimport numpy as np\nimport matplotlib.patches as patches\n\n\ndef plot_with_result(image_path, json_resp):\n    # generate random color\n    category_count = category_num(json_resp)\n    colors = {category: np.random.rand(3,) for category in category_count}\n    \n    # Create a figure and axis for plotting\n    fig, ax = plt.subplots(1, 1, figsize=(12, 8))\n    \n    # Display the original image\n    image = Image.open(image_path)\n    ax.imshow(image)\n    \n    # è·å– JSON æ•°æ®ä¸­çš„ objects åˆ—è¡¨\n    detection_results = json_resp['data']['result']['objects']\n    \n    # Overlay bounding boxes and labels with random colors\n    for result in detection_results:\n        score = result.get('score') or 0\n        label = result.get('category')\n        bbox = result['bbox']\n        \n        # Generate a random color\n        color = colors[label]\n        \n        # åˆ›å»ºä¸€ä¸ªçŸ©å½¢æ¡†ï¼Œå‚æ•°ä¸º (å·¦ä¸Šè§’ x, å·¦ä¸Šè§’ y, å®½åº¦, é«˜åº¦)\n        rect = patches.Rectangle(\n            (bbox[0], bbox[1]),  # å·¦ä¸Šè§’åæ ‡\n            bbox[2] - bbox[0],   # å®½åº¦\n            bbox[3] - bbox[1],   # é«˜åº¦\n            linewidth=2,         # è¾¹æ¡†å®½åº¦\n            edgecolor=color,     # è¾¹æ¡†é¢œè‰²\n            facecolor='none'     # å¡«å……é¢œè‰²\n        )\n        ax.add_patch(rect)\n        \n        # Draw label and score with the same color as the rectangle\n        label_text = f\"{label}: {score:.2f}\"\n        ax.text(\n            bbox[0],\n            bbox[1] - 10,\n            label_text,\n            color=color,\n            fontsize=12,\n            bbox=dict(facecolor='white', alpha=0.5, \n                      edgecolor=color, boxstyle='round,pad=0.5')\n        )\n    \n    \n    # Hide axis\n    # plt.axis('off')\n    \n    # Show the plot with bounding boxes and labels\n    plt.show()\n\nplot_with_result(image_path, json_resp)",
    "crumbs": [
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>DDS Could</span>"
    ]
  },
  {
    "objectID": "grounding-dino.html#grounded-sam",
    "href": "grounding-dino.html#grounded-sam",
    "title": "9Â  DDS Could",
    "section": "9.2 Grounded SAM",
    "text": "9.2 Grounded SAM\nGrounded SAM ç®—æ³•é›†æˆäº† Grounding DINO 1.0 å’Œ SAM ç®—æ³• 2 ç§åŠŸèƒ½ï¼Œåˆ©ç”¨æ–‡æœ¬æç¤ºæœ‰æ•ˆåœ°æ£€æµ‹è¾¹ç•Œæ¡†å’Œåˆ†å‰²æ©ç ã€‚\n\n9.2.1 å‚æ•°\n\n\n\n\n\n\n\n\n\n\nå‚æ•°\nè¯´æ˜\nç±»å‹\né»˜è®¤å€¼\næ˜¯å¦å¿…å¡«\n\n\n\n\nimage\nç›®æ ‡å›¾ç‰‡ï¼Œ base64 æˆ–è€… http(s) é“¾æ¥å›¾ç‰‡ url\nString\næ— \næ˜¯\n\n\nprompts\næç¤ºç±»åˆ«ï¼Œå¤šä¸ªæç¤ºç±»åˆ«ï¼Œæ•°ç»„è®¾ç½®å¤šé¡¹\nArray\næ— \næ˜¯\n\n\nprompts[].type\nprompt ç±»åˆ«ï¼Œå›ºå®šå€¼ä¸º â€œtextâ€\nString\næ— \næ˜¯\n\n\nprompts[].text\næç¤ºæ–‡æœ¬\nString\næ— \næ˜¯\n\n\nmodel_type\næ¨¡å‹ï¼Œå€¼å¯ä¸ºï¼šâ€œswinbâ€ ,â€˜swintâ€™\nEnum\næ— \næ˜¯\n\n\nbox_threshold\nè¾¹æ¡†ç½®ä¿¡åº¦é˜ˆå€¼, èŒƒå›´æ˜¯ 0-1\nNumber\n0.3\nå¦\n\n\nnms_threshold\näº¤å¹¶æ¯”é˜ˆå€¼ï¼ŒIoU é˜ˆå€¼ï¼ŒèŒƒå›´æ˜¯ 0-1\nNumber\n0.8\nå¦\n\n\n\n\n\n9.2.2 æäº¤ä»»åŠ¡\n# ä½¿ç”¨åŒæ ·çš„ image å’Œ prompt\nbody = {\n    \"image\": image,\n    \"prompts\": prompts,\n    \"model_type\": \"swinb\"\n}\n\n# è·å–ç»“æœ\n# send request\nresp1 = requests.post(\n    url='https://api.deepdataspace.com/tasks/grounded_sam',\n    json=body,\n    headers=headers\n)\nè¿è¡Œå›¾åƒåˆ†å‰²ä»»åŠ¡ã€‚\n# get task_uuid\nretry_count = 0\nif resp.status_code == 200:\n    json_resp = resp.json()\n    # task_uuid = json_resp[\"data\"][\"task_uuid\"]\n    task_uuid = \"50b6ac9f-aa4f-44b8-897f-6f2f41accdf6\"\n    print(f'task_uuid:{task_uuid}')\n    \n    # poll get task result\n    while retry_count &lt; max_retries:\n        resp = requests.get(f'https://api.deepdataspace.com/task_statuses/{task_uuid}', headers=headers)\n        if resp.status_code != 200:\n            break\n        json_resp = resp.json()\n        if json_resp[\"data\"][\"status\"] not in [\"waiting\", \"running\"]:\n            break\n        time.sleep(1)\n        retry_count += 1\n\n    if json_resp[\"data\"][\"status\"] == \"failed\":\n        print(f'failed resp: {json_resp}')\n    elif json_resp[\"data\"][\"status\"] == \"success\":\n        print(f'success resp: {json_resp}')\n    else:\n        print(f'get task resp: {resp.status_code} - {resp.text}')\nelse:\n    print(f'Error: {resp.status_code} - {resp.text}')\n\n\n{}\n\n\n\n\n9.2.3 å¤„ç†ç»“æœ\n\n# plot_with_result(image_path, json_resp)",
    "crumbs": [
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>DDS Could</span>"
    ]
  },
  {
    "objectID": "grounding-dino.html#interactive-visual-prompting",
    "href": "grounding-dino.html#interactive-visual-prompting",
    "title": "9Â  DDS Could",
    "section": "9.3 Interactive Visual Prompting",
    "text": "9.3 Interactive Visual Prompting\näº¤äº’å¼è§†è§‰æç¤ºï¼ˆIVPï¼‰æ˜¯ä¸€ç§åŸºäº T-Rex æ¨¡å‹çš„äº¤äº’å¼ç›®æ ‡æ£€æµ‹å’Œè®¡æ•°ç³»ç»Ÿã€‚å®ƒé€šè¿‡è§†è§‰æç¤ºå®ç°ç›®æ ‡æ£€æµ‹å’Œè®¡æ•°ï¼Œæ— éœ€ä»»ä½•è®­ç»ƒï¼ŒçœŸæ­£å®ç°äº†é€‚ç”¨äºå¤šç§åœºæ™¯çš„å•ä¸€è§†è§‰æ¨¡å‹ã€‚å®ƒåœ¨å¯†é›†æˆ–é‡å åœºæ™¯ä¸­è®¡æ•°ç‰©ä½“æ–¹é¢å°¤å…¶å‡ºè‰²ã€‚\n\n9.3.1 æäº¤ä»»åŠ¡\nbody = {\n    \"prompt_image\": \"https://playground/ivp/v2/left_17.jpeg\",\n    \"infer_image\": \"https://playground/ivp/v2/right_17.jpeg\",\n    \"prompts\": [\n        {\n            \"type\": \"rect\",\n            \"is_positive\": 1,\n            \"rect\": [\n                421.4149253731343,\n                381.7002098880597,\n                561.88656716417,\n                506.9031949626866\n            ],\n        }\n    ],\n    \"label_types\": [\"bbox\"]\n}\n\nmax_retries = 60  # æœ€å¤§é‡è¯•æ¬¡æ•°\nretry_count = 0\n\n# send request\nresp1 = requests.post(\n    'https://api.deepdataspace.com/tasks/ivp',\n    json=body,\n    headers=headers\n)\n\n\n9.3.2 å¤„ç†ç»“æœ\nif resp1.status_code == 200:\n    json_resp1 = resp1.json()\n    print(json_resp1)\n    # {'code': 0, 'data': {'task_uuid': '092ccde4-a51a-489b-b384-9c4ba8af7375'}, 'msg': 'ok'}\n\n    # get task_uuid\n    task_uuid = json_resp1[\"data\"][\"task_uuid\"]\n    print(f'task_uuid:{task_uuid}')\n\n    # poll get task result\n    while retry_count &lt; max_retries:\n        resp = requests.get(f'https://api.deepdataspace.com/task_statuses/{task_uuid}', headers=headers)\n        if resp.status_code != 200:\n            break\n        json_resp = resp.json()\n        if json_resp[\"data\"][\"status\"] not in [\"waiting\", \"running\"]:\n            break\n        time.sleep(1)\n        retry_count += 1\n\n    if json_resp[\"data\"][\"status\"] == \"failed\":\n        print(f'failed resp: {json_resp}')\n    elif json_resp[\"data\"][\"status\"] == \"success\":\n        print(f'success resp: {json_resp}')\n    else:\n        print(f'get task resp: {resp.status_code} - {resp.text}')\nelse:\n    print(f'Error: {resp1.status_code} - {resp1.text}')\n\n\n{'code': 0, 'msg': 'ok', 'data': {'task_uuid': 'ebff4e6f-35db-4c7f-9f46-72034bd462af'}}\n{'code': 0,\n 'data': {'error': None,\n          'result': {'objects': [{'bbox': [386, 266, 428, 315],\n                                  'score': 0.31}]},\n          'session_id': 'd8399018353c469cb3aa7f0b7c1e68d3',\n          'status': 'success',\n          'uuid': 'ebff4e6f-35db-4c7f-9f46-72034bd462af'},\n 'msg': 'ok'}\n\n\n\nprompt_image = \"example/images/left_17.jpeg\"\ninfer_image = \"example/images/right_17.jpeg\"\n\nprompt_data = {\"data\": {\"result\": {\"objects\": [{\"category\": \"prompt\",\n                                                \"score\": 1,\n                                                \"bbox\": [421.4149253731343,\n                                                          381.7002098880597,\n                                                          561.88656716417,\n                                                          506.9031949626866]},\n                                               ]}}}\n\nplot_with_result(prompt_image, prompt_data)\nplot_with_result(infer_image, resp_json)",
    "crumbs": [
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>DDS Could</span>"
    ]
  },
  {
    "objectID": "grounding-dino.html#ä½¿ç”¨-sdk-è°ƒç”¨",
    "href": "grounding-dino.html#ä½¿ç”¨-sdk-è°ƒç”¨",
    "title": "9Â  DDS Could",
    "section": "9.4 ä½¿ç”¨ SDK è°ƒç”¨",
    "text": "9.4 ä½¿ç”¨ SDK è°ƒç”¨\né…ç½® clientã€‚\n\n# 1. Initialize the client with your API token.\nimport os\nfrom dds_cloudapi_sdk import Config\nfrom dds_cloudapi_sdk import Client\n\ntoken = os.getenv(\"DINO_API_KEY\")\nconfig = Config(token)\nclient = Client(config)\n\nè¿è¡Œä»»åŠ¡çš„ä¸€èˆ¬æµç¨‹å¦‚ä¸‹ã€‚\n\n# 2. Upload local image to the server and get the URL.\ninfer_image_url = \"https://dev.deepdataspace.com/static/04_a.ae28c1d6.jpg\"\n# infer_image_url = client.upload_file(\"path/to/infer/image.jpg\")  \n# you can also upload local file for processing\nprompt_image_url = infer_image_url  # use the same image for prompt\n\n# 3. Create a task with proper parameters.\nfrom dds_cloudapi_sdk.tasks import IVPTask\nfrom dds_cloudapi_sdk.tasks import RectPrompt\nfrom dds_cloudapi_sdk.tasks import LabelTypes\n\ntask = IVPTask(\n    prompt_image_url=prompt_image_url,\n    prompts=[RectPrompt(rect=[475.18, 550.20, 548.10, 599.92], is_positive=True)],\n    infer_image_url=infer_image_url,\n    infer_label_types=[LabelTypes.BBox, LabelTypes.Mask],  # infer both bbox and mask\n)\n\n# 4. Run the task and get the result.\nclient.run_task(task)\n\n# 5. Parse the result.\nfrom dds_cloudapi_sdk.tasks.ivp import TaskResult\n\nresult: TaskResult = task.result\n\nmask_url = result.mask_url  # the image url with all masks drawn on\nobjects = result.objects  # the list of detected objects\nfor idx, obj in enumerate(objects):\n    # get the detection score\n    print(obj.score)  # 0.42\n\n    # get the detection bbox\n    print(obj.bbox)  # [635.0, 458.0, 704.0, 508.0]\n\n    # get the detection mask, it's of RLE format\n    print(obj.mask.counts)  # ]o`f08fa14M3L2O2M2O1O1O1O1N2O1N2O1N2N3M2O3L3M3N2M2N3N1N2O...\n\n    # convert the RLE format to RGBA image\n    mask_image = task.rle2rgba(obj.mask)\n    print(mask_image.size)  # (1600, 1170)\n\n    # save the image to file\n    mask_image.save(f\"data/mask_{idx}.png\")\n\n\n9.4.1 æ£€æµ‹ä»»åŠ¡\n\nfrom dds_cloudapi_sdk import Config\nfrom dds_cloudapi_sdk import Client\nfrom dds_cloudapi_sdk import DetectionTask\nfrom dds_cloudapi_sdk import TextPrompt\nfrom dds_cloudapi_sdk import DetectionModel\nfrom dds_cloudapi_sdk import DetectionTarget\nimport os\n\ntoken = os.getenv(\"DINO_API_KEY\")\nconfig = Config(token)\nclient = Client(config)\n\n\n# Step 3: run the task by DetectionTask class\n# image_url = \"https://algosplt.oss-cn-shenzhen.aliyuncs.com/test_files/tasks/detection/iron_man.jpg\"\n# if you are processing local image file, upload them to DDS server to get the image url\nimage_url = client.upload_file(\"example/images/leaf-plate.jpg\")\n\ntask = DetectionTask(\n    image_url=image_url,\n    prompts=[TextPrompt(text=\"plate\"), \n             TextPrompt(text=\"leaf\"), \n             TextPrompt(text='primary root'),\n             TextPrompt(text=\"mark\"),\n             TextPrompt(text=\"seedlings\")],\n    targets=[DetectionTarget.Mask, DetectionTarget.BBox],  # detect both bbox and mask\n    model=DetectionModel.GDino1_5_Pro,  # detect with GroundingDino-1.5-Pro model\n)\n\nè¿è¡Œä»»åŠ¡ã€‚\n\nclient.run_task(task)\nresult = task.result\n\n\n# ä½¿ç”¨ç¼“å­˜çš„ç»“æœ\nimport os\nimport pickle\nimport requests\n\n# ä¿å­˜ç»“æœ\nfile_path = \"example/results/detection-result.pkl\"\n# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨\nif os.path.isfile(file_path):\n    # æ–‡ä»¶å­˜åœ¨ï¼Œè¯»å–æ–‡ä»¶\n    with open(file_path, 'rb') as file:\n        result = pickle.load(file)\nelse:\n    client.run_task(task)\n    result = task.result\n    # æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„resultå¯¹è±¡å¹¶ä¿å­˜\n    with open(file_path, 'wb') as file:\n        pickle.dump(result, file)\n\n# ä¸‹è½½å›¾ç‰‡å¹¶ä¿å­˜\nresponse = requests.get(result.mask_url)\n\n# æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ\nsave_path = \"example/results/detection-result-mask.png\"\nif not os.path.isfile(save_path) and response.status_code == 200:\n    # å°†å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶\n    with open(save_path, 'wb') as file:\n        file.write(response.content)\n    print(f\"å›¾ç‰‡æˆåŠŸä¿å­˜åˆ° {save_path}\")\n\nè¿™ä¸ªå«æœ‰ mask çš„å›¾åƒï¼Œæ ‡è®°äº†æ£€æµ‹åˆ°çš„ç‰©ä½“çš„èŒƒå›´ã€‚\n\n\nimport matplotlib.pyplot as plt\nfrom PIL import Image, ImageDraw\nimport matplotlib.patches as patches\n\nimage = Image.open(\"example/images/leaf-plate.jpg\")\nobjects = result.objects  # the list of detected objects\n# åˆ›å»ºä¸€ä¸ªå›¾åƒå‰¯æœ¬ç”¨äºç»˜åˆ¶\nfig, ax = plt.subplots(1, 1, figsize=(12, 8))\n\nax.imshow(image)\n\nfor idx, obj in enumerate(objects):\n    # å°†RLEæ ¼å¼è½¬æ¢ä¸ºRGBAå›¾åƒ\n    mask_image = task.rle2rgba(obj.mask)\n    \n    ax.imshow(mask_image, alpha=0.5)\n    \n    # åœ¨å›¾åƒä¸Šç»˜åˆ¶æ©ç \n    bbox = obj.bbox\n    # åˆ›å»ºä¸€ä¸ªçŸ©å½¢æ¡†ï¼Œå‚æ•°ä¸º (å·¦ä¸Šè§’ x, å·¦ä¸Šè§’ y, å®½åº¦, é«˜åº¦)\n    rect = patches.Rectangle(\n        (bbox[0], bbox[1]),  # å·¦ä¸Šè§’åæ ‡\n        bbox[2] - bbox[0],   # å®½åº¦\n        bbox[3] - bbox[1],   # é«˜åº¦\n        linewidth=2,         # è¾¹æ¡†å®½åº¦\n        edgecolor='red',     # è¾¹æ¡†é¢œè‰²\n        facecolor='none'     # å¡«å……é¢œè‰²\n    )\n    ax.add_patch(rect)   \n    \n    # åœ¨å›¾åƒä¸Šæ·»åŠ ç±»åˆ«å’Œåˆ†æ•°\n    text = f\"{obj.category} {obj.score:.2f}\"\n    ax.text(bbox[0], \n              bbox[1] - 10, \n              text, \n              color='red', \n              fontsize=12)\n\n# æ˜¾ç¤ºå›¾åƒ\n# plt.axis('off')  # ä¸æ˜¾ç¤ºåæ ‡è½´\nplt.show()",
    "crumbs": [
      "<span class='chapter-number'>9</span>Â  <span class='chapter-title'>DDS Could</span>"
    ]
  },
  {
    "objectID": "langchain-chatchat.html",
    "href": "langchain-chatchat.html",
    "title": "10Â  æœ¬åœ°çŸ¥è¯†åº“",
    "section": "",
    "text": "10.1 å®‰è£…éƒ¨ç½²",
    "crumbs": [
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>æœ¬åœ°çŸ¥è¯†åº“</span>"
    ]
  },
  {
    "objectID": "langchain-chatchat.html#å®‰è£…éƒ¨ç½²",
    "href": "langchain-chatchat.html#å®‰è£…éƒ¨ç½²",
    "title": "10Â  æœ¬åœ°çŸ¥è¯†åº“",
    "section": "",
    "text": "10.1.1 è½¯ç¡¬ä»¶è¦æ±‚\nğŸ’¡ è½¯ä»¶æ–¹é¢ï¼Œæœ¬é¡¹ç›®å·²æ”¯æŒåœ¨ Python 3.8-3.11 ç¯å¢ƒä¸­è¿›è¡Œä½¿ç”¨ï¼Œå¹¶å·²åœ¨ Windowsã€macOSã€Linux æ“ä½œç³»ç»Ÿä¸­è¿›è¡Œæµ‹è¯•ã€‚\nğŸ’» ç¡¬ä»¶æ–¹é¢ï¼Œå›  0.3.0 ç‰ˆæœ¬å·²ä¿®æ”¹ä¸ºæ”¯æŒä¸åŒæ¨¡å‹éƒ¨ç½²æ¡†æ¶æ¥å…¥ï¼Œå› æ­¤å¯åœ¨ CPUã€GPUã€NPUã€MPS ç­‰ä¸åŒç¡¬ä»¶æ¡ä»¶ä¸‹ä½¿ç”¨ã€‚\n\n\n10.1.2 å®‰è£…æ­¥éª¤\n\n10.1.2.1 å®‰è£… Langchain-Chatchat\nä» 0.3.0 ç‰ˆæœ¬èµ·ï¼ŒLangchain-Chatchat æä¾›ä»¥ Python åº“å½¢å¼çš„å®‰è£…æ–¹å¼ï¼Œå…·ä½“å®‰è£…è¯·æ‰§è¡Œï¼š\npip install langchain-chatchat -U\n\n\n10.1.2.2 æ¨¡å‹æ¨ç†æ¡†æ¶å¹¶åŠ è½½æ¨¡å‹\nå¦‚æœä½¿ç”¨åœ¨çº¿æœåŠ¡çš„è¯ï¼Œè¿™ä¸€æ­¥ä¸éœ€è¦åšã€‚\nä» 0.3.0 ç‰ˆæœ¬èµ·ï¼ŒLangchain-Chatchat ä¸å†æ ¹æ®ç”¨æˆ·è¾“å…¥çš„æœ¬åœ°æ¨¡å‹è·¯å¾„ç›´æ¥è¿›è¡Œæ¨¡å‹åŠ è½½ï¼Œæ¶‰åŠåˆ°çš„æ¨¡å‹ç§ç±»åŒ…æ‹¬ LLMã€Embeddingã€Reranker åŠåç»­ä¼šæä¾›æ”¯æŒçš„å¤šæ¨¡æ€æ¨¡å‹ç­‰ï¼Œå‡æ”¹ä¸ºæ”¯æŒå¸‚é¢å¸¸è§çš„å„å¤§æ¨¡å‹æ¨ç†æ¡†æ¶æ¥å…¥ï¼Œå¦‚ Xinferenceã€Ollamaã€LocalAIã€FastChatã€One API ç­‰ã€‚\nå› æ­¤ï¼Œè¯·ç¡®è®¤åœ¨å¯åŠ¨ Langchain-Chatchat é¡¹ç›®å‰ï¼Œé¦–å…ˆè¿›è¡Œæ¨¡å‹æ¨ç†æ¡†æ¶çš„è¿è¡Œï¼Œå¹¶åŠ è½½æ‰€éœ€ä½¿ç”¨çš„æ¨¡å‹ã€‚\n\n\n10.1.2.3 å®‰è£…çŸ¥è¯†åº“å·¥å…·\n\nå®‰è£…æœç´¢æ¨¡å—\nå®‰è£… duckduckgo æœç´¢æ¨¡å—ã€‚\npip install -U duckduckgo-search\nå®‰è£…æ–‡æ¡£å¤„ç†æ¨¡å—\nnltk æ˜¯ Python ä¸­çš„è‡ªç„¶è¯­è¨€å¤„ç† (NLP) åº“ï¼Œå…¨ç§°ä¸º Natural Language Toolkitã€‚å®ƒæä¾›äº†å¤§é‡çš„å·¥å…·å’Œèµ„æºæ¥å¸®åŠ©å¤„ç†å’Œåˆ†ææ–‡æœ¬æ•°æ®ï¼Œæ¶µç›–äº†åˆ†è¯ã€è¯æ€§æ ‡æ³¨ã€å¥æ³•åˆ†æç­‰ä»»åŠ¡ã€‚\n\npunkt æ˜¯ NLTK çš„ä¸€ä¸ªåˆ†è¯å™¨ï¼Œå®ƒç”¨äºå°†æ–‡æœ¬åˆ†æˆå¥å­å’Œå•è¯ã€‚punkt_tab åº”è¯¥æ˜¯ç”¨æ¥å¤„ç†æˆ–æ‰©å±• punkt çš„ä¸€äº›é¢„å®šä¹‰æ ‡æ³¨æ•°æ®ï¼ˆå¯èƒ½æ˜¯åˆ†å¥è¡¨æˆ–è€…åˆ†è¯æ•°æ®è¡¨ï¼‰ã€‚\n\nåˆ†è¯ï¼ˆTokenizationï¼‰æ˜¯ NLP çš„åŸºæœ¬ä»»åŠ¡ä¹‹ä¸€ï¼Œå®ƒå°†è¿ç»­çš„æ–‡æœ¬å­—ç¬¦ä¸²åˆ‡åˆ†æˆè¾ƒå°çš„éƒ¨åˆ†ï¼Œå¦‚å•è¯æˆ–å¥å­ã€‚\n\naveraged_perceptron_tagger æ˜¯ä¸€ç§ç”¨äºè¯æ€§æ ‡æ³¨çš„ç®—æ³•ï¼Œå®ƒä¼šæ ¹æ®ä¸Šä¸‹æ–‡ä¸ºå¥å­ä¸­çš„æ¯ä¸ªå•è¯åˆ†é…ä¸€ä¸ªè¯æ€§æ ‡ç­¾ï¼ˆå¦‚åè¯ã€åŠ¨è¯ã€å½¢å®¹è¯ç­‰ï¼‰ã€‚æ­¤æ¨¡å‹åŸºäºè‹±è¯­çš„è¯æ€§æ ‡æ³¨ï¼Œå› æ­¤åœ¨æ–‡ä»¶åä¸­æœ‰ engã€‚\n\nè¯æ€§æ ‡æ³¨ï¼ˆPOS taggingï¼‰æ˜¯æ–‡æœ¬åˆ†æçš„é‡è¦ä»»åŠ¡ï¼Œå¯ä»¥å¸®åŠ© NLP ç³»ç»Ÿç†è§£å•è¯çš„è¯­æ³•ä½œç”¨ã€‚\n\n\nimport nltk\n\n# ä¸‹è½½åˆ†è¯å™¨æ‰€éœ€çš„é¢„å®šä¹‰æ ‡æ³¨è¡¨\nnltk.download('punkt_tab')\n\n# ä¸‹è½½è¯æ€§æ ‡æ³¨å™¨çš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œæ”¯æŒå¯¹è‹±æ–‡æ–‡æœ¬è¿›è¡Œè¯æ€§æ ‡æ³¨\nnltk.download('averaged_perceptron_tagger_eng')\n\n\n\n\n10.1.3 åˆå§‹åŒ–\nä» 0.3.1 ç‰ˆæœ¬èµ·ï¼ŒLangchain-Chatchat ä½¿ç”¨æœ¬åœ° yaml æ–‡ä»¶çš„æ–¹å¼è¿›è¡Œé…ç½®ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥æŸ¥çœ‹å¹¶ä¿®æ”¹å…¶ä¸­çš„å†…å®¹ï¼ŒæœåŠ¡å™¨ä¼šè‡ªåŠ¨æ›´æ–°æ— éœ€é‡å¯ã€‚\n\n10.1.3.1 åˆå§‹åŒ–å·¥ä½œç›®å½•\nè®¾ç½® Chatchat å­˜å‚¨é…ç½®æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶çš„æ ¹ç›®å½•ï¼ˆå¯é€‰ï¼‰\n# on linux or macos\nexport CHATCHAT_ROOT=/path/to/chatchat_data\n\n# on windows\nset CHATCHAT_ROOT=/path/to/chatchat_data\n\n\n10.1.3.2 æ‰§è¡Œåˆå§‹åŒ–\nchatchat init\nè¯¥å‘½ä»¤ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š\n\nåˆ›å»ºæ‰€æœ‰éœ€è¦çš„æ•°æ®ç›®å½•\nå¤åˆ¶ samples çŸ¥è¯†åº“å†…å®¹\nç”Ÿæˆé»˜è®¤ yaml é…ç½®æ–‡ä»¶\n\n\n\n\n10.1.4 é…ç½®æ¨¡å‹å’Œå·¥å…·\nä¿®æ”¹é…ç½®æ–‡ä»¶\n\n10.1.4.1 é…ç½®æ¨¡å‹ï¼ˆmodel_settings.yamlï¼‰\nå…·ä½“å‚è€ƒ model_settings.yaml ä¸­çš„æ³¨é‡Šã€‚ä¸»è¦ä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š\n# é»˜è®¤é€‰ç”¨çš„ LLM åç§°\nDEFAULT_LLM_MODEL: \"gpt-4o-mini\"\n\n# é»˜è®¤é€‰ç”¨çš„ Embedding åç§°\nDEFAULT_EMBEDDING_MODEL: \"text-embedding-ada-002\"\n\n# # å¹³å°åç§°\nplatform_name: chatanywhere\n\nMODEL_PLATFORMS:\n  - platform_name: chatanywhere\n    platform_type: openai\n    api_base_url: https://api.chatanywhere.tech/v1\n    api_key: sk-J3LQR******************\n    api_proxy: ''\n    api_concurrencies: 5\n    auto_detect_model: false\n    llm_models:\n      - gpt-4o-mini\n      - gpt-4o-ca\n      - gpt-4-ca\n    embed_models:\n      - text-embedding-3-small\n      - text-embedding-3-large\n      - text-embedding-ada-002\n    text2image_models: []\n    image2text_models: []\n    rerank_models: []\n    speech2text_models: []\n    text2speech_models: []\n\n\n10.1.4.2 é…ç½®çŸ¥è¯†åº“è·¯å¾„ï¼ˆbasic_settings.yamlï¼‰ï¼ˆå¯é€‰ï¼‰\né»˜è®¤çŸ¥è¯†åº“ä½äº CHATCHAT_ROOT/data/knowledge_baseï¼Œå¦‚æœä½ æƒ³æŠŠçŸ¥è¯†åº“æ”¾åœ¨ä¸åŒçš„ä½ç½®ï¼Œæˆ–è€…æƒ³è¿æ¥ç°æœ‰çš„çŸ¥è¯†åº“ï¼Œå¯ä»¥åœ¨è¿™é‡Œä¿®æ”¹å¯¹åº”ç›®å½•å³å¯ã€‚\n# çŸ¥è¯†åº“é»˜è®¤å­˜å‚¨è·¯å¾„\n KB_ROOT_PATH: D:\\chatchat-test\\data\\knowledge_base\n\n # æ•°æ®åº“é»˜è®¤å­˜å‚¨è·¯å¾„ã€‚å¦‚æœä½¿ç”¨sqliteï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹DB_ROOT_PATHï¼›å¦‚æœä½¿ç”¨å…¶å®ƒæ•°æ®åº“ï¼Œè¯·ç›´æ¥ä¿®æ”¹SQLALCHEMY_DATABASE_URIã€‚\n DB_ROOT_PATH: D:\\chatchat-test\\data\\knowledge_base\\info.db\n\n # çŸ¥è¯†åº“ä¿¡æ¯æ•°æ®åº“è¿æ¥URI\n SQLALCHEMY_DATABASE_URI: sqlite:///D:\\chatchat-test\\data\\knowledge_base\\info.db\n\n\n10.1.4.3 é…ç½®çŸ¥è¯†åº“ï¼ˆkb_settings.yamlï¼‰ï¼ˆå¯é€‰ï¼‰\né»˜è®¤ä½¿ç”¨ FAISS çŸ¥è¯†åº“ï¼Œå¦‚æœæƒ³è¿æ¥å…¶å®ƒç±»å‹çš„çŸ¥è¯†åº“ï¼Œå¯ä»¥ä¿®æ”¹ DEFAULT_VS_TYPE å’Œ kbs_configã€‚\n\n\n10.1.4.4 é…ç½®æœç´¢å¼•æ“ï¼ˆtool_settings.ymlï¼‰\n# æœç´¢å¼•æ“å·¥å…·é…ç½®é¡¹ã€‚æ¨èè‡ªå·±éƒ¨ç½² searx æœç´¢å¼•æ“ï¼Œå›½å†…ä½¿ç”¨æœ€æ–¹ä¾¿ã€‚\nsearch_internet:\n  use: true\n  search_engine_name: duckduckgo\n  search_engine_config:\n    bing:\n      bing_search_url: https://api.bing.microsoft.com/v7.0/search\n      bing_key: '6f4f35****'\n\n\n\n10.1.5 å¯åŠ¨æœåŠ¡\n\n10.1.5.1 åˆå§‹åŒ–çŸ¥è¯†åº“\nè¿è¡Œä¸‹é¢å‘½ä»¤åˆå§‹åŒ–ã€‚\nchatchat kb -r\næ›´å¤šåŠŸèƒ½å¯ä»¥æŸ¥çœ‹ chatchat kb --help\n\n\n10.1.5.2 å¯åŠ¨é¡¹ç›®\nchatchat start -a\nå‡ºç°ç½‘é¡µç•Œé¢å³ä¸ºå¯åŠ¨æˆåŠŸã€‚",
    "crumbs": [
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>æœ¬åœ°çŸ¥è¯†åº“</span>"
    ]
  },
  {
    "objectID": "langchain-chatchat.html#æ›´æ–°çŸ¥è¯†åº“",
    "href": "langchain-chatchat.html#æ›´æ–°çŸ¥è¯†åº“",
    "title": "10Â  æœ¬åœ°çŸ¥è¯†åº“",
    "section": "10.2 æ›´æ–°çŸ¥è¯†åº“",
    "text": "10.2 æ›´æ–°çŸ¥è¯†åº“",
    "crumbs": [
      "<span class='chapter-number'>10</span>Â  <span class='chapter-title'>æœ¬åœ°çŸ¥è¯†åº“</span>"
    ]
  },
  {
    "objectID": "openai.html",
    "href": "openai.html",
    "title": "11Â  OpenAI",
    "section": "",
    "text": "11.1 OpenAI ç®€ä»‹\nOpenAIæ˜¯ä¸€å®¶è‡´åŠ›äºäººå·¥æ™ºèƒ½ç ”ç©¶å’Œåº”ç”¨çš„ç§‘æŠ€å…¬å¸ï¼Œæˆç«‹äº2015å¹´ï¼Œæ€»éƒ¨ä½äºç¾å›½æ—§é‡‘å±±ã€‚å…¶ä½¿å‘½æ˜¯ç¡®ä¿äººå·¥æ™ºèƒ½ï¼ˆAIï¼‰é€ ç¦å…¨äººç±»ã€‚",
    "crumbs": [
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>OpenAI</span>"
    ]
  },
  {
    "objectID": "openai.html#openai-ç®€ä»‹",
    "href": "openai.html#openai-ç®€ä»‹",
    "title": "11Â  OpenAI",
    "section": "",
    "text": "11.1.1 ä¸»è¦ç›®æ ‡\nOpenAIçš„ä¸»è¦ç›®æ ‡æ˜¯å¼€å‘å’Œæ¨å¹¿å‹å¥½çš„AIï¼Œæ¨åŠ¨AIæŠ€æœ¯çš„å‘å±•ï¼ŒåŒæ—¶ç¡®ä¿å…¶å®‰å…¨æ€§å’Œå…¬æ­£æ€§ã€‚å…¬å¸è‡´åŠ›äºå°†å…ˆè¿›çš„AIæŠ€æœ¯åº”ç”¨åˆ°å„ä¸ªé¢†åŸŸï¼Œå¦‚è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰ã€æ¸¸æˆã€åŒ»ç–—ç­‰ï¼Œæ¨åŠ¨ç¤¾ä¼šå’Œç§‘æŠ€çš„è¿›æ­¥ã€‚\n\n\n11.1.2 å‘å±•å†ç¨‹\n\n2015å¹´: OpenAIç”±Elon Muskã€Sam Altmanã€Greg Brockmanç­‰äººå…±åŒåˆ›ç«‹ï¼Œæœ€åˆæ˜¯ä¸€ä¸ªéè¥åˆ©æ€§ç»„ç»‡ï¼Œæ—¨åœ¨é€šè¿‡å…¬å¼€ç ”ç©¶æ¥æ¨åŠ¨AIçš„å®‰å…¨å‘å±•ã€‚\n2016å¹´: å‘å¸ƒäº†ç¬¬ä¸€ä¸ªå¼€æºAIå·¥å…·åŒ…ï¼ŒOpenAI Gymï¼Œç”¨äºå¼€å‘å’Œæ¯”è¾ƒå¼ºåŒ–å­¦ä¹ ç®—æ³•ã€‚\n2019å¹´: å‘å¸ƒäº†GPT-2æ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ç§ç”¨äºè‡ªç„¶è¯­è¨€ç”Ÿæˆçš„å¼ºå¤§æ¨¡å‹ã€‚ç”±äºæ‹…å¿ƒæ»¥ç”¨ï¼ŒOpenAIæœ€åˆé€‰æ‹©ä¸å‘å¸ƒå®Œæ•´æ¨¡å‹ã€‚\n2020å¹´: å‘å¸ƒäº†GPT-3ï¼Œè¿™æ˜¯å½“æ—¶æœ€å…ˆè¿›çš„è‡ªç„¶è¯­è¨€å¤„ç†æ¨¡å‹ä¹‹ä¸€ï¼Œå…·æœ‰1750äº¿ä¸ªå‚æ•°ã€‚GPT-3å¼•èµ·äº†å¹¿æ³›å…³æ³¨ï¼Œå¹¶è¢«åº”ç”¨äºå„ç§è¯­è¨€ä»»åŠ¡ï¼Œå¦‚ç¿»è¯‘ã€æ–‡æœ¬ç”Ÿæˆå’Œå¯¹è¯ç³»ç»Ÿã€‚\n2023å¹´: æ¨å‡ºäº†GPT-4ï¼Œä¸€ä¸ªè¿›ä¸€æ­¥æ”¹è¿›å’Œæ‰©å±•çš„è¯­è¨€æ¨¡å‹ï¼Œå¹¶æ¢ç´¢äº†å¤šæ¨¡æ€AIï¼ˆå¦‚æ–‡æœ¬ã€å›¾åƒã€è§†é¢‘çš„è”åˆå¤„ç†ï¼‰ã€‚\n\n\n\n11.1.3 å•†ä¸šåŒ–\nå°½ç®¡æœ€åˆæˆç«‹ä¸ºéè¥åˆ©ç»„ç»‡ï¼ŒOpenAIåœ¨2019å¹´åˆ›å»ºäº†ä¸€ä¸ªâ€œæœ‰é™ç›ˆåˆ©â€ï¼ˆcapped-profitï¼‰å®ä½“ï¼ŒOpenAI LPï¼Œä»¥ç¡®ä¿èƒ½å¤Ÿå¸å¼•å¤§é‡çš„èµ„é‡‘ç”¨äºç ”ç©¶å’Œå¼€å‘ï¼ŒåŒæ—¶å°†åˆ©æ¶¦é™åˆ¶åœ¨ä¸€å®šèŒƒå›´å†…ã€‚OpenAIçš„å•†ä¸šåŒ–äº§å“åŒ…æ‹¬ä¸å¾®è½¯åˆä½œæ¨å‡ºçš„åŸºäºGPT-3çš„APIæœåŠ¡ï¼Œè¿™äº›æœåŠ¡è¢«é›†æˆåˆ°å„ç§åº”ç”¨å’Œå¹³å°ä¸­ã€‚\n\n\n11.1.4 å…³é”®æŠ€æœ¯å’Œäº§å“\n\nGPTï¼ˆGenerative Pre-trained Transformerï¼‰ç³»åˆ—: GPTæ˜¯OpenAIå¼€å‘çš„è‡ªç„¶è¯­è¨€å¤„ç†æ¨¡å‹ç³»åˆ—ï¼Œèƒ½å¤Ÿç”Ÿæˆä¸äººç±»ç›¸ä¼¼çš„æ–‡æœ¬ã€‚GPT-3å’ŒGPT-4æ˜¯å…¶ä¸­æœ€è‘—åçš„ç‰ˆæœ¬ï¼Œè¢«å¹¿æ³›åº”ç”¨äºæ–‡æœ¬ç”Ÿæˆã€å¯¹è¯ç³»ç»Ÿã€ä»£ç ç”Ÿæˆç­‰é¢†åŸŸã€‚\nDALL-E: ä¸€ä¸ªç”¨äºç”Ÿæˆå›¾åƒçš„æ¨¡å‹ï¼ŒåŸºäºæ–‡æœ¬æè¿°ç”Ÿæˆå›¾åƒã€‚DALL-E å±•ç¤ºäº†åœ¨å¤šæ¨¡æ€ç”Ÿæˆä»»åŠ¡ä¸­çš„å¼ºå¤§èƒ½åŠ›ã€‚\nCodex: ä¸€ä¸ªä¸“é—¨é’ˆå¯¹ä»£ç ç”Ÿæˆçš„æ¨¡å‹ï¼Œèƒ½å¤Ÿç†è§£å’Œç”Ÿæˆå¤šç§ç¼–ç¨‹è¯­è¨€çš„ä»£ç ã€‚Codexè¢«é›†æˆåˆ°GitHub Copilotä¸­ï¼Œå¸®åŠ©å¼€å‘è€…ç¼–å†™ä»£ç ã€‚\nWhisper: ä¸€ä¸ªç”¨äºè¯­éŸ³è¯†åˆ«çš„æ¨¡å‹ï¼Œèƒ½å¤Ÿé«˜æ•ˆåœ°å°†è¯­éŸ³è½¬æ¢ä¸ºæ–‡æœ¬ï¼Œæ”¯æŒå¤šç§è¯­è¨€å’Œæ–¹è¨€ã€‚\n\n\n\n11.1.5 ç¤¾ä¼šå½±å“\nOpenAIçš„æŠ€æœ¯å¯¹ç¤¾ä¼šäº§ç”Ÿäº†æ·±è¿œçš„å½±å“ï¼Œå°¤å…¶æ˜¯åœ¨è‡ªåŠ¨åŒ–ã€æ•™è‚²ã€å†…å®¹åˆ›ä½œã€å®¢æœã€å¥åº·ç­‰é¢†åŸŸã€‚ç„¶è€Œï¼Œä¹Ÿæœ‰å…³äºAIæŠ€æœ¯æ»¥ç”¨ã€éšç§é—®é¢˜å’Œå·¥ä½œå²—ä½æ›¿ä»£ç­‰æ–¹é¢çš„æ‹…å¿§ã€‚OpenAIè‡´åŠ›äºé€šè¿‡ç ”ç©¶ã€å®‰å…¨åè®®å’Œæ”¿ç­–å€¡å¯¼æ¥è§£å†³è¿™äº›é—®é¢˜ï¼Œç¡®ä¿AIçš„å…¬å¹³ã€å®‰å…¨å’Œé€æ˜ã€‚\n\n\n11.1.6 æœªæ¥å±•æœ›\nOpenAIç»§ç»­æ¢ç´¢æ›´ä¸ºå¤æ‚å’Œå¼ºå¤§çš„AIæŠ€æœ¯ï¼Œç‰¹åˆ«æ˜¯é€šç”¨äººå·¥æ™ºèƒ½ï¼ˆAGIï¼‰ã€‚ä»–ä»¬çš„ç›®æ ‡æ˜¯å¼€å‘èƒ½å¤Ÿæ‰§è¡Œå¹¿æ³›ä»»åŠ¡å¹¶å…·æœ‰ç±»äººæ™ºèƒ½çš„AIç³»ç»Ÿï¼ŒåŒæ—¶ä¿æŒå¯¹å…¶å®‰å…¨æ€§å’Œä¼¦ç†é—®é¢˜çš„é«˜åº¦å…³æ³¨ã€‚\né€šè¿‡ä¸å­¦æœ¯ç•Œã€è¡Œä¸šå’Œæ”¿åºœçš„åˆä½œï¼ŒOpenAIè‡´åŠ›äºå°†AIè½¬å˜ä¸ºé€ ç¦å…¨äººç±»çš„å¼ºå¤§å·¥å…·ï¼ŒåŒæ—¶å‡å°‘æ½œåœ¨çš„é£é™©ã€‚",
    "crumbs": [
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>OpenAI</span>"
    ]
  },
  {
    "objectID": "openai.html#openai-æ¨¡å‹",
    "href": "openai.html#openai-æ¨¡å‹",
    "title": "11Â  OpenAI",
    "section": "11.2 OpenAI æ¨¡å‹",
    "text": "11.2 OpenAI æ¨¡å‹\næˆªè‡³ 2024å¹´8æœˆï¼ŒOpenAI é€šè¿‡ API æ¥å£æä¾›äº†ä»¥ä¸‹ GPT-4 ç³»åˆ—æ¨¡å‹ï¼šGPT-4ã€GPT-4o å’Œ GPT-4o Miniï¼Œå®ƒä»¬åœ¨æ€§èƒ½ã€è§„æ¨¡å’Œåº”ç”¨åœºæ™¯ä¸Šæœ‰æ‰€ä¸åŒï¼š\n\nGPT-4ï¼š\n\nå‘å¸ƒæ—¶é—´ï¼šæœ€åˆå‘å¸ƒäº2023å¹´ã€‚\nç‰¹ç‚¹ï¼šè¿™æ˜¯OpenAIçš„æ ‡å‡†å¤§æ¨¡å‹ï¼Œå…·æœ‰å¼ºå¤§çš„è‡ªç„¶è¯­è¨€å¤„ç†èƒ½åŠ›ï¼Œæ”¯æŒå¤æ‚ä»»åŠ¡å’Œé•¿ä¸Šä¸‹æ–‡å¤„ç†ã€‚GPT-4åœ¨å„ç§æ–‡æœ¬ç”Ÿæˆã€ç†è§£å’Œæ¨ç†ä»»åŠ¡ä¸­è¡¨ç°ä¼˜å¼‚ï¼Œé€‚ç”¨äºéœ€è¦é«˜ç²¾åº¦å’Œå¤æ‚æ€§çš„åº”ç”¨ã€‚\n\nGPT-4oï¼š\n\nå‘å¸ƒæ—¶é—´ï¼š2024å¹´å‘å¸ƒçš„ä¼˜åŒ–ç‰ˆæœ¬ã€‚\nç‰¹ç‚¹ï¼šGPT-4oæ˜¯GPT-4çš„ä¼˜åŒ–ç‰ˆï¼Œé‡ç‚¹åœ¨äºæå‡æ¨¡å‹çš„æ€§èƒ½å’Œæˆæœ¬æ•ˆç›Šã€‚è¯¥æ¨¡å‹åœ¨å¤„ç†ç”¨æˆ·åé¦ˆã€å®éªŒç»“æœçš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ”¹è¿›ï¼Œæ›´é€‚åˆå¤§è§„æ¨¡åº”ç”¨ï¼ŒåŒæ—¶ä¿æŒäº†GPT-4çš„é«˜è´¨é‡è¾“å‡ºèƒ½åŠ›ã€‚\n\nGPT-4o Miniï¼š\n\nå‘å¸ƒæ—¶é—´ï¼š2024å¹´7æœˆå‘å¸ƒã€‚\nç‰¹ç‚¹ï¼šè¿™æ˜¯GPT-4oçš„ç¼©å°ç‰ˆï¼Œä¸“ä¸ºé‚£äº›éœ€è¦åœ¨æˆæœ¬ä¸æ€§èƒ½ä¹‹é—´æ‰¾åˆ°å¹³è¡¡çš„åœºæ™¯è®¾è®¡ã€‚å°½ç®¡æ¨¡å‹è§„æ¨¡è¾ƒå°ï¼ŒGPT-4o Miniåœ¨å­¦æœ¯åŸºå‡†æµ‹è¯•ä¸­è¶…è¿‡äº†GPT-3.5 Turboï¼Œå°¤å…¶åœ¨å¤šæ¨¡æ€æ¨ç†å’Œé•¿ä¸Šä¸‹æ–‡å¤„ç†æ–¹é¢è¡¨ç°å‡ºè‰²ã€‚å®ƒé€‚ç”¨äºèµ„æºæœ‰é™çš„åœºæ™¯ï¼Œä½†ä¾ç„¶èƒ½æä¾›é«˜è´¨é‡çš„æ–‡æœ¬å¤„ç†èƒ½åŠ›ã€‚\n\n\næ€»ç»“æ¥è¯´ï¼ŒGPT-4 æ˜¯å…¨è§„æ¨¡çš„é«˜æ€§èƒ½æ¨¡å‹ï¼ŒGPT-4o æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šçš„æ€§èƒ½ä¼˜åŒ–ç‰ˆæœ¬ï¼Œè€Œ GPT-4o Mini åˆ™æ˜¯é’ˆå¯¹å°è§„æ¨¡åº”ç”¨åœºæ™¯è®¾è®¡çš„æˆæœ¬æ•ˆç›Šæ›´é«˜çš„ç‰ˆæœ¬ã€‚",
    "crumbs": [
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>OpenAI</span>"
    ]
  },
  {
    "objectID": "openai.html#ä½¿ç”¨-openai",
    "href": "openai.html#ä½¿ç”¨-openai",
    "title": "11Â  OpenAI",
    "section": "11.3 ä½¿ç”¨ OpenAI",
    "text": "11.3 ä½¿ç”¨ OpenAI\n\né€šè¿‡ç½‘é¡µè®¿é—®ã€‚\n\nOpenAI å®˜æ–¹ç½‘ç«™ï¼šhttps://chatgpt.com/\nå›½å†…ç§æœã€ä¸­è½¬ç«™\n\nhttps://pro.gpt-academic.top\n\n\nä½¿ç”¨ API æ¥å£ã€‚\n\nè´­ä¹°å›½å†…å¯ç”¨çš„ API KEYã€‚\n\nChatAnywhereï¼šhttps://github.com/chatanywhere/GPT_API_free\n\nå®‰è£…é…ç½®æœ¬åœ°è½¯ä»¶ã€‚\n\nChatBoxï¼šhttps://github.com/Bin-Huang/chatbox\nZoteroï¼šhttps://zotero.org\nGPT_academicï¼šhttps://github.com/binary-husky/gpt_academic",
    "crumbs": [
      "<span class='chapter-number'>11</span>Â  <span class='chapter-title'>OpenAI</span>"
    ]
  },
  {
    "objectID": "coze.html",
    "href": "coze.html",
    "title": "12Â  Coze",
    "section": "",
    "text": "12.1 ChatGPT\nè¦ç”¨ Python å®ç°è¿™ä¸ª curl å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ requests åº“ã€‚ä»¥ä¸‹æ˜¯ç›¸åº”çš„ Python ä»£ç ï¼š\nimport requests\nimport os\n\nurl = \"https://api.coze.com/v3/chat\"\nbot_id = \"7403315657221079041\"\ncoze_api_key = os.getenv(\"COZE_APE_KEY\")\nif coze_api_key is None:\n    coze_api_key = \"pat_YEj2OkoKUFDzmZnN9uvnlGLQnJ0bK8yqii5Zz3pQ54RI7nLcpb3qxBxvphScpZ81\"\n\nheaders = {\n    \"Authorization\": f\"Bearer {coze_api_key}\",\n    \"Content-Type\": \"application/json\"\n}\n\ndata = {\n    \"bot_id\": bot_id,\n    \"user_id\": \"0\",\n    \"stream\": False,\n    \"auto_save_history\": True,\n    \"additional_messages\": [\n        {\n            \"role\": \"user\",\n            \"content\": \"ä½ æ˜¯è°ï¼Ÿ\",\n            \"content_type\": \"text\"\n        }\n    ]\n}\n\nresponse = requests.post(url, headers=headers, json=data)\n\nprint(response.status_code)\nprint(response.json())  # Assuming the response is JSON; otherwise use response.text\n\n200\n{'data': {'id': '7403350281725181960', 'conversation_id': '7403350281725165576', 'bot_id': '7403315657221079041', 'created_at': 1723726839, 'last_error': {'code': 0, 'msg': ''}, 'status': 'in_progress'}, 'code': 0, 'msg': ''}\nä»£ç è¯´æ˜ï¼š\næ ¹æ®æœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯ï¼Œstatus å­—æ®µçš„å€¼ä¸º \"in_progress\"ï¼Œè¿™æ„å‘³ç€å½“å‰æ“ä½œæ­£åœ¨è¿›è¡Œä¸­ï¼Œå°šæœªå®Œæˆã€‚ä¸‹ä¸€æ­¥çš„æ“ä½œé€šå¸¸å–å†³äºä½ å¸Œæœ›å¦‚ä½•å¤„ç†è¿™ä¸ªçŠ¶æ€ã€‚",
    "crumbs": [
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>Coze</span>"
    ]
  },
  {
    "objectID": "coze.html#chatgpt",
    "href": "coze.html#chatgpt",
    "title": "12Â  Coze",
    "section": "",
    "text": "url: è¿™æ˜¯è¦å‘é€è¯·æ±‚çš„å®Œæ•´ URLï¼ŒåŒ…æ‹¬æŸ¥è¯¢å‚æ•°ã€‚\nheaders: è¯·æ±‚å¤´åŒ…å«äº†æˆæƒä»¤ç‰Œå’Œå†…å®¹ç±»å‹ï¼Œç¡®ä¿è¯·æ±‚è¢«æ­£ç¡®å¤„ç†ã€‚\ndata: è¿™æ˜¯å‘é€çš„ JSON æ•°æ®ï¼Œç›´æ¥åœ¨ Python ä¸­ä½¿ç”¨å­—å…¸æ¥æ„å»ºã€‚\nrequests.post: å‘é€ POST è¯·æ±‚ï¼Œä¼ å…¥ URLã€å¤´ä¿¡æ¯å’Œ JSON æ•°æ®ã€‚\nresponse: å“åº”å¯¹è±¡ï¼Œä½ å¯ä»¥æ£€æŸ¥å…¶çŠ¶æ€ç ï¼ˆstatus_codeï¼‰å¹¶è§£æå“åº”å†…å®¹ã€‚\n\n\n\n12.1.1 å¯èƒ½çš„ä¸‹ä¸€æ­¥ï¼š\n\nè½®è¯¢çŠ¶æ€ï¼š\n\nå¦‚æœæœåŠ¡å™¨éœ€è¦æ—¶é—´æ¥å®ŒæˆæŸä¸ªä»»åŠ¡ï¼Œä½ å¯ä»¥ä½¿ç”¨è½®è¯¢ï¼ˆå®šæœŸå‘é€è¯·æ±‚æ¥æ£€æŸ¥çŠ¶æ€æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼‰ã€‚ä¾‹å¦‚ï¼Œæ¯éš”å‡ ç§’å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œç›´åˆ° status å˜ä¸º \"completed\" æˆ–å…¶ä»–è¡¨ç¤ºä»»åŠ¡å®Œæˆçš„çŠ¶æ€ã€‚\n\nç¤ºä¾‹ä»£ç ï¼š\n\n\nimport time\nimport json\n\nresponse_json = response.json()\n\nchat_id = response_json[\"data\"][\"id\"]\nconversation_id = response_json[\"data\"][\"conversation_id\"]\n\n# æ£€æŸ¥æ˜¯å¦ç”Ÿæˆå®Œæ¯•\nretrieve_url = f\"https://api.coze.com/v3/chat/retrieve?chat_id={chat_id}&conversation_id={conversation_id}\"\n\nwhile True:  \n    response = requests.get(retrieve_url, headers=headers)\n    data = response.json()\n    status = data['data']['status']\n\n    if status == 'completed':\n        break\n    else:\n        print(f\"Task in progress... Status: {status}\")\n        time.sleep(0.5)\n\nTask in progress... Status: in_progress\nTask in progress... Status: in_progress\nTask in progress... Status: in_progress\nTask in progress... Status: in_progress\nTask in progress... Status: in_progress\nTask in progress... Status: in_progress\nTask in progress... Status: in_progress\nTask in progress... Status: in_progress\nTask in progress... Status: in_progress\nTask in progress... Status: in_progress\nTask in progress... Status: in_progress\n\n\nè·å–å›ç­”ã€‚\n\n# è·å–å›ç­”\nmessage_url = f\"https://api.coze.com/v3/chat/message/list?chat_id={chat_id}&conversation_id={conversation_id}\"\n\nresponse = requests.post(message_url, headers=headers)\ndata = response.json()\nans = data['data'][1]['content']\n\nprint(ans)\n\næˆ‘æ˜¯chatchatï¼Œä¸€ä¸ªè™šæ‹Ÿçš„å­¦æœ¯åŠ©æ‰‹ã€‚æˆ‘å¯ä»¥å¸®åŠ©ä½ ç ”ç©¶å„ç§ä¸»é¢˜ï¼Œå¹¶æä¾›ç»“æ„åŒ–çš„æ–‡ç« æˆ–è®ºæ–‡ã€‚å¦‚æœä½ æœ‰ä»»ä½•ç‰¹å®šçš„ç ”ç©¶éœ€æ±‚æˆ–é—®é¢˜ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå°½åŠ›å¸®ä½ è§£å†³ã€‚ä½ ä»Šå¤©æƒ³ç ”ç©¶ä»€ä¹ˆä¸»é¢˜å‘¢ï¼Ÿ",
    "crumbs": [
      "<span class='chapter-number'>12</span>Â  <span class='chapter-title'>Coze</span>"
    ]
  },
  {
    "objectID": "bailian.html",
    "href": "bailian.html",
    "title": "13Â  é˜¿é‡Œäº‘ç™¾ç‚¼",
    "section": "",
    "text": "13.1 ç™¾ç‚¼æ¨¡å‹\nç™¾ç‚¼æä¾›äº†ä¸°å¯Œå¤šæ ·çš„æ¨¡å‹é€‰æ‹©ï¼Œå®ƒé›†æˆäº†é€šä¹‰ç³»åˆ—å¤§æ¨¡å‹å’Œç¬¬ä¸‰æ–¹å¤§æ¨¡å‹ï¼Œæ¶µç›–æ–‡æœ¬ã€å›¾åƒã€éŸ³è§†é¢‘ç­‰ä¸åŒæ¨¡æ€ã€‚\nå‚è§ï¼šhttps://help.aliyun.com/zh/model-studio/getting-started/models?",
    "crumbs": [
      "<span class='chapter-number'>13</span>Â  <span class='chapter-title'>é˜¿é‡Œäº‘ç™¾ç‚¼</span>"
    ]
  },
  {
    "objectID": "bailian.html#ç™¾ç‚¼æ¨¡å‹",
    "href": "bailian.html#ç™¾ç‚¼æ¨¡å‹",
    "title": "13Â  é˜¿é‡Œäº‘ç™¾ç‚¼",
    "section": "",
    "text": "13.1.1 è¯­è¨€æ¨¡å‹\næ‚¨å¯ä»¥ä½¿ç”¨ OpenAI Python SDKã€DashScope SDK æˆ– HTTP æ¥å£è°ƒç”¨é€šä¹‰åƒé—®æ¨¡å‹ã€‚\n\n13.1.1.1 ä½¿ç”¨ DashScope SDK\nä½¿ç”¨ DashScope SDK æ—¶ï¼Œä¼šè‡ªåŠ¨è¯»å–ç¯å¢ƒå˜é‡ä¸­çš„ API_KEY å¹¶åˆ›å»ºå¯¹è±¡ã€‚\n\n# Refer to the document for workspace information: https://help.aliyun.com/document_detail/2746874.html    \n        \nfrom http import HTTPStatus\nimport dashscope\n\nmessages = [{'role': 'user', 'content': 'ä½ æ˜¯è°'}]\nresponse = dashscope.Generation.call(\"qwen-turbo\",\n                            messages=messages,\n                            result_format='message',  # set the result to be \"message\"  format.\n                            stream=False, # set streaming output\n                            )\n\npprint(response.output.choices[0].message.content, width = 72)\n\n'æˆ‘æ˜¯é˜¿é‡Œäº‘å¼€å‘çš„ä¸€æ¬¾è¶…å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ï¼Œæˆ‘å«é€šä¹‰åƒé—®ã€‚ä½œä¸ºä¸€ä¸ªAIåŠ©æ‰‹ï¼Œæˆ‘çš„ç›®æ ‡æ˜¯å¸®åŠ©ç”¨æˆ·è·å¾—å‡†ç¡®ã€æœ‰ç”¨çš„ä¿¡æ¯ï¼Œè§£å†³ä»–ä»¬çš„é—®é¢˜å’Œå›°æƒ‘ã€‚æ— è®ºæ˜¯å…³äºæŠ€æœ¯ã€æ•™è‚²ã€ç”Ÿæ´»å¸¸è¯†è¿˜æ˜¯å…¶ä»–é¢†åŸŸçš„é—®é¢˜ï¼Œæˆ‘éƒ½ä¼šå°½æˆ‘æ‰€èƒ½æä¾›åˆé€‚çš„å¸®åŠ©ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•æƒ³è¦äº†è§£çš„å†…å®¹ï¼Œæ¬¢è¿éšæ—¶å‘æˆ‘æé—®ï¼'\n\n\n\n\n13.1.1.2 ä½¿ç”¨ OpenAI SDK\n\nfrom openai import OpenAI\nimport os\n\n# åˆ›å»º client\nclient = OpenAI(\n    api_key=os.getenv(\"DASHSCOPE_API_KEY\"), # å¦‚æœæ‚¨æ²¡æœ‰é…ç½®ç¯å¢ƒå˜é‡ï¼Œè¯·åœ¨æ­¤å¤„ç”¨æ‚¨çš„API Keyè¿›è¡Œæ›¿æ¢\n    base_url=\"https://dashscope.aliyuncs.com/compatible-mode/v1\",  # å¡«å†™DashScopeæœåŠ¡çš„base_url\n)\n\n# ç”Ÿæˆå¯¹è¯\ncompletion = client.chat.completions.create(\n    model=\"qwen-turbo\",\n    messages=[\n        {'role': 'system', 'content': 'You are a helpful assistant.'},\n        {'role': 'user', 'content': 'ä½ æ˜¯è°ï¼Ÿ'}],\n    temperature=0.8,\n    top_p=0.8\n    )\n\nprint(completion.choices[0].message.content)\n\næˆ‘æ˜¯é˜¿é‡Œäº‘å¼€å‘çš„ä¸€æ¬¾è¶…å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ï¼Œæˆ‘å«é€šä¹‰åƒé—®ã€‚\n\n\n\n\n\n13.1.2 è§†è§‰æ¨ç†\nQwen-VL(qwen-vl-plus/qwen-vl-max) æ¨¡å‹ç°æœ‰å‡ å¤§ç‰¹ç‚¹ï¼š\n\nå¤§å¹…å¢å¼ºäº†å›¾ç‰‡ä¸­æ–‡å­—å¤„ç†èƒ½åŠ›ï¼Œèƒ½å¤Ÿæˆä¸ºç”Ÿäº§åŠ›å°å¸®æ‰‹ï¼Œæå–ã€æ•´ç†ã€æ€»ç»“æ–‡å­—ä¿¡æ¯ä¸åœ¨è¯ä¸‹ã€‚\nå¢åŠ å¯å¤„ç†åˆ†è¾¨ç‡èŒƒå›´ï¼Œå„åˆ†è¾¨ç‡å’Œé•¿å®½æ¯”çš„å›¾éƒ½èƒ½å¤„ç†ï¼Œå¤§å›¾å’Œé•¿å›¾èƒ½çœ‹æ¸…ã€‚\nå¢å¼ºè§†è§‰æ¨ç†å’Œå†³ç­–èƒ½åŠ›ï¼Œé€‚äºæ­å»ºè§†è§‰Agentï¼Œè®©å¤§æ¨¡å‹Agentçš„æƒ³è±¡åŠ›è¿›ä¸€æ­¥æ‰©å±•ã€‚\nå‡çº§çœ‹å›¾åšé¢˜èƒ½åŠ›ï¼Œæ‹ä¸€æ‹ä¹ é¢˜å›¾å‘ç»™Qwen-VLï¼Œå¤§æ¨¡å‹èƒ½å¸®ç”¨æˆ·ä¸€æ­¥æ­¥è§£é¢˜ã€‚\n\n\n\nfrom http import HTTPStatus\nimport dashscope\n\n\ndef simple_multimodal_conversation_call():\n    \"\"\"Simple single round multimodal conversation call.\n    \"\"\"\n    messages = [\n        {\n            \"role\": \"user\",\n            \"content\": [\n                {\"image\": \"https://dashscope.oss-cn-beijing.aliyuncs.com/images/dog_and_girl.jpeg\"},\n                {\"text\": \"è¿™æ˜¯ä»€ä¹ˆ?\"}\n            ]\n        }\n    ]\n    response = dashscope.MultiModalConversation.call(model='qwen-vl-plus',\n                                                     messages=messages)\n    # The response status_code is HTTPStatus.OK indicate success,\n    # otherwise indicate request is failed, you can get error code\n    # and message from code and message.\n    if response.status_code == HTTPStatus.OK:\n        return(response)\n    else:\n        print(response.code)  # The error code.\n        print(response.message)  # The error message.\n\n\nresponse = simple_multimodal_conversation_call()\ncontent = response.output.choices[0]['message']['content'][0]['text']\npprint(content, width = 72)\n\n('è¿™å¼ å›¾ç‰‡æ˜¾ç¤ºäº†ä¸€ä½å¥³å£«å’Œä¸€åªç‹—åœ¨æµ·æ»©ä¸Šã€‚å¥¹ä»¬ä¼¼ä¹æ­£åœ¨äº’åŠ¨ï¼Œå¯èƒ½æ˜¯åœ¨ç©è€æˆ–è®­ç»ƒä¸­æ¡æ‰‹ã€‚èƒŒæ™¯æ˜¯ç¾ä¸½çš„æ—¥è½æ™¯è‰²ï¼Œæµ·æµªè½»è½»æ‹æ‰“ç€æµ·å²¸çº¿ã€‚\\n'\n '\\n'\n 'è¿™ä½å¥³å£«ç©¿ç€æ ¼å­è¡¬è¡«ï¼Œå¹¶ä¸”æˆ´ç€ä¸€ä¸ªæ‰‹é•¯ã€‚å¥¹ååœ¨æ²™æ»©ä¸Šä¸å¥¹çš„å® ç‰©è¿›è¡Œç€æ„‰å¿«çš„äº¤æµã€‚è¿™åªç‹—çœ‹èµ·æ¥å¾ˆå‹å¥½å¹¶ä¸”å¯¹ä¸»äººéå¸¸å¿ è¯šã€‚æ•´ä¸ªåœºæ™¯å……æ»¡äº†å’Œè°ã€å¿«ä¹ä»¥åŠäººä¸åŠ¨ç‰©ä¹‹é—´çš„æ·±åšæƒ…æ„Ÿè”ç³»ã€‚è¿™æ˜¯ä¸€ä¸ªæ¸©é¦¨çš„ç”»é¢ï¼Œè®©äººæ„Ÿå—åˆ°å¤§è‡ªç„¶çš„ç¾å¥½å’Œå¹³é™ã€‚')\n\n\n\n\n13.1.3 æ–‡ç”Ÿå›¾\né€šä¹‰ä¸‡ç›¸-æ–‡æœ¬ç”Ÿæˆå›¾åƒæ˜¯åŸºäºè‡ªç ”çš„Composerç»„åˆç”Ÿæˆæ¡†æ¶çš„AIç»˜ç”»åˆ›ä½œå¤§æ¨¡å‹ï¼Œèƒ½å¤Ÿæ ¹æ®ç”¨æˆ·è¾“å…¥çš„æ–‡å­—å†…å®¹ï¼Œç”Ÿæˆç¬¦åˆè¯­ä¹‰æè¿°çš„å¤šæ ·åŒ–é£æ ¼çš„å›¾åƒã€‚é€šè¿‡çŸ¥è¯†é‡ç»„ä¸å¯å˜ç»´åº¦æ‰©æ•£æ¨¡å‹ï¼ŒåŠ é€Ÿæ”¶æ•›å¹¶æå‡æœ€ç»ˆç”Ÿæˆå›¾ç‰‡çš„æ•ˆæœï¼Œå¸ƒå±€è‡ªç„¶ã€ç»†èŠ‚ä¸°å¯Œã€ç”»é¢ç»†è…»ã€ç»“æœé€¼çœŸã€‚AIæ·±åº¦ç†è§£ä¸­è‹±æ–‡æ–‡æœ¬è¯­ä¹‰ï¼Œè®©æ–‡å­—ç§’å˜ç²¾è‡´AIç”»ä½œã€‚\nå½“å‰æ¨¡å‹æ”¯æŒçš„é£æ ¼åŒ…æ‹¬ä½†ä¸é™äºï¼š\n\næ°´å½©ã€æ²¹ç”»ã€ä¸­å›½ç”»ã€ç´ æã€æ‰å¹³æ’ç”»ã€äºŒæ¬¡å…ƒã€3Då¡é€šã€‚\næ”¯æŒä¸­è‹±æ–‡åŒè¯­è¾“å…¥ã€‚\næ”¯æŒå®¢æˆ·è‡ªå®šä¹‰å’’è¯­ä¹¦/ä¿®é¥°è¯ï¼Œå¯ç”Ÿæˆä¸åŒé£æ ¼ã€ä¸åŒä¸»é¢˜ã€ä¸åŒæ´¾åˆ«çš„å›¾ç‰‡ï¼Œæ»¡è¶³ä¸ªæ€§åˆ›æ„çš„AIå›¾ç‰‡ç”Ÿæˆéœ€æ±‚ã€‚\næ”¯æŒè¾“å…¥å‚è€ƒå›¾ç‰‡è¿›è¡Œå‚è€ƒå†…å®¹æˆ–è€…å‚è€ƒé£æ ¼è¿ç§»ï¼Œæ”¯æŒæ›´ä¸°å¯Œçš„é£æ ¼ã€ä¸»é¢˜å’Œæ´¾åˆ«ï¼ŒAIä½œç”»è´¨é‡æ›´åŠ é«˜ä¿çœŸã€‚\n\n\nfrom http import HTTPStatus\nfrom urllib.parse import urlparse, unquote\nfrom pathlib import PurePosixPath\nimport requests\nfrom dashscope import ImageSynthesis\n\ndef simple_call(prompt = 'Mouse rides elephant', out_dir = \"output\"):\n    rsp = ImageSynthesis.call(model=ImageSynthesis.Models.wanx_v1,\n                              prompt=prompt,\n                              n=1,\n                              size='1024*1024')\n    if rsp.status_code == HTTPStatus.OK:\n        print(rsp.output)\n        print(rsp.usage)\n        # save file to current directory\n        files = []\n        for result in rsp.output.results:\n            file_name = PurePosixPath(unquote(urlparse(result.url).path)).parts[-1]\n            file = './%s/%s' % (out_dir, file_name)\n            with open(file, 'wb+') as f:\n                f.write(requests.get(result.url).content)\n            files.append(file)\n        return(files)\n    else:\n        print('Failed, status_code: %s, code: %s, message: %s' %\n              (rsp.status_code, rsp.code, rsp.message))\n\n\nimage_path = simple_call()\n\n\nfrom PIL import Image\nimport matplotlib.pyplot as plt\n\n# è¯»å–æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶\nimage_path = \"output/435e0b57-6884-4e32-9187-2ada667b0ecb-1.png\"\nimage = Image.open(image_path)\n\nplt.imshow(image)\n\n\n\n\n\n\n\n\n\n\n13.1.4 è¯­éŸ³è¯†åˆ«\nSenseVoice è¯­éŸ³è¯†åˆ«å¤§æ¨¡å‹ä¸“æ³¨äºé«˜ç²¾åº¦å¤šè¯­è¨€è¯­éŸ³è¯†åˆ«ã€æƒ…æ„Ÿè¾¨è¯†å’ŒéŸ³é¢‘äº‹ä»¶æ£€æµ‹ï¼Œæ”¯æŒè¶…è¿‡ 50 ç§è¯­è¨€çš„è¯†åˆ«ï¼Œæ•´ä½“æ•ˆæœä¼˜äº Whisper æ¨¡å‹ï¼Œä¸­æ–‡ä¸ç²¤è¯­è¯†åˆ«å‡†ç¡®ç‡ç›¸å¯¹æå‡åœ¨ 50% ä»¥ä¸Šã€‚\n\n# For prerequisites running the following sample, visit https://help.aliyun.com/document_detail/611472.html\n\nimport json\nfrom urllib import request\nfrom http import HTTPStatus\n\nimport dashscope\n\n\ntask_response = dashscope.audio.asr.Transcription.async_call(\n    model='sensevoice-v1',\n    file_urls=[\n        'https://dashscope.oss-cn-beijing.aliyuncs.com/samples/audio/sensevoice/rich_text_example_1.wav'],\n    language_hints=['en'],)\n\ntranscription_response = dashscope.audio.asr.Transcription.wait(\n    task=task_response.output.task_id)\n\nif transcription_response.status_code == HTTPStatus.OK:\n    for transcription in transcription_response.output['results']:\n        url = transcription['transcription_url']\n        result = json.loads(request.urlopen(url).read().decode('utf8'))\n        pprint(json.dumps(result, indent=4, ensure_ascii=False))\n    print('transcription done!')\nelse:\n    print('Error: ', transcription_response.output.message)\n\n('{\\n'\n '    \"file_url\": '\n '\"https://dashscope.oss-cn-beijing.aliyuncs.com/samples/audio/sensevoice/rich_text_example_1.wav\",\\n'\n '    \"properties\": {\\n'\n '        \"audio_format\": \"pcm_s16le\",\\n'\n '        \"channels\": [\\n'\n '            0\\n'\n '        ],\\n'\n '        \"original_sampling_rate\": 16000,\\n'\n '        \"original_duration_in_milliseconds\": 17645\\n'\n '    },\\n'\n '    \"transcripts\": [\\n'\n '        {\\n'\n '            \"channel_id\": 0,\\n'\n '            \"content_duration_in_milliseconds\": 13240,\\n'\n '            \"text\": \"&lt;|Speech|&gt; Senior staff, Principal Doris Jackson, '\n 'Wakefield faculty, and of course, my fellow classmates. &lt;|/Speech|&gt; '\n '&lt;|ANGRY|&gt;&lt;|Applause|&gt; &lt;|Speech|&gt; I am honored &lt;|/Applause|&gt; to have been '\n 'chosen to speak before my classmates, as well as the students across America '\n 'today. &lt;|/Speech|&gt;\",\\n'\n '            \"sentences\": [\\n'\n '                {\\n'\n '                    \"begin_time\": 0,\\n'\n '                    \"end_time\": 7480,\\n'\n '                    \"text\": \"&lt;|Speech|&gt; Senior staff, Principal Doris '\n 'Jackson, Wakefield faculty, and of course, my fellow classmates. &lt;|/Speech|&gt; '\n '&lt;|ANGRY|&gt;\"\\n'\n '                },\\n'\n '                {\\n'\n '                    \"begin_time\": 11880,\\n'\n '                    \"end_time\": 17640,\\n'\n '                    \"text\": \"&lt;|Applause|&gt; &lt;|Speech|&gt; I am honored '\n '&lt;|/Applause|&gt; to have been chosen to speak before my classmates, as well as '\n 'the students across America today. &lt;|/Speech|&gt;\"\\n'\n '                }\\n'\n '            ]\\n'\n '        }\\n'\n '    ]\\n'\n '}')\ntranscription done!\n\n\n\n\n13.1.5 è¯­éŸ³åˆæˆ\nSambert è¯­éŸ³åˆæˆ API åŸºäºè¾¾æ‘©é™¢æ”¹è‰¯çš„è‡ªå›å½’éŸµå¾‹æ¨¡å‹ï¼Œæ”¯æŒæ–‡æœ¬è‡³è¯­éŸ³çš„å®æ—¶æµå¼åˆæˆã€‚\n\nimport sys\n\nimport dashscope\nfrom dashscope.audio.tts import SpeechSynthesizer\n\nresult = SpeechSynthesizer.call(model='sambert-zhichu-v1',\n                                text='ä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·',\n                                sample_rate=48000)\n\ntts_output = \"output/weather.wav\"\nif result.get_audio_data() is not None:\n    with open(tts_output, 'wb') as f:\n        f.write(result.get_audio_data())\n    print('SUCCESS: get audio data: %dbytes in output.wav' %\n          (sys.getsizeof(result.get_audio_data())))\nelse:\n    print('ERROR: response is %s' % (result.get_response()))\n\nSUCCESS: get audio data: 135677bytes in output.wav\n\n\nä½¿ç”¨ IPython.display æ¨¡å—çš„ Audio ç±»æ¥æ˜¾ç¤ºéŸ³é¢‘æ–‡ä»¶ã€‚\n\nfrom IPython.display import Audio\nfrom IPython.core.display import HTML\n\ndef html_tag_audio(file, file_type='wav'):\n    file_type = file_type.lower()\n    if file_type not in ['wav', 'mp3', 'ogg']:\n        raise ValueError(\"Invalid audio type. Supported types: 'wav', 'mp3', 'ogg'.\")\n    \n    audio_tag = f'''\n    &lt;audio controls&gt;\n      &lt;source src=\"{file}\" type=\"audio/{file_type}\"&gt;\n      Your browser does not support the audio element.\n    &lt;/audio&gt;\n    '''\n    return HTML(audio_tag)\n\n# Example usage\ntts_output = \"output/weather.wav\"\nhtml_tag_audio(tts_output, file_type=\"wav\")\n\n\n    \n      \n      Your browser does not support the audio element.",
    "crumbs": [
      "<span class='chapter-number'>13</span>Â  <span class='chapter-title'>é˜¿é‡Œäº‘ç™¾ç‚¼</span>"
    ]
  },
  {
    "objectID": "bailian.html#æ–‡æ¡£è§£æ",
    "href": "bailian.html#æ–‡æ¡£è§£æ",
    "title": "13Â  é˜¿é‡Œäº‘ç™¾ç‚¼",
    "section": "13.2 æ–‡æ¡£è§£æ",
    "text": "13.2 æ–‡æ¡£è§£æ\nQwen-Long æ˜¯åœ¨é€šä¹‰åƒé—®é’ˆå¯¹è¶…é•¿ä¸Šä¸‹æ–‡å¤„ç†åœºæ™¯çš„å¤§è¯­è¨€æ¨¡å‹ï¼Œæ”¯æŒä¸­æ–‡ã€è‹±æ–‡ç­‰ä¸åŒè¯­è¨€è¾“å…¥ï¼Œæ”¯æŒæœ€é•¿ 1000 ä¸‡ tokens(çº¦ 1500 ä¸‡å­—æˆ– 1.5 ä¸‡é¡µæ–‡æ¡£)çš„è¶…é•¿ä¸Šä¸‹æ–‡å¯¹è¯ã€‚é…åˆåŒæ­¥ä¸Šçº¿çš„æ–‡æ¡£æœåŠ¡ï¼Œå¯æ”¯æŒ wordã€pdfã€markdownã€epubã€mobi ç­‰å¤šç§æ–‡æ¡£æ ¼å¼çš„è§£æå’Œå¯¹è¯ã€‚\n\n13.2.1 ä¸Šä¼ æ–‡æ¡£\n\nfrom pathlib import Path\nfrom openai import OpenAI\n\nclient = OpenAI(\n    api_key=os.getenv(\"DASHSCOPE_API_KEY\"), # å¦‚æœæ‚¨æ²¡æœ‰é…ç½®ç¯å¢ƒå˜é‡ï¼Œè¯·åœ¨æ­¤å¤„ç”¨æ‚¨çš„API Keyè¿›è¡Œæ›¿æ¢\n    base_url=\"https://dashscope.aliyuncs.com/compatible-mode/v1\",  # å¡«å†™DashScopeæœåŠ¡çš„base_url\n)\n\nfile_object = client.files.create(file=Path(\"example/Kraken2.pdf\"), \n                                  purpose=\"file-extract\")\n\nprint(f\"æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œæ–‡ä»¶ID: {file_object.id}\")\n\næ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œæ–‡ä»¶ID: file-fe-FegrQSGslKgnjoM3hz9BylgC\n\n\n\n\n13.2.2 æŸ¥è¯¢æ–‡ä»¶\næŸ¥è¯¢ã€åˆ é™¤æ–‡ä»¶ã€‚\n\n# æŸ¥è¯¢æ–‡ä»¶å…ƒä¿¡æ¯\nclient.files.retrieve(file_object.id)\n\n# æŸ¥è¯¢æ–‡ä»¶åˆ—è¡¨\nclient.files.list()\n\nSyncPage[FileObject](data=[FileObject(id='file-fe-FegrQSGslKgnjoM3hz9BylgC', bytes=123750, created_at=1726562370, filename='Kraken2.pdf', object='file', purpose='file-extract', status='processed', status_details=None), FileObject(id='file-fe-d0surOfpU9ck8YP9grzxyeSU', bytes=1460, created_at=1726559802, filename='syncom-group-library.md', object='file', purpose='file-extract', status='processed', status_details=None), FileObject(id='file-fe-U8DwGdPB6Txo7cIo90MPAjlU', bytes=1006, created_at=1726559791, filename='gaoch-cv.md', object='file', purpose='file-extract', status='processed', status_details=None), FileObject(id='file-fe-iAiDxfZ6l09nmaNKNOjnYdCX', bytes=123750, created_at=1726557247, filename='Kraken2.pdf', object='file', purpose='file-extract', status='processed', status_details=None), FileObject(id='file-fe-5q4ob5AoPyEQA9vnQAIBaXIU', bytes=123750, created_at=1726556558, filename='Kraken2.pdf', object='file', purpose='file-extract', status='processed', status_details=None), FileObject(id='file-fe-LZaGRINYblYiXxAhJaHhBMZz', bytes=6416, created_at=1726556278, filename='å®‰è£…Kraken2.md', object='file', purpose='file-extract', status='processed', status_details=None)], object='list', has_more=False)\n\n\n\n# åˆ é™¤æ–‡ä»¶\nclient.files.delete(file_object.id)\n\n\n\n13.2.3 åŸºäºæ–‡æ¡£çš„å¯¹è¯\nQwen-Long æ”¯æŒé•¿æ–‡æœ¬ï¼ˆæ–‡æ¡£ï¼‰å¯¹è¯ï¼Œæ–‡æ¡£å†…å®¹éœ€æ”¾åœ¨ role ä¸º system çš„ message ä¸­ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼å¯å°†æ–‡æ¡£ä¿¡æ¯è¾“å…¥ç»™æ¨¡å‹ï¼š\n\nåœ¨æå‰ä¸Šä¼ æ–‡æ¡£è·å–æ–‡æ¡£ IDï¼ˆfileidï¼‰åï¼Œå¯ä»¥ç›´æ¥æä¾› fileidã€‚æ”¯æŒåœ¨å¯¹è¯ä¸­ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ª fileidã€‚\nç›´æ¥è¾“å…¥éœ€è¦å¤„ç†çš„æ–‡æœ¬æ ¼å¼çš„æ–‡æ¡£å†…å®¹ï¼ˆfile contentï¼‰ã€‚\n\n\nfrom pprint import pprint\n\n# è·å–æ–‡ä»¶å†…å®¹\n# æ–°æ–‡æ¡£ä¸Šä¼ åéœ€è¦ç­‰å¾…æ¨¡å‹è§£æï¼Œé¦–è½®å“åº”æ—¶é—´å¯èƒ½è¾ƒé•¿\ncompletion = client.chat.completions.create(\n    model=\"qwen-long\",\n    messages=[\n        {\n            'role': 'system',\n            'content': 'You are a helpful assistant.'\n        },\n        {\n            'role': 'system',\n            'content': f'fileid://{file_object.id}'\n        },\n        {\n            'role': 'user',\n            'content': 'è¿™ç¯‡æ–‡ç« è®²äº†ä»€ä¹ˆï¼Ÿ'\n        }\n    ],\n    stream=False\n)\n\n\npprint(completion.choices[0].message.model_dump(), width = 72)\n\n{'content': 'è¿™ç¯‡æ–‡ç« ä»‹ç»äº†å‡ ç§å¸¸ç”¨çš„åˆ©ç”¨å®åŸºå› ç»„readsè¿›è¡Œç‰©ç§æ³¨é‡Šçš„å·¥å…·ï¼ŒåŒ…æ‹¬Kraken2ã€MetaPhlAnå’ŒCentrifugeï¼Œåˆ†åˆ«æè¿°äº†å®ƒä»¬çš„å·¥ä½œåŸç†ã€ä¼˜ç¼ºç‚¹ã€ä½¿ç”¨çš„æ•°æ®åº“ä»¥åŠè¾“å‡ºç»“æœã€‚æ­¤å¤–ï¼Œæ–‡ç« è¿˜è¯¦ç»†è¯´æ˜äº†å¦‚ä½•åœ¨ä¸ªäººç”µè„‘ä¸Šä½¿ç”¨Kraken2è¿›è¡Œç‰©ç§æ³¨é‡Šåˆ†æï¼ŒåŒ…æ‹¬å®‰è£…Kraken2ã€ä¸‹è½½æ•°æ®åº“ã€è¿è¡ŒKraken2è¿›è¡Œåˆ†ç±»æ³¨é‡ŠåŠåˆ†æç»“æœçš„å…·ä½“æ­¥éª¤ï¼Œå¹¶ç»™å‡ºäº†ä¸€ä¸ªä½¿ç”¨Rè¯­è¨€å¯¹Kraken2è¾“å‡ºç»“æœè¿›è¡Œå¯è§†åŒ–çš„ç¤ºä¾‹ã€‚',\n 'function_call': None,\n 'refusal': None,\n 'role': 'assistant',\n 'tool_calls': None}\n\n\n\n\n13.2.4 å¤šä¸ªæ–‡æ¡£\nå½“æœ‰å¤šä¸ªæ–‡æ¡£æ—¶ï¼Œå¯ä»¥å°†å¤šä¸ª fileid ä¼ é€’ç»™ contentã€‚\n# é¦–æ¬¡å¯¹è¯ä¼šç­‰å¾…æ–‡æ¡£è§£æå®Œæˆï¼Œé¦–è½®å“åº”æ—¶é—´å¯èƒ½è¾ƒé•¿\ncompletion = client.chat.completions.create(\n    model=\"qwen-long\",\n    messages=[\n        {\n            'role': 'system',\n            'content': 'You are a helpful assistant.'\n        },\n        {\n            'role': 'system',\n            'content': f\"fileid://{file_1.id},fileid://{file_2.id}\"\n        },\n        {\n            'role': 'user',\n            'content': 'è¿™å‡ ç¯‡æ–‡ç« è®²äº†ä»€ä¹ˆï¼Ÿ'\n        }\n    ],\n    stream=False\n)\n\n\n13.2.5 è¿½åŠ æ–‡æ¡£\nä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ï¼Œå¯ä»¥åœ¨å¯¹è¯è¿‡ç¨‹ä¸­è¿½åŠ æ–‡æ¡£ã€‚\n\n# data_1.pdfä¸ºåŸæ–‡æ¡£ï¼Œdata_2.pdfä¸ºè¿½åŠ æ–‡æ¡£\nfile_1 = client.files.create(file=Path(\"example/gaoch-cv.md\"),\n                             purpose=\"file-extract\")\n\n# åˆå§‹åŒ–messagesåˆ—è¡¨\nmessages = [\n    {\n        'role': 'system',\n        'content': 'You are a helpful assistant.'\n    },\n    {\n        'role': 'system',\n        'content': f'fileid://{file_1.id}'\n    },\n    {\n        'role': 'user',\n        'content': 'è¿™ç¯‡æ–‡ç« è®²äº†ä»€ä¹ˆï¼Ÿ'\n    },\n]\n# ç¬¬ä¸€è½®å“åº”\ncompletion = client.chat.completions.create(\n    model=\"qwen-long\",\n    messages=messages,\n    stream=False\n)\n\n# æ‰“å°å‡ºç¬¬ä¸€è½®å“åº”\nprint(f\"ç¬¬ä¸€è½®å“åº”ï¼š{completion.choices[0].message.model_dump()}\")\n\nç¬¬ä¸€è½®å“åº”ï¼š{'content': 'è¿™ç¯‡æ–‡ç« æ˜¯å…³äºé«˜æ˜¥è¾‰çš„ä¸ªäººç®€ä»‹ã€‚é«˜æ˜¥è¾‰æ˜¯ä¸€ä½å¾®ç”Ÿç‰©å­¦åšå£«ï¼Œç›®å‰åœ¨åä¸­å†œä¸šå¤§å­¦èµ„æºä¸ç¯å¢ƒå­¦é™¢æ‹…ä»»å‰¯ç ”ç©¶å‘˜å’Œç¡•å£«ç”Ÿå¯¼å¸ˆã€‚æ–‡ç« ä»‹ç»äº†ä»–çš„æ•™è‚²èƒŒæ™¯ã€ç ”ç©¶é¢†åŸŸã€ç§‘ç ”é¡¹ç›®ã€å­¦æœ¯æˆæœä»¥åŠä»–åœ¨å­¦æœ¯ç•Œçš„å½±å“åŠ›ã€‚', 'refusal': None, 'role': 'assistant', 'function_call': None, 'tool_calls': None}\n\n\nå°†ç¬¬ä¸€è½®å“åº”çš„å†…å®¹æ·»åŠ åˆ°å†å²è®°å½•ä¸­ã€‚\n\n# æ„é€ assistant_message\nassistant_message = {\n    \"role\": \"assistant\",\n    \"content\": completion.choices[0].message.content}\n\n# å°†assistant_messageæ·»åŠ åˆ°messagesä¸­\nmessages.append(assistant_message)\n\nä¸Šä¼ ä¸€ä¸ªæ–°æ–‡æ¡£ã€‚\n\n# è·å–è¿½åŠ æ–‡æ¡£çš„fileid\nfile_2 = client.files.create(file=Path(\"example/syncom-group-library.md\"), \n                             purpose=\"file-extract\")\n\n# å°†è¿½åŠ æ–‡æ¡£çš„fileidæ·»åŠ åˆ°messagesä¸­\nsystem_message = {\n    'role': 'system',\n    'content': f'fileid://{file_2.id}'\n}\nmessages.append(system_message)\n\n# æ·»åŠ ç”¨æˆ·é—®é¢˜\nmessages.append({\n    'role': 'user',\n    'content': 'è¿™ä¸¤ç¯‡æ–‡ç« çš„å†…å®¹æœ‰ä»€ä¹ˆå¼‚åŒç‚¹ï¼Ÿ'\n})\n\n# è¿½åŠ æ–‡æ¡£åçš„å“åº”\ncompletion = client.chat.completions.create(\n    model=\"qwen-long\",\n    messages=messages,\n    stream=False\n)\n\nprint(f\"è¿½åŠ æ–‡æ¡£åçš„å“åº”ï¼š{completion.choices[0].message.model_dump()}\")\n\nè¿½åŠ æ–‡æ¡£åçš„å“åº”ï¼š{'content': 'è¿™ä¸¤ç¯‡æ–‡ç« çš„ä¸»è¦ç›¸åŒç‚¹åœ¨äºå®ƒä»¬éƒ½ä¸æ•™è‚²å’Œç§‘å­¦ç ”ç©¶ç›¸å…³ï¼Œå¹¶ä¸”éƒ½æ¶‰åŠåˆ°äº†å¾®ç”Ÿç‰©å­¦è¿™ä¸ªé¢†åŸŸã€‚\\n\\nä¸åŒä¹‹å¤„åœ¨äºï¼š\\n\\n1. ç¬¬ä¸€ç¯‡æ–‡ç« \"é«˜æ˜¥è¾‰ä¸ªäººç®€ä»‹\"ä¸»è¦æ˜¯ä»‹ç»é«˜æ˜¥è¾‰ä¸ªäººçš„èŒä¸šç”Ÿæ¶¯ã€ç ”ç©¶æˆæœä»¥åŠä»–çš„ä¸“ä¸šé¢†åŸŸã€‚è¿™æ˜¯ä¸€ç¯‡å…³äºä¸ªäººçš„ä¼ è®°å¼æ–‡ç« ã€‚\\n\\n2. è€Œç¬¬äºŒç¯‡æ–‡ç« \"åœŸå£¤ç”Ÿç‰©è†œä¸ç¯å¢ƒå¥åº·ä¹¦å±‹æºèµ·\"åˆ™æ˜¯åœ¨è®²è¿°ä¸€ä¸ªç‰¹å®šçš„å›¾ä¹¦é¦†æˆ–è€…è¯´æ˜¯ä¹¦å±‹çš„å»ºç«‹åŸå› å’Œå®ƒçš„è¿ä½œè§„åˆ™ã€‚è¿™ç¯‡æ–‡ç« çš„é‡ç‚¹åœ¨äºæä¾›ç»™å­¦ç”Ÿå’Œç ”ç©¶äººå‘˜è·å–çŸ¥è¯†çš„é€”å¾„ï¼Œä»¥åŠå¯¹åœŸå£¤å¾®ç”Ÿç‰©å­¦çš„ç ”ç©¶çš„é‡è¦æ€§ã€‚', 'refusal': None, 'role': 'assistant', 'function_call': None, 'tool_calls': None}",
    "crumbs": [
      "<span class='chapter-number'>13</span>Â  <span class='chapter-title'>é˜¿é‡Œäº‘ç™¾ç‚¼</span>"
    ]
  },
  {
    "objectID": "volcengine.html",
    "href": "volcengine.html",
    "title": "14Â  ç«å±±å¼•æ“",
    "section": "",
    "text": "14.1 å¯ç”¨çš„æ¨¡å‹\næˆªæ­¢2024å¹´08æœˆ15æ—¥ï¼Œä¸€å…±æœ‰ 19 ä¸ªæ¨¡å‹ï¼Œå…¶ä¸­ 11 ä¸ªæ˜¯å­—èŠ‚è·³åŠ¨çš„è±†åŒ…æ¨¡å‹ï¼Œ2 ä¸ªæ˜¯ Meta çš„ llama3-70bã€llama3-8bï¼Œ3 ä¸ª Moonshot çš„æ¨¡å‹ï¼Œ2 ä¸ªæ™ºè°± AI çš„æ¨¡å‹ã€‚\nè¿™äº›æ¨¡å‹åˆ†ä¸º 3 ç±»ï¼šå¤§è¯­è¨€æ¨¡å‹ï¼ˆå¯¹è¯ï¼‰ã€è¯­éŸ³å¤§æ¨¡å‹ï¼ˆè¯­éŸ³åˆæˆï¼‰ã€è§†è§‰å¤§æ¨¡å‹ï¼ˆæ–‡ç”Ÿå›¾ï¼‰ã€‚\nè¿™äº›æ¨¡å‹éƒ½éœ€è¦å…ˆå¼€é€šï¼Œç„¶åæ‰èƒ½ä½¿ç”¨ã€‚å¼€é€šåæœ‰ä¸€å®šçš„å…è´¹é¢åº¦ã€‚è¶…è¿‡é¢åº¦åæŒ‰ç…§ Tokenï¼ˆè¯­è¨€ï¼‰æˆ–è€…è°ƒç”¨æ¬¡æ•°ï¼ˆæ–‡ç”Ÿå›¾ï¼‰æ”¶è´¹ã€‚",
    "crumbs": [
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>ç«å±±å¼•æ“</span>"
    ]
  },
  {
    "objectID": "volcengine.html#æ¨¡å‹è°ƒç”¨å®ä¾‹",
    "href": "volcengine.html#æ¨¡å‹è°ƒç”¨å®ä¾‹",
    "title": "14Â  ç«å±±å¼•æ“",
    "section": "14.2 æ¨¡å‹è°ƒç”¨å®ä¾‹",
    "text": "14.2 æ¨¡å‹è°ƒç”¨å®ä¾‹\n\n14.2.1 è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹\nåœ¨ç«å±±æ–¹èˆŸä¸­è°ƒç”¨è¯­è¨€æ¨¡å‹å¯ä»¥ä½¿ç”¨ç«å±±è‡ªå·±çš„ APIï¼Œå¦å¤–ä¹Ÿæ”¯æŒ OpenAI çš„æ–¹æ³•ã€‚\nåœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œmodel çš„å€¼æ˜¯ æ¥å…¥ç‚¹åç§°ï¼Œè€Œéæ¨¡å‹åç§°ã€‚æ¥å…¥ç‚¹é‡‡ç”¨çš„æ¨¡å‹åœ¨åˆ›å»ºæ¥å…¥ç‚¹çš„æ—¶å€™é€‰å®šï¼Œä½¿ç”¨çš„æ—¶å€™å¯¹ç”¨æˆ·ä¸å¯è§ã€‚è¿™é‡Œä½¿ç”¨çš„ ep-20240815100632-2m9cl ä½¿ç”¨çš„æ˜¯è±†åŒ…å¤§æ¨¡å‹ Doubao-pro-128k 240628ã€‚\n\nimport os\nfrom openai import OpenAI\n\nclient = OpenAI(\n    api_key = os.environ.get(\"ARK_API_KEY\"),\n    base_url = \"https://ark.cn-beijing.volces.com/api/v3\",\n)\n\n# Non-streaming:\nprint(\"----- standard request -----\")\ncompletion = client.chat.completions.create(\n    model = \"ep-20240815100632-2m9cl\",  # your model endpoint ID\n    messages = [\n        {\"role\": \"system\", \"content\": \"ä½ æ˜¯è±†åŒ…ï¼Œæ˜¯ç”±å­—èŠ‚è·³åŠ¨å¼€å‘çš„ AI äººå·¥æ™ºèƒ½åŠ©æ‰‹\"},\n        {\"role\": \"user\", \"content\": \"å¸¸è§çš„åå­—èŠ±ç§‘æ¤ç‰©æœ‰å“ªäº›ï¼Ÿ\"},\n    ],\n)\nprint(completion.choices[0].message.content)\n\n----- standard request -----\nå¸¸è§çš„åå­—èŠ±ç§‘æ¤ç‰©æœ‰å¾ˆå¤šï¼Œä»¥ä¸‹ä¸ºæ‚¨åˆ—ä¸¾ä¸€äº›ï¼š\n1. ç™½èœï¼šåŒ…æ‹¬å¤§ç™½èœã€å°ç™½èœç­‰ï¼Œæ˜¯äººä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­å¸¸è§çš„è”¬èœã€‚\n2. èåœï¼šæœ‰ç™½èåœã€èƒ¡èåœç­‰å“ç§ã€‚\n3. ç”˜è“ï¼šå¦‚ç´«ç”˜è“ã€å·å¿ƒèœç­‰ã€‚\n4. èŠ¥èœï¼šåŒ…æ‹¬èŠ¥èœç–™ç˜©ã€é›ªé‡Œè•»ç­‰ã€‚\n5. æ²¹èœï¼šæ—¢æ˜¯é‡è¦çš„æ²¹æ–™ä½œç‰©ï¼Œå«©è‹—ä¹Ÿå¯ä½œä¸ºè”¬èœé£Ÿç”¨ã€‚\n6. èŠ±æ¤°èœï¼šåˆåèœèŠ±ã€‚\n7. è¥¿å…°èŠ±ï¼šè¥å…»ä¸°å¯Œï¼Œæ·±å—äººä»¬å–œçˆ±ã€‚\n\nè¿™äº›åå­—èŠ±ç§‘æ¤ç‰©åœ¨ä¸–ç•Œå„åœ°å¹¿æ³›ç§æ¤ï¼Œå…·æœ‰é‡è¦çš„ç»æµå’Œè¥å…»ä»·å€¼ã€‚\n\n\næµå¼è¾“å‡ºã€‚\n\n# Streaming:\nprint(\"----- streaming request -----\")\nstream = client.chat.completions.create(\n    model = \"ep-20240815100632-2m9cl\",  # your model endpoint ID\n    messages = [\n        {\"role\": \"system\", \"content\": \"ä½ æ˜¯è±†åŒ…ï¼Œæ˜¯ç”±å­—èŠ‚è·³åŠ¨å¼€å‘çš„ AI äººå·¥æ™ºèƒ½åŠ©æ‰‹\"},\n        {\"role\": \"user\", \"content\": \"å¸¸è§çš„åå­—èŠ±ç§‘æ¤ç‰©æœ‰å“ªäº›ï¼Ÿ\"},\n    ],\n    stream=True\n)\n\nfor chunk in stream:\n    if not chunk.choices:\n        continue\n    print(chunk.choices[0].delta.content, end=\"\")\nprint()\n\n----- streaming request -----\nå¸¸è§çš„åå­—èŠ±ç§‘æ¤ç‰©æœ‰å¾ˆå¤šï¼Œä»¥ä¸‹ä¸ºæ‚¨åˆ—ä¸¾ä¸€äº›ï¼š\n1. ç™½èœï¼šåŒ…æ‹¬å¤§ç™½èœã€å°ç™½èœç­‰ï¼Œæ˜¯äººä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­å¸¸è§çš„è”¬èœã€‚\n2. ç”˜è“ï¼šå¦‚å·å¿ƒèœã€ç´«ç”˜è“ç­‰ï¼Œå¯Œå«ç»´ç”Ÿç´ å’Œè†³é£Ÿçº¤ç»´ã€‚\n3. èåœï¼šæœ‰ç™½èåœã€çº¢èåœã€é’èåœç­‰å“ç§ã€‚\n4. èŠ¥èœï¼šåŒ…æ‹¬å¶ç”¨èŠ¥èœã€èŒç”¨èŠ¥èœç­‰ã€‚\n5. æ²¹èœï¼šæ—¢å¯ä½œä¸ºè”¬èœé£Ÿç”¨ï¼Œä¹Ÿå¯ç”¨äºæ¦¨æ²¹ã€‚\n6. èŠ±æ¤°èœï¼šåˆç§°èœèŠ±ï¼Œè¥å…»ä¸°å¯Œã€‚\n7. è¥¿å…°èŠ±ï¼šå…·æœ‰è¾ƒé«˜çš„è¥å…»ä»·å€¼ï¼Œæ·±å—äººä»¬å–œçˆ±ã€‚\n8. è¯¸è‘›èœï¼šåˆåäºŒæœˆå…°ï¼Œå¸¸ä½œä¸ºè§‚èµæ¤ç‰©å’Œé‡èœã€‚\n\nè¿™äº›åå­—èŠ±ç§‘æ¤ç‰©åœ¨äººä»¬çš„é¥®é£Ÿå’Œç”Ÿæ´»ä¸­éƒ½å…·æœ‰é‡è¦çš„åœ°ä½ã€‚\n\n\n\n\n14.2.2 è°ƒç”¨æ–‡ç”Ÿå›¾æ¨¡å‹\néœ€è¦ç”¨ POST æ–¹å¼æˆ–è€…å€ŸåŠ©äºè‡ªå®šä¹‰çš„è®¿é—®æ¥å£æ¨¡å—ã€‚\nï¼ˆç•¥ï¼‰",
    "crumbs": [
      "<span class='chapter-number'>14</span>Â  <span class='chapter-title'>ç«å±±å¼•æ“</span>"
    ]
  },
  {
    "objectID": "research-summary.html",
    "href": "research-summary.html",
    "title": "15Â  ç ”ç©¶æ¦‚è¦",
    "section": "",
    "text": "15.1 ä»»åŠ¡æµç¨‹\né¦–å…ˆå°†å‚è€ƒæ–‡çŒ®çš„æ‘˜è¦è¿›è¡Œæ•´ç†ï¼Œç„¶åä½¿ç”¨æ¨¡å‹æ¥åˆ†æè¿™äº›æ‘˜è¦ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºæœ¬çš„æ­¥éª¤ï¼š\nè¿™æ ·ï¼Œä½ å°±å¯ä»¥åˆ©ç”¨æ¨¡å‹å¿«é€Ÿäº†è§£å¤§é‡å‚è€ƒæ–‡çŒ®çš„ä¸»è¦å†…å®¹ï¼Œå¹¶æ ¹æ®è‡ªå·±çš„å…´è¶£å’Œç ”ç©¶æ–¹å‘é€‰æ‹©éœ€è¦æ·±å…¥é˜…è¯»çš„æ–‡çŒ®ã€‚\nå½“ç„¶ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªå…·ä½“çš„å®æ–½ç¤ºä¾‹ï¼Œå‡è®¾ä½ æœ‰å‡ ç¯‡å‚è€ƒæ–‡çŒ®çš„æ‘˜è¦ï¼Œå¹¶å¸Œæœ›æ¨¡å‹åˆ†æå…¶ä¸­çš„ä¸»è¦ç ”ç©¶ä¸»é¢˜ï¼š",
    "crumbs": [
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>ç ”ç©¶æ¦‚è¦</span>"
    ]
  },
  {
    "objectID": "research-summary.html#ä»»åŠ¡æµç¨‹",
    "href": "research-summary.html#ä»»åŠ¡æµç¨‹",
    "title": "15Â  ç ”ç©¶æ¦‚è¦",
    "section": "",
    "text": "æ”¶é›†æ‘˜è¦ï¼šå°†ä½ æ‰€æœ‰å‚è€ƒæ–‡çŒ®çš„æ‘˜è¦æ”¶é›†èµ·æ¥ï¼Œå¯ä»¥æŒ‰ç…§ä¸»é¢˜æˆ–å¹´ä»½ç­‰è¿›è¡Œåˆ†ç±»ã€‚\nè¾“å…¥æ¨¡å‹ï¼šå°†è¿™äº›æ‘˜è¦åˆ†æ‰¹è¾“å…¥æ¨¡å‹ã€‚ç”±äºæ¯ä¸ªæ‘˜è¦å¯èƒ½è¾ƒçŸ­ï¼Œä½ å¯ä»¥ä¸€æ¬¡è¾“å…¥å¤šä¸ªæ‘˜è¦ã€‚\nåˆ†æä¸»é¢˜ï¼šè¦æ±‚æ¨¡å‹æ ¹æ®è¾“å…¥çš„æ‘˜è¦ï¼Œè¯†åˆ«å‡ºæ¯ä¸ªå‚è€ƒæ–‡çŒ®çš„ä¸»è¦ç ”ç©¶ä¸»é¢˜ã€‚\n\n\n\n\n15.1.1 ç¤ºä¾‹æ‘˜è¦\n\næ‘˜è¦ 1: â€œThis study explores the effects of soil microbiomes on plant growth in maize, focusing on nitrogen fixation and plant health under different environmental conditions.â€\næ‘˜è¦ 2: â€œThe research investigates the impact of synthetic microbial communities on soil nutrient cycling, analyzing their potential to enhance agricultural sustainability.â€\næ‘˜è¦ 3: â€œThis paper examines the interactions between soil microorganisms and plant roots, specifically in the context of drought resistance in crops.â€\n\n\n\n15.1.2 å®æ–½æ­¥éª¤\nç¬¬ä¸€æ­¥ï¼šæ”¶é›†æ‘˜è¦\nå°†è¿™äº›æ‘˜è¦æ”¶é›†å¹¶æ•´ç†å¥½ï¼Œå¯ä»¥æŒ‰ä¸»é¢˜æˆ–å…³é”®å­—è¿›è¡Œåˆ†ç±»ã€‚\nç¬¬äºŒæ­¥ï¼šè¾“å…¥æ¨¡å‹\nå‡è®¾ä½ å°†è¿™ä¸‰ä¸ªæ‘˜è¦åˆ†æ‰¹è¾“å…¥æ¨¡å‹ï¼Œå¹¶è®©æ¨¡å‹è¯†åˆ«æ¯ä¸ªæ‘˜è¦çš„ä¸»è¦ç ”ç©¶ä¸»é¢˜ã€‚ä½ å¯ä»¥æ„é€ è¿™æ ·çš„æç¤ºï¼š\næç¤ºè¯ç¤ºä¾‹:\n\nâ€œè¯·æ ¹æ®ä»¥ä¸‹æ‘˜è¦è¯†åˆ«æ¯ç¯‡æ–‡ç« çš„ä¸»è¦ç ”ç©¶ä¸»é¢˜ï¼š\n\næ‘˜è¦ 1: [è¾“å…¥æ‘˜è¦]\næ‘˜è¦ 2: [è¾“å…¥æ‘˜è¦]\næ‘˜è¦ 3: [è¾“å…¥æ‘˜è¦]â€\n\n\nç¬¬ä¸‰æ­¥ï¼šæ¨¡å‹è¾“å‡º\næ¨¡å‹å°†åˆ†æè¿™äº›æ‘˜è¦ï¼Œå¹¶è¯†åˆ«å‡ºæ¯ç¯‡æ–‡ç« çš„ä¸»é¢˜ã€‚ä¾‹å¦‚ï¼Œæ¨¡å‹å¯èƒ½ç»™å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š\n\n\næ‘˜è¦ 1 ä¸»é¢˜: æ¤ç‰©å¥åº·ä¸æ°®å›ºå®šåœ¨ä¸åŒç¯å¢ƒæ¡ä»¶ä¸‹çš„å˜åŒ–\næ‘˜è¦ 2 ä¸»é¢˜: å¾®ç”Ÿç‰©ç¾¤è½åœ¨åœŸå£¤å…»åˆ†å¾ªç¯ä¸­çš„ä½œç”¨åŠå…¶å¯¹å†œä¸šå¯æŒç»­æ€§çš„å½±å“\næ‘˜è¦ 3 ä¸»é¢˜: åœŸå£¤å¾®ç”Ÿç‰©ä¸ä½œç‰©æŠ—æ—±æ€§ä¹‹é—´çš„ç›¸äº’ä½œç”¨",
    "crumbs": [
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>ç ”ç©¶æ¦‚è¦</span>"
    ]
  },
  {
    "objectID": "research-summary.html#ä»£ç å®ç°",
    "href": "research-summary.html#ä»£ç å®ç°",
    "title": "15Â  ç ”ç©¶æ¦‚è¦",
    "section": "15.2 ä»£ç å®ç°",
    "text": "15.2 ä»£ç å®ç°\nè¦å®ç°è¿™ä¸ªè¿‡ç¨‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ Python ç»“åˆ OpenAI çš„ API æ¥å¤„ç†æ–‡æœ¬ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä»£ç ç¤ºä¾‹ï¼Œåˆ©ç”¨ GPT æ¨¡å‹åˆ†ææ‘˜è¦å¹¶æå–ä¸»è¦ä¸»é¢˜ã€‚\nç¯å¢ƒå‡†å¤‡ï¼š\nï¼ˆç•¥ï¼‰\nå®ç°ä»£ç ï¼š\n\nanalyze_abstracts å‡½æ•°ï¼šæ¥å—ä¸€ä¸ªæ‘˜è¦åˆ—è¡¨ï¼Œå°†å®ƒä»¬æ‹¼æ¥æˆä¸€ä¸ªè¯·æ±‚æç¤ºï¼Œå¹¶ä¼ é€’ç»™ GPT æ¨¡å‹è¿›è¡Œå¤„ç†ã€‚\nopenai.chat.completions.create()ï¼šè°ƒç”¨ OpenAI çš„æ¨¡å‹æ¥ç”Ÿæˆå¯¹è¯ç»“æœï¼Œè¾“å‡ºæ¯ä¸ªæ‘˜è¦çš„ä¸»è¦ä¸»é¢˜ã€‚\nmodel=â€œgpt-4o-caâ€ï¼šä½ å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©ä¸åŒçš„GPTæ¨¡å‹ã€‚\næ‘˜è¦è¾“å…¥ï¼šè¾“å…¥å¤šä¸ªæ‘˜è¦ï¼Œæ¨¡å‹ä¼šåˆ†æå¹¶æå–ä¸»è¦çš„ç ”ç©¶ä¸»é¢˜ã€‚\n\nè¿è¡Œæ•ˆæœï¼š\næ¨¡å‹ä¼šè¿”å›æ¯ä¸ªæ‘˜è¦çš„ç ”ç©¶ä¸»é¢˜ï¼š\n\nimport openai\nimport os\nfrom IPython.display import Markdown\n\nopenai.base_url = \"https://api.chatanywhere.tech\"\nopenai.api_key = os.getenv(\"CHATANYWHERE_API_KEY\")\n\nsystem_prompt = \"è¿™äº›æ–‡ç« çš„ä¸»é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ\"\n\ndef analyze_abstracts(abstracts):\n  # Create prompt with multiple messages (abstracts)\n  messages = [\n      {\"role\": \"system\", \"content\": system_prompt}\n  ]\n  for abstract in abstracts:\n      messages.append({\"role\": \"user\", \"content\": abstract})\n\n  # Use Completion.create with messages list\n  response = openai.chat.completions.create(\n      model=\"gpt-4o-ca\",  # Adjust model as needed\n      messages=messages,\n      n=1,  # Generate only 1 response\n  )\n\n  # Extract and return the analyzed content\n  return response.choices[0].message.content\n\n# ç¤ºä¾‹æ‘˜è¦\nabstracts = [\n  \"Paper1: This study explores the effects of soil microbiomes on plant growth in maize, focusing on nitrogen fixation and plant health under different environmental conditions.\",\n  \"Paper2: The research investigates the impact of synthetic microbial communities on soil nutrient cycling, analyzing their potential to enhance agricultural sustainability.\",\n  \"Paper3: This paper examines the interactions between soil microorganisms and plant roots, specifically in the context of drought resistance in crops.\"\n]\n\n\n# åˆ†ææ‘˜è¦å¹¶è¾“å‡ºä¸»é¢˜\nthemes = analyze_abstracts(abstracts)\nMarkdown(themes)\n\nè¿™äº›æ–‡ç« çš„ä¸»é¢˜å¦‚ä¸‹ï¼š\n\nPaper 1: ç ”ç©¶åœŸå£¤å¾®ç”Ÿç‰©ç¾¤å¯¹ç‰ç±³æ¤ç‰©ç”Ÿé•¿çš„å½±å“ï¼Œé‡ç‚¹å…³æ³¨åœ¨ä¸åŒç¯å¢ƒæ¡ä»¶ä¸‹çš„å›ºæ°®ä½œç”¨å’Œæ¤ç‰©å¥åº·ã€‚\nPaper 2: è°ƒæŸ¥åˆæˆå¾®ç”Ÿç‰©ç¾¤è½å¯¹åœŸå£¤å…»åˆ†å¾ªç¯çš„å½±å“ï¼Œåˆ†æå…¶å¢å¼ºå†œä¸šå¯æŒç»­æ€§çš„æ½œåŠ›ã€‚\nPaper 3: æ¢è®¨åœŸå£¤å¾®ç”Ÿç‰©ä¸æ¤ç‰©æ ¹ç³»ä¹‹é—´çš„ç›¸äº’ä½œç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½œç‰©æŠ—æ—±æ–¹é¢çš„åº”ç”¨ã€‚\n\næ€»ä½“è€Œè¨€ï¼Œè¿™äº›æ–‡ç« å‡æ¶‰åŠåœŸå£¤å¾®ç”Ÿç‰©ä¸æ¤ç‰©ç”Ÿé•¿åŠå¥åº·ä¹‹é—´çš„å…³ç³»ï¼Œå…³æ³¨ç‚¹åŒ…æ‹¬å›ºæ°®ã€å†œä¸šå¯æŒç»­æ€§å’ŒæŠ—æ—±æ€§ã€‚",
    "crumbs": [
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>ç ”ç©¶æ¦‚è¦</span>"
    ]
  },
  {
    "objectID": "research-summary.html#ä¸å¯¼å‡ºæ–‡ä»¶è”åŠ¨",
    "href": "research-summary.html#ä¸å¯¼å‡ºæ–‡ä»¶è”åŠ¨",
    "title": "15Â  ç ”ç©¶æ¦‚è¦",
    "section": "15.3 ä¸å¯¼å‡ºæ–‡ä»¶è”åŠ¨",
    "text": "15.3 ä¸å¯¼å‡ºæ–‡ä»¶è”åŠ¨\nå¥½çš„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ªæµç¨‹æ¥è‡ªåŠ¨è¯»å– Web of Science çš„å¯¼å‡ºæ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ CSV/TSV æ ¼å¼ï¼‰ï¼Œç„¶åæ¯æ¬¡æ‰¹é‡å¤„ç† 5 ç¯‡æ–‡çŒ®çš„æ‘˜è¦ï¼Œå¹¶ä½¿ç”¨ GPT æ¨¡å‹æå–ä¸»é¢˜ï¼Œæœ€åå°†æå–çš„ä¸»é¢˜ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ä¸­ã€‚ä¸‹é¢æ˜¯å…·ä½“çš„å®ç°æ€è·¯å’Œä»£ç ã€‚\næµç¨‹æ­¥éª¤ï¼š\n\nè¯»å–CSVæ–‡ä»¶ï¼šä»å¯¼å‡ºçš„Web of Scienceæ–‡ä»¶ä¸­è¯»å–æ–‡çŒ®çš„æ ‡é¢˜ï¼ˆtiåˆ—ï¼‰å’Œæ‘˜è¦ï¼ˆabåˆ—ï¼‰ã€‚\nåˆ†æ‰¹å¤„ç†æ‘˜è¦ï¼šæ¯æ¬¡æå–5ç¯‡æ–‡çŒ®çš„æ‘˜è¦ï¼Œä½¿ç”¨GPTæ¨¡å‹åˆ†æä¸»é¢˜ã€‚\nä¿å­˜ç»“æœï¼šå°†æ¯ç¯‡æ–‡çŒ®çš„æ ‡é¢˜ã€æ‘˜è¦ä»¥åŠæå–åˆ°çš„ä¸»é¢˜ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶ï¼ˆå¦‚CSVæ–‡ä»¶ï¼‰ä¸­ã€‚\n\n\n15.3.1 è¯»å–æ–‡ä»¶\n\nimport pandas as pd\n\n# è¯»å–CSVæ–‡ä»¶ä¸­çš„æ ‡é¢˜å’Œæ‘˜è¦\nfile = \"example/wos-fast5k/savedrecs.txt\"\n    \n# æ ¹æ®æ–‡ä»¶çš„åˆ†éš”ç¬¦ä¿®æ”¹ delimiter å‚æ•°\n# è®¾ç½® index_col=False æ¥ç¡®ä¿ç¬¬ä¸€åˆ—ä¸ä¼šè¢«å½“ä½œè¡Œç´¢å¼•\ndata = pd.read_csv(file, delimiter='\\t', index_col=False)  \n\n# åˆ é™¤å…¨ä¸º NaN çš„åˆ—\ndata = data.loc[:, data.notna().sum() != 0]\n\n# æŸ¥çœ‹å¤„ç†åçš„æ•°æ®\nprint(data[0:5])\n\n  PT                                                 AU   BA   CA   GP  \\\n0  J  Just, Berta Singla; Marks, Evan Alexander Neth...  NaN  NaN  NaN   \n1  J  Pereira-Marques, Joana; Ferreira, Rui M.; Figu...  NaN  NaN  NaN   \n2  J  Golzar-Ahmadi, Mehdi; Bahaloo-Horeh, Nazanin; ...  NaN  NaN  NaN   \n3  J  Li, Chenglong; Han, Yanfeng; Zou, Xiao; Zhang,...  NaN  NaN  NaN   \n4  J  Hu, Yu; Wang, Yulin; Wang, Runhua; Wang, Xiaok...  NaN  NaN  NaN   \n\n                                                  TI  \\\n0  Biofertilization increases soil organic carbon...   \n1  A metatranscriptomics strategy for efficient c...   \n2  Pathway to industrial application of heterotro...   \n3  A systematic discussion and comparison of the ...   \n4  Dirammox-dominated microbial community for bio...   \n\n                                                  SO   VL   IS   BP  ...  \\\n0  INTERNATIONAL JOURNAL OF AGRICULTURAL SUSTAINA...   22    1  NaN  ...   \n1                                       GUT MICROBES   16    1  NaN  ...   \n2                             BIOTECHNOLOGY ADVANCES   77  NaN  NaN  ...   \n3                SYNTHETIC AND SYSTEMS BIOTECHNOLOGY    9    4  775  ...   \n4             APPLIED MICROBIOLOGY AND BIOTECHNOLOGY  108    1  NaN  ...   \n\n     PY                                                 AB  \\\n0  2024  Protecting and building soil carbon has become...   \n1  2024  The high background of host RNA poses a major ...   \n2  2024  The transition to renewable energies and elect...   \n3  2024  Synthetic microbial community has widely conce...   \n4  2024  Direct ammonia oxidation (Dirammox) might be o...   \n\n                                                  C1   CT   CY   SP   CL TC  \\\n0  [Just, Berta Singla; Llenas, Laia; Ponsa, Serg...  NaN  NaN  NaN  NaN  0   \n1  [Pereira-Marques, Joana; Ferreira, Rui M.; Fig...  NaN  NaN  NaN  NaN  2   \n2  [Golzar-Ahmadi, Mehdi; Norouzi, Forough; Holus...  NaN  NaN  NaN  NaN  0   \n3  [Li, Chenglong; Han, Yanfeng; Zou, Xiao; Zhang...  NaN  NaN  NaN  NaN  0   \n4  [Hu, Yu; Wang, Yulin; Liu, Shuang-Jiang] Shand...  NaN  NaN  NaN  NaN  0   \n\n                                                  WC                   UT  \n0  Agriculture, Multidisciplinary; Green & Sustai...  WOS:001247571700001  \n1        Gastroenterology & Hepatology; Microbiology  WOS:001176335800001  \n2               Biotechnology & Applied Microbiology  WOS:001316252000001  \n3               Biotechnology & Applied Microbiology  WOS:001273513000001  \n4               Biotechnology & Applied Microbiology  WOS:001252334300001  \n\n[5 rows x 24 columns]\n\n\nä¸‹é¢ï¼Œå°† dataframe ä¸­çš„æ•°æ®é€æ‰¹å¤„ç†ï¼Œç”Ÿæˆ JSON æ ¼å¼çš„æ–‡æœ¬ã€‚\n\nbatch_to_json()ï¼šè¿™æ˜¯å‡½æ•°çš„ä¸»ä½“ï¼Œå°†æ•°æ®æŒ‰æ‰¹æ¬¡è¿›è¡Œå¤„ç†ï¼Œå¹¶å°†æ¯è¡Œæ•°æ®è½¬åŒ–ä¸º JSON æ ¼å¼ã€‚\næ‰¹æ¬¡åˆ‡åˆ†ï¼šä½¿ç”¨ data[i:i+batch_size] å¯¹ DataFrame è¿›è¡Œåˆ†æ‰¹å¤„ç†ã€‚\næ„å»º JSONï¼šæ¯è¡Œæ•°æ®æå–å‡º UTã€TIã€AB åˆ—çš„å€¼ï¼Œå¹¶æ„å»ºä¸€ä¸ªåŒ…å« idã€ti å’Œ ab é”®çš„ JSON å¯¹è±¡ã€‚\njson.dumps()ï¼šå°†åˆ—è¡¨å½¢å¼çš„ JSON å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²ã€‚\nensure_ascii=Falseï¼šç¡®ä¿è¾“å‡ºçš„ JSON å­—ç¬¦ä¸²æ”¯æŒé ASCII å­—ç¬¦ã€‚\n\n\nimport pandas as pd\nimport json\n\ndef batch_to_json(data, batch_size):\n    # ç¡®ä¿è¾“å…¥çš„ data æ˜¯ä¸€ä¸ª DataFrameï¼Œä¸” batch_size æ˜¯æ­£æ•´æ•°\n    if not isinstance(data, pd.DataFrame):\n        raise ValueError(\"data åº”è¯¥æ˜¯ä¸€ä¸ª pandas DataFrame\")\n    if not isinstance(batch_size, int) or batch_size &lt;= 0:\n        raise ValueError(\"batch_size åº”è¯¥æ˜¯ä¸€ä¸ªæ­£æ•´æ•°\")\n    \n    # æå– dataframe ä¸­çš„æ¯ batch_size è¡Œæ•°æ®\n    batches = [data[i:i+batch_size] for i in range(0, len(data), batch_size)]\n    \n    result = []\n    for batch in batches:\n        json_batch = []\n        for _, row in batch.iterrows():\n            # æ„å»ºæ¯è¡Œçš„ JSON å¯¹è±¡\n            json_obj = {\n                \"ID\": row[\"UT\"],\n                \"TI\": row[\"TI\"],\n                \"AB\": row[\"AB\"]\n            }\n            json_batch.append(json_obj)\n        result.append(json.dumps(json_batch, ensure_ascii=False))  # è½¬æ¢ä¸º JSON æ ¼å¼çš„å­—ç¬¦ä¸²\n    return result\n\n# ç¤ºä¾‹ä½¿ç”¨\nbatch_size = 2\njson_output = batch_to_json(data[0:6], batch_size)\n\nfrom pprint import pprint\nfor batch in json_output:\n    Markdown(batch)\n\n\n\n15.3.2 è°ƒæ•´æç¤ºè¯\nNote: å°†æç¤ºè¯æ¢æˆè‹±æ–‡æ•ˆæœå¯èƒ½ä¼šæ›´å¥½ã€‚\n\n# ä½¿ç”¨ä¸‰å¼•å·æ’å…¥ä¸€ä¸ªéå¸¸é•¿çš„ç³»ç»Ÿæç¤ºç¬¦\nsystem_prompt = \"\"\"  \nè¯·æ ¹æ®ä»¥ä¸‹å†…å®¹è¯†åˆ«æ¯ç¯‡æ–‡ç« çš„ç ”ç©¶ä¸»é¢˜ä¸**åˆæˆèŒç¾¤**ç ”ç©¶çš„ç›¸å…³æ€§ï¼Œå¹¶ç»™å‡ºè¯„åˆ†ï¼ˆå®Œå…¨ä¸ç›¸å…³ 0 åˆ†ï¼Œååˆ†ç›¸å…³ 10 åˆ†ï¼Œéƒ¨åˆ†ç›¸å…³ 1-9 åˆ†ï¼‰ï¼š\n\nè¯·æ³¨æ„ï¼š\n\n1. åˆæˆèŒç¾¤æ˜¯æŒ‡äººä»¬åˆ©ç”¨ä¸€ä¸ªæˆ–è€…å¤šä¸ªå¾®ç”Ÿç‰©ç»„æˆçš„å¤åˆç‰©ï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªç›Šç”ŸèŒï¼Œä¸€ç§ç”Ÿç‰©è‚¥æ–™ï¼Œæˆ–è€…ä¸€ä¸ªå°å‹çš„å¾®ç”Ÿç‰©ç¾¤è½ã€‚æ‰€æœ‰ä¸è¿™äº›å†…å®¹ç›¸å…³çš„ç ”ç©¶éƒ½åº”è¯¥è¢«è®¤ä¸ºæ˜¯åˆæˆèŒç¾¤çš„ç›¸å…³ç ”ç©¶ã€‚\n2. åç»­çš„è¿™äº›å†…å®¹éƒ½ä¼šä»¥ JSON æ ¼å¼ç»™å‡ºæ–‡ç« çš„ IDã€æ ‡é¢˜ï¼ˆTIï¼‰å’Œæ‘˜è¦ï¼ˆABï¼‰ï¼Œè¯·æ ¹æ®æ ‡é¢˜å’Œæ‘˜è¦çš„å†…å®¹è¿›è¡Œåˆ¤æ–­ï¼Œå¹¶ä¸”è®°å½• ID ç”¨äºå›ç­”ã€‚\n3. åŠ¡å¿…æŒ‰ç…§ä¸‹é¢çš„è¦æ±‚å›ç­”ã€‚\n\nå›ç­”è¦æ±‚ï¼š\n\n1. åœ¨å›ç­”æ—¶è¯·ç»™å‡ºæ–‡ç« çš„ IDï¼Œè¯„åˆ†ï¼ˆscoreï¼‰ä¸ç®€çŸ­ç†ç”±ï¼ˆreasonï¼‰ã€‚\n2. è¯·ä½¿ç”¨ JSON æ ¼å¼å›ç­”ã€‚\n\n\nä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹å›ç­”ï¼š\n\n{results: [{\"ID\":\"WOS:000996233600009\",\"score\":5, \"reason\": \"reason in Chinese\"},\n{\"ID\":\"WOS:001247571700001\",\"score\":10, \"reason\": \"reason in Chinese\"}]}\n\n\"\"\"\n\nè¦ä½¿ OpenAI API è°ƒç”¨çš„ç»“æœä»¥ç»Ÿä¸€çš„ JSON æ ¼å¼è¿”å›ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œè®¾ç½®ï¼š\n\ndef analyze_content(content):\n  # Create prompt with multiple messages (abstracts)\n  messages = [\n      {\"role\": \"system\", \"content\": system_prompt}\n  ]\n  \n  messages.append({\"role\": \"user\", \"content\": content})\n\n  # Use Completion.create with messages list\n  response = openai.chat.completions.create(\n      model=\"gpt-4o-ca\",  # Adjust model as needed\n      messages=messages,\n      response_format={\"type\": \"json_object\"}\n  )\n\n  # Extract and return the analyzed content\n  return response.choices[0].message.content\n\n\nMarkdown(analyze_content(json_output[0]))\n\n{ â€œresultsâ€: [ { â€œIDâ€: â€œWOS:001247571700001â€, â€œscoreâ€: 10, â€œreasonâ€: â€œè¿™ç¯‡æ–‡ç« ç ”ç©¶äº†ç”Ÿç‰©è‚¥æ–™å¾®ç”Ÿç‰©æ¥ç§å‰‚å¯¹åœŸå£¤æœ‰æœºç¢³æµ“åº¦çš„å½±å“ï¼Œç¬¦åˆåˆæˆèŒç¾¤çš„å®šä¹‰ï¼Œå³ä¸€ä¸ªæˆ–å¤šä¸ªå¾®ç”Ÿç‰©ç»„æˆçš„å¤åˆç‰©ã€‚â€ }, { â€œIDâ€: â€œWOS:001176335800001â€, â€œscoreâ€: 7, â€œreasonâ€: â€œè¿™ç¯‡æ–‡ç« è™½ç„¶ä¸»è¦è®¨è®ºäº†åœ¨äººç±»ç»„ç»‡ä¸­ä½å¾®ç”Ÿç‰©å«é‡æƒ…å†µä¸‹çš„å¾®ç”Ÿç‰©ç»„è¡¨å¾ç­–ç•¥ï¼Œä½†æåˆ°äº†å¯¹åˆæˆæ ·æœ¬çš„æµ‹è¯•ï¼Œæ¶‰åŠé€šè¿‡åˆæˆçš„æ–¹å¼æ¥éªŒè¯æ–¹æ³•ï¼Œå› æ­¤éƒ¨åˆ†ç›¸å…³ã€‚â€ } ] }\n\n\n\n\n15.3.3 æ‰¹å¤„ç†\nç°åœ¨å¯ä»¥è¿›è¡Œæ‰¹å¤„ç†ï¼Œå¹¶å°†ç»“æœä¿å­˜ä¸‹æ¥ã€‚\n\nbatches = batch_to_json(data[0:20], batch_size=5)\n\nresults = []\n\nfor batch in batches:\n  result = analyze_content(batch)\n  results.append(result)\n\nå°†åˆ—è¡¨åˆå¹¶æˆä¸€ä¸ªæ•°æ®æ¡†ï¼Œå¹¶ä¿å­˜åˆ°ç¡¬ç›˜ä¸­ä¾›åç»­åˆ†æä½¿ç”¨ã€‚\n\nimport json\n\ndata_list = []\n\n\nfor json_data in results:\n  data = json.loads(json_data)\n  result = data['results']\n\n  for item in result:\n    data_list.append([item['ID'], item['score'], item['reason']])\n\ndf = pd.DataFrame(data_list, columns=['ID', 'score', 'reason'])\n\ndf\n# df.to_csv('output.csv', index=False)\n\n\n\n\n\n\n\n\nID\nscore\nreason\n\n\n\n\n0\nWOS:001247571700001\n9\nè¯¥ç ”ç©¶è¯„ä¼°äº†å¾®ç”Ÿç‰©æ¥ç§å‰‚ï¼ˆç”Ÿç‰©è‚¥æ–™ï¼‰å¯¹åœŸå£¤æœ‰æœºç¢³æµ“åº¦çš„å½±å“ï¼Œè¿™é‡Œè®¨è®ºäº†ä¸åŒç±»å‹çš„ç”Ÿç‰©è‚¥æ–™å’Œå¾®...\n\n\n1\nWOS:001176335800001\n7\nè¿™ç¯‡æ–‡ç« æè¿°äº†åˆæˆæ ·æœ¬ï¼ˆåŒ…å«å¾®ç”Ÿç‰©å’Œå®¿ä¸»ç»†èƒç»„æˆï¼‰çš„ç”ŸæˆåŠå…¶ç”¨äºä¼˜åŒ–å’Œå»ºç«‹åˆ†ææµç¨‹ï¼Œå°½ç®¡é‡ç‚¹...\n\n\n2\nWOS:001316252000001\n6\nè¿™ç¯‡æ–‡ç« æ¢è®¨äº†å¼‚å…»å¾®ç”Ÿç‰©åœ¨ä»ç”µå­åºŸç‰©ä¸­å›æ”¶é‡‘å±çš„äº§ä¸šåº”ç”¨ï¼Œå…¶ä¸­æ¶‰åŠäººå·¥å¾®ç”Ÿç‰©ç¾¤è½å’Œåˆæˆç”Ÿç‰©å­¦...\n\n\n3\nWOS:001273513000001\n10\næœ¬æ–‡ç³»ç»Ÿè®¨è®ºå’Œæ¯”è¾ƒäº†åˆæˆå¾®ç”Ÿç‰©ç¾¤è½çš„æ„å»ºæ–¹æ³•ï¼Œç›´æ¥è®¨è®ºäº†åˆæˆèŒç¾¤çš„æ¦‚å¿µã€åº”ç”¨å’Œæ„å»ºæ–¹æ³•ï¼Œæ˜¯å®Œ...\n\n\n4\nWOS:001252334300001\n8\nè¯¥ç ”ç©¶ä»‹ç»äº†ä¸€ç§ç‰¹å®šçš„å¾®ç”Ÿç‰©ç¾¤è½åœ¨åºŸæ°´å¤„ç†ä¸­çš„åº”ç”¨ï¼Œè™½ç„¶é‡ç‚¹æ˜¯Dirammoxç»†èŒï¼Œä½†æ¶‰åŠå¾®...\n\n\n5\nWOS:001209713100001\n6\nè¿™ç¯‡æ–‡ç« è™½ç„¶ä¸»è¦è®¨è®ºçš„æ˜¯å¾®è—»ç”¨äºç”Ÿç‰©ç‡ƒæ–™å’Œå…¶ä»–å¢å€¼äº§å“çš„å¯æŒç»­åˆ©ç”¨ï¼Œä½†ä¹Ÿæåˆ°å¾®è—»å¯ä»¥ä½œä¸ºç”Ÿç‰©...\n\n\n6\nWOS:001198552100002\n9\næœ¬ç ”ç©¶ä¸“æ³¨äºå¾®ç”Ÿç‰©ç¾¤è½çš„äº¤äº’ä½œç”¨ç ”ç©¶ï¼Œå¹¶æåˆ°äº†å¼€å‘åˆæˆå¾®ç”Ÿç‰©å…±ç”Ÿä½“çš„å®šé‡å’Œå®šæ€§æ–¹æ³•ï¼Œå› æ­¤å®ƒä¸...\n\n\n7\nWOS:001171546000001\n10\nè¿™ç¯‡æ–‡ç« æ˜ç¡®è®¨è®ºäº†ä¸€ç§åŸºäºåŠŸèƒ½åŸºå› çš„åˆæˆå¾®ç”Ÿç‰©ç¾¤è½çš„æ„å»ºï¼Œä»¥ä¿ƒè¿›æ°´ç¨»ç¡«å¾ªç¯ã€‚å®Œå…¨ç¬¦åˆåˆæˆèŒç¾¤...\n\n\n8\nWOS:001314268600001\n10\næœ¬ç ”ç©¶è®¾è®¡äº†ä¸€ç§ç”¨äºä¿ƒè¿›æ±¡æŸ“åœ°å—å°éº¦ç”Ÿé•¿çš„åˆæˆå¾®ç”Ÿç‰©ç¾¤è½ï¼Œå¹¶ä½¿ç”¨äº†åŸºå› ç»„è§„æ¨¡ä»£è°¢æ¨¡å‹ã€‚è¿™å®Œå…¨...\n\n\n9\nWOS:001313702300001\n0\nè¯¥ç ”ç©¶ä¸»è¦æ¢è®¨äº†å¤šé‡åº”æ¿€æºå¯¹æ·¡æ°´ç”Ÿæ€ç³»ç»Ÿçš„å½±å“ï¼Œè€Œæ²¡æœ‰æ¶‰åŠåˆæˆèŒç¾¤çš„æ¦‚å¿µæˆ–åº”ç”¨ã€‚å› æ­¤ï¼Œä¸åˆæˆ...\n\n\n10\nWOS:001320306700001\n8\nè™½ç„¶ä¸»è¦ç ”ç©¶å¯¹è±¡æ˜¯å¡‘æ–™é™è§£ï¼Œä½†ä½¿ç”¨äº†å¾®è—»ï¼Œè¿™ç¬¦åˆåˆæˆèŒç¾¤çš„å®šä¹‰ï¼Œå³åˆ©ç”¨å¤šä¸ªå¾®ç”Ÿç‰©ç»„æˆçš„å¤åˆç‰©...\n\n\n11\nWOS:001319961700001\n10\nç ”ç©¶é›†ä¸­åœ¨ä»è•ƒèŒ„æ ¹é™…åœŸå£¤ä¸­åˆ†ç¦»å’Œè¯„ä»·ä¿ƒè¿›æ¤ç‰©ç”Ÿé•¿çš„æ ¹é™…ç»†èŒï¼Œè¿™å®Œå…¨ç¬¦åˆåˆæˆèŒç¾¤çš„ç ”ç©¶ã€‚\n\n\n12\nWOS:001318177900001\n10\nç ”ç©¶æ¢è®¨äº†è—»ç±»-ç»†èŒå…±ç”Ÿç³»ç»Ÿç”¨äºæ±¡æŸ“ç‰©å»é™¤ï¼Œæ¶‰åŠå¤šä¸ªå¾®ç”Ÿç‰©ç»„æˆçš„å¤åˆç‰©å’Œå…¶ä»£è°¢ä¼˜åŠ¿ï¼Œå®Œå…¨ç¬¦åˆ...\n\n\n13\nWOS:001318328600001\n6\nç ”ç©¶è™½ç„¶æ¶‰åŠæ±¡æ°´å¤„ç†å’Œç»†èŒç¾¤è½ç»“æ„åˆ†æï¼Œä½†ä¸»è¦é›†ä¸­åœ¨åŒ–å­¦å¤„ç†æ–¹æ³•ä¸Šï¼ŒåˆæˆèŒç¾¤çš„å‚ä¸ç¨‹åº¦ä¸­ç­‰ã€‚\n\n\n14\nWOS:001317596600001\n3\nä¸»è¦èšç„¦äºæŠ—èŒè‚½åŠå…¶åˆæˆç±»ä¼¼ç‰©ä½œä¸ºæŠ—ç”Ÿç´ æ›¿ä»£å“çš„å¼€å‘ï¼Œä¸åˆæˆèŒç¾¤å…³ç³»è¾ƒå¼±ã€‚\n\n\n15\nWOS:001291429900001\n8\nè¿™ç¯‡æ–‡ç« ç ”ç©¶äº†å°†ä¹³ç‰›åºŸæ°´ä¸æ°´æœå’Œè”¬èœæ®‹æ¸£è¿›è¡ŒåŒæ°§å…±æ¶ˆåŒ–çš„æ•ˆæœï¼Œå¹¶åˆ©ç”¨ç”Ÿæˆçš„ç”Ÿç‰©è‚¥æ–™ï¼Œè¿™ç›´æ¥æ¶‰...\n\n\n16\nWOS:001319156200001\n7\nè¿™ç¯‡æ–‡ç« ç ”ç©¶äº†å›ºæ°®è“è—»å‡å°‘æ°´ç¨»ä¸­é•‰æ¯’æ€§å’Œé•‰ç´¯ç§¯çš„é—®é¢˜ï¼Œæ¶‰åŠåˆ°è“è—»ä½œä¸ºç”Ÿç‰©è‚¥æ–™å’Œé‡é‡‘å±å¸é™„å‰‚çš„...\n\n\n17\nWOS:001307986400001\n6\nè¿™ç¯‡æ–‡ç« åœ¨åˆæˆç¯å¢ƒä¸­ç ”ç©¶äº†å¾®ç”Ÿç‰©ç¤¾åŒºç»„æˆçš„å˜åŒ–ï¼Œæ¶‰åŠåˆ°å¤šç§å¾®ç”Ÿç‰©åœ¨å…±åŒä»£è°¢ç³»ç»Ÿä¸­çš„ç›¸äº’ä½œç”¨å’Œ...\n\n\n18\nWOS:001319855200001\n9\nè¿™ç¯‡æ–‡ç« ç ”ç©¶äº†Paenibacillus polymyxa J2-4å’ŒPseudomonas...\n\n\n19\nWOS:001314605300007\n10\næœ¬ç ”ç©¶é€šè¿‡åŸºå› ç»„å­¦å’Œåˆæˆç¤¾åŒºå®éªŒæ­ç¤ºäº†é†‹é…¸ç»†èŒåœ¨é…µæ¯å‘é…µä¸­çš„å…³é”®ä»£è°¢ä½œç”¨ï¼Œç›´æ¥æ¶‰åŠåˆ›å»ºå’Œæ“æ§...",
    "crumbs": [
      "<span class='chapter-number'>15</span>Â  <span class='chapter-title'>ç ”ç©¶æ¦‚è¦</span>"
    ]
  },
  {
    "objectID": "llama.html",
    "href": "llama.html",
    "title": "16Â  Llama 3.2",
    "section": "",
    "text": "16.1 æœ¬åœ°åŒ–éƒ¨ç½²",
    "crumbs": [
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>Llama 3.2</span>"
    ]
  },
  {
    "objectID": "llama.html#æœ¬åœ°åŒ–éƒ¨ç½²",
    "href": "llama.html#æœ¬åœ°åŒ–éƒ¨ç½²",
    "title": "16Â  Llama 3.2",
    "section": "",
    "text": "16.1.1 ä½¿ç”¨ Ollama æœ¬åœ°åŒ–éƒ¨ç½²\nä½¿ç”¨ ollama éƒ¨ç½² LLaMA æ¨¡å‹ç›¸å¯¹ç®€å•ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥å¿«é€Ÿè¿è¡Œ LLaMA ç³»åˆ—æ¨¡å‹ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æ­¥éª¤ï¼š\n1. å®‰è£… Ollama\né¦–å…ˆï¼Œä½ éœ€è¦åœ¨æœ¬åœ°å®‰è£… ollama å·¥å…·ã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ­¥éª¤ï¼š\n\nmacOS ç”¨æˆ·å¯ä»¥ç›´æ¥ä½¿ç”¨ brew å®‰è£…ï¼š\n\nbrew install ollama\n# æŸ¥çœ‹å¸®åŠ©\nollama --help\n\nWindows å’Œ Linux ç”¨æˆ·å¯ä»¥è®¿é—® Ollama çš„å®˜ç½‘ ä¸‹è½½ç›¸åº”çš„å®‰è£…åŒ…ã€‚\n\n2. åŠ è½½ LLaMA æ¨¡å‹\nå®‰è£…å®Œæˆåï¼Œä½ å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œç›´æ¥è¿è¡Œ LLaMA æ¨¡å‹ã€‚Ollama ä¼šåœ¨é¦–æ¬¡è¿è¡Œæ—¶ä¸‹è½½æ¨¡å‹ã€‚\nollama run llama3.2:1b\nè¿™æ˜¯è¿è¡Œ LLaMA 2 çš„ç¤ºä¾‹ï¼Œä½ å¯ä»¥æ ¹æ®éœ€æ±‚æ›¿æ¢ä¸ºå…¶ä»–ç‰ˆæœ¬çš„ LLaMA æ¨¡å‹ï¼ˆå¦‚ LLaMA 3ï¼‰ã€‚Ollama æä¾›äº†ä¸€äº›é»˜è®¤æ¨¡å‹åï¼Œå…·ä½“å¯ä»¥é€šè¿‡ ollama çš„æ–‡æ¡£æˆ–å‘½ä»¤è¡ŒæŸ¥çœ‹ã€‚\n3. æŸ¥è¯¢æ”¯æŒçš„æ¨¡å‹\nä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥çœ‹ ollama æœ¬åœ°å¯ç”¨çš„æ¨¡å‹åˆ—è¡¨ã€‚è®¿é—® https://ollama.com/library æŸ¥çœ‹æ‰€æœ‰æ¨¡å‹ï¼š\nollama list\n4. æœ¬åœ°æ¨¡å‹éƒ¨ç½²\nOllama ä¸»è¦é’ˆå¯¹æœ¬åœ°éƒ¨ç½²ï¼Œå› æ­¤å®ƒä¼šåœ¨é¦–æ¬¡è¿è¡Œæ¨¡å‹æ—¶è‡ªåŠ¨å°†æ‰€éœ€çš„æ¨¡å‹æƒé‡ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå¹¶é€šè¿‡æœ¬åœ°ç¡¬ä»¶ï¼ˆå¦‚ CPU æˆ– GPUï¼‰åŠ é€Ÿæ¨ç†ã€‚\n# æŸ¥çœ‹æ¨¡å‹\nollama list\n\n# è¿è¡Œæ¨¡å‹\nollama run llama3.2:1b \"Hi, who are you?\"\nollama run llama3.2:3b \"Hi, who are you?\"\nollama run llama3.1:8b 'Hi, who are you?'\n5. ä½¿ç”¨ Ollama API\nå¦‚æœä½ æƒ³é€šè¿‡ä»£ç æ¥è°ƒç”¨ Ollama æä¾›çš„ LLaMA æ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨å®ƒçš„ APIã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªç®€å•çš„ Python ç¤ºä¾‹ï¼š\n\nimport requests\n\nresponse = requests.post(\n    \"http://localhost:11434/api/generate\",\n    json={\"model\": \"llama3.1:8b\", \"prompt\": \"Hi, who are you?\", \"stream\": False}\n)\n\nprint(response.content.decode())\n\n{\"model\":\"llama3.1:8b\",\"created_at\":\"2024-10-15T07:29:47.257886Z\",\"response\":\"I'm an artificial intelligence model known as Llama. Llama stands for \\\"Large Language Model Meta AI.\\\"\",\"done\":true,\"done_reason\":\"stop\",\"context\":[128006,882,128007,271,13347,11,889,527,499,30,128009,128006,78191,128007,271,40,2846,459,21075,11478,1646,3967,439,445,81101,13,445,81101,13656,369,330,35353,11688,5008,16197,15592,1210],\"total_duration\":3170882792,\"load_duration\":46793334,\"prompt_eval_count\":16,\"prompt_eval_duration\":2294743000,\"eval_count\":23,\"eval_duration\":828374000}\n\n\nè¿™ä¸ªç¤ºä¾‹ä¸­ï¼ŒOllama çš„ API ä¼šåœ¨æœ¬åœ°è¿è¡Œï¼Œå¹¶ä¸”ä½ å¯ä»¥é€šè¿‡ HTTP è¯·æ±‚å‘å®ƒå‘é€æ¨ç†ä»»åŠ¡ã€‚\n6. æŸ¥çœ‹è¿è¡ŒçŠ¶æ€\n# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€\nollama ps\n\n# åœæ­¢æ¨¡å‹\nollama stop llama3.1:8b\n\n\n16.1.2 Hugging Face æœ¬åœ°åŒ–éƒ¨ç½²\nä½¿ç”¨ Hugging Face æœ¬åœ°åŒ–éƒ¨ç½² LLaMA 3 æ¨¡å‹ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®ç°ã€‚å‡è®¾ä½ å·²ç»äº†è§£å¦‚ä½•å®‰è£…å¿…è¦çš„è½¯ä»¶ç¯å¢ƒå’Œä¾èµ–åŒ…ã€‚\n1. ç¡®è®¤ç³»ç»Ÿé…ç½®\nLLaMA 3 æ˜¯ä¸€ä¸ªå¤§å‹æ¨¡å‹ï¼Œé€šå¸¸éœ€è¦é«˜æ€§èƒ½çš„ç¡¬ä»¶ï¼ŒåŒ…æ‹¬è‡³å°‘ 24GB æ˜¾å­˜çš„ GPU å’Œè¶³å¤Ÿçš„ CPU å†…å­˜ã€‚\n2. å®‰è£…ä¾èµ–åŒ…\nç¡®ä¿ä½ å®‰è£…äº† Hugging Face Transformers åº“å’Œ Accelerate åº“æ¥è¿›è¡Œæ¨¡å‹çš„åŠ è½½å’ŒåŠ é€Ÿï¼š\npip install transformers accelerate\n3. è·å– Hugging Face Access Token\nç”±äº LLaMA 3 æ˜¯ Meta çš„å—é™æ¨¡å‹ï¼Œä½ éœ€è¦è®¿é—® Hugging Face ä¸Šçš„ç›¸åº”é¡µé¢ï¼Œå¹¶é€šè¿‡è¯·æ±‚è®¿é—®æƒé™ã€‚è·å–åï¼Œå°† huggingface-cli é…ç½®å¥½ä½ çš„ä»¤ç‰Œï¼š\nhuggingface-cli login\n4. åŠ è½½æ¨¡å‹\nä¸€æ—¦ä½ æœ‰äº†è®¿é—®æƒé™ï¼Œå¯ä»¥ä½¿ç”¨ Hugging Face çš„ Transformers åº“æ¥åŠ è½½æ¨¡å‹å¹¶è¿è¡Œå®ƒã€‚\nNote: åœ¨æ¨¡å‹ä¸»é¡µæäº¤è®¿é—®è¯·æ±‚ï¼Œç­‰å¾…æ‰¹å‡†ã€‚\nfrom transformers import AutoTokenizer, AutoModelForCausalLM\nfrom IPython.display import Markdown\n\n# åŠ è½½ LLaMA 3 æ¨¡å‹\nmodel_name = \"meta-llama/Llama-3.2-1b\"  # æ¨¡å‹åç§°æ ¹æ®å…·ä½“éœ€æ±‚æ›¿æ¢\ntokenizer = AutoTokenizer.from_pretrained(model_name)\nmodel = AutoModelForCausalLM.from_pretrained(model_name, device_map=\"auto\")\n\n# æ¨ç†\ninputs = tokenizer(\"hi, who are you?\", return_tensors=\"pt\").to(\"mps\")\noutputs = model.generate(inputs.input_ids, max_length=50)\nprint(tokenizer.decode(outputs[0], skip_special_tokens=True))\n5. ä½¿ç”¨ Accelerate åŠ é€Ÿæ¨ç†\nå¦‚æœæ¨¡å‹éå¸¸å¤§ï¼Œå¯èƒ½éœ€è¦åˆ©ç”¨ Accelerate åº“æ¥å¤„ç†å¤š GPU æˆ– TPU çš„ç¯å¢ƒåŠ é€Ÿæ¨ç†ã€‚\nfrom accelerate import init_empty_weights, infer_auto_device_map\nfrom transformers import AutoModelForCausalLM, AutoTokenizer\n\n# åˆå§‹åŒ–ç©ºæ¨¡å‹\nwith init_empty_weights():\n    model = AutoModelForCausalLM.from_pretrained(model_name)\n\n# æ¨æ–­è‡ªåŠ¨è®¾å¤‡æ˜ å°„\ndevice_map = infer_auto_device_map(model, max_memory={0: \"24GB\", 1: \"24GB\"})\n\n# ä½¿ç”¨è®¾å¤‡æ˜ å°„åŠ è½½æ¨¡å‹\nmodel = AutoModelForCausalLM.from_pretrained(model_name, device_map=device_map)\n6. æœ¬åœ°åŒ–æ¨¡å‹æƒé‡ï¼ˆå¯é€‰ï¼‰\nå¦‚æœéœ€è¦å°†æ¨¡å‹æƒé‡å®Œå…¨ä¸‹è½½åˆ°æœ¬åœ°è¿›è¡Œè„±æœºæ¨ç†ï¼Œå¯ä»¥æŒ‡å®šç¼“å­˜è·¯å¾„ï¼š\nmodel = AutoModelForCausalLM.from_pretrained(model_name, cache_dir=\"./local_model\")\ntokenizer = AutoTokenizer.from_pretrained(model_name, cache_dir=\"./local_model\")\nè¿™å°†æ¨¡å‹çš„æ‰€æœ‰æ–‡ä»¶ä¸‹è½½åˆ° ./local_model æ–‡ä»¶å¤¹ä¸­ã€‚\n7. æ¨ç†ä¸è°ƒæ•´\nä½¿ç”¨ generate æ–¹æ³•è¿›è¡Œæ–‡æœ¬ç”Ÿæˆï¼Œä½ å¯ä»¥æ ¹æ®ä»»åŠ¡éœ€æ±‚ï¼Œè°ƒæ•´ max_lengthã€temperatureã€top_p ç­‰ç”Ÿæˆå‚æ•°ï¼š\noutputs = model.generate(\n    inputs.input_ids, \n    max_length=100, \n    num_return_sequences=1, \n    temperature=0.7, \n    top_p=0.9\n)\nè¿™æ ·ä½ å°±å¯ä»¥å®ç° Hugging Face æœ¬åœ°åŒ–éƒ¨ç½² LLaMA 3 æ¨¡å‹è¿›è¡Œæ¨ç†äº†ã€‚\n\n\n16.1.3 ä½¿ç”¨ vllm æœ¬åœ°åŒ–éƒ¨ç½²\nvLLM æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„å¤§è¯­è¨€æ¨¡å‹æ¨ç†å’ŒæœåŠ¡æ¡†æ¶ã€‚å®ƒå¯ä»¥æ˜¾è‘—æé«˜ LLaMA ç­‰æ¨¡å‹çš„æ¨ç†é€Ÿåº¦ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ vLLM æœ¬åœ°éƒ¨ç½² LLaMA 3.1 8B æ¨¡å‹çš„æ­¥éª¤ï¼š\n\nå®‰è£… vLLMï¼š\n\npip install vllm\n\nä¸‹è½½è¿è¡Œ LLaMA 3.2 1B æ¨¡å‹ï¼š\n\nvllm serve meta-llama/Meta-Llama-3.2-1B\n\nä½¿ç”¨ vLLM APIï¼ˆå¯é€‰ï¼‰ï¼š\n\nimport requests\n\nresponse = requests.post(\n    \"http://localhost:8000/v1/chat/completions\",\n    json={\"model\": \"meta-llama/Meta-Llama-3.2-1B\", \n          \"messages\": [{\"role\": \"user\", \"content\": \"Hello, who are you?\"}], \n          \"stream\": False}\n)\n\nprint(response.content.decode())\n\n\n16.1.4 æ€»ç»“\nä½¿ç”¨ ollama éƒ¨ç½² LLaMA æ¨¡å‹ï¼Œé€Ÿåº¦å¿«ï¼Œé…ç½®ç®€å•ï¼Œé€‚åˆå¿«é€Ÿéƒ¨ç½²å’Œæµ‹è¯•ã€‚\nåœ¨æ‹¥æœ‰ 18 G å†…å­˜çš„ MacBook Pro ä¸Šï¼Œè¿è¡Œ LLaMA 3.2 1B æ¨¡å‹ï¼Œé€Ÿåº¦éå¸¸å¿«ï¼Œå‡ ä¹ç§’å‡ºç»“æœï¼›è¿è¡Œ LLaMA 3.2 3B æ¨¡å‹ï¼Œé€Ÿåº¦ä¹Ÿéå¸¸å¿«ï¼›è¿è¡Œ LLaMA 3.1 8B æ¨¡å‹ï¼Œé€Ÿåº¦éå¸¸å¿«ï¼›è€Œè¿è¡Œ LLaMA 3.1 70B æ¨¡å‹ï¼Œé€Ÿåº¦å¾ˆæ…¢ã€‚",
    "crumbs": [
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>Llama 3.2</span>"
    ]
  },
  {
    "objectID": "llama.html#ä»»åŠ¡æ€§èƒ½è¯„ä¼°",
    "href": "llama.html#ä»»åŠ¡æ€§èƒ½è¯„ä¼°",
    "title": "16Â  Llama 3.2",
    "section": "16.2 ä»»åŠ¡æ€§èƒ½è¯„ä¼°",
    "text": "16.2 ä»»åŠ¡æ€§èƒ½è¯„ä¼°\n\n16.2.1 å¯åŠ¨ API æœåŠ¡\nollama run llama3.1:8b --format=json\n\n\n16.2.2 è¯»å–æ–‡ä»¶\n\nimport pandas as pd\n\n# è¯»å–CSVæ–‡ä»¶ä¸­çš„æ ‡é¢˜å’Œæ‘˜è¦\nfile = \"example/wos-fast5k/savedrecs.txt\"\n    \n# æ ¹æ®æ–‡ä»¶çš„åˆ†éš”ç¬¦ä¿®æ”¹ delimiter å‚æ•°\n# è®¾ç½® index_col=False æ¥ç¡®ä¿ç¬¬ä¸€åˆ—ä¸ä¼šè¢«å½“ä½œè¡Œç´¢å¼•\ndata = pd.read_csv(file, delimiter='\\t', index_col=False)  \n\n# åˆ é™¤å…¨ä¸º NaN çš„åˆ—\ndata = data.loc[:, data.notna().sum() != 0]\n\n# æŸ¥çœ‹å¤„ç†åçš„æ•°æ®\nprint(data[0:5])\n\n  PT                                                 AU   BA   CA   GP  \\\n0  J  Just, Berta Singla; Marks, Evan Alexander Neth...  NaN  NaN  NaN   \n1  J  Pereira-Marques, Joana; Ferreira, Rui M.; Figu...  NaN  NaN  NaN   \n2  J  Golzar-Ahmadi, Mehdi; Bahaloo-Horeh, Nazanin; ...  NaN  NaN  NaN   \n3  J  Li, Chenglong; Han, Yanfeng; Zou, Xiao; Zhang,...  NaN  NaN  NaN   \n4  J  Hu, Yu; Wang, Yulin; Wang, Runhua; Wang, Xiaok...  NaN  NaN  NaN   \n\n                                                  TI  \\\n0  Biofertilization increases soil organic carbon...   \n1  A metatranscriptomics strategy for efficient c...   \n2  Pathway to industrial application of heterotro...   \n3  A systematic discussion and comparison of the ...   \n4  Dirammox-dominated microbial community for bio...   \n\n                                                  SO   VL   IS   BP  ...  \\\n0  INTERNATIONAL JOURNAL OF AGRICULTURAL SUSTAINA...   22    1  NaN  ...   \n1                                       GUT MICROBES   16    1  NaN  ...   \n2                             BIOTECHNOLOGY ADVANCES   77  NaN  NaN  ...   \n3                SYNTHETIC AND SYSTEMS BIOTECHNOLOGY    9    4  775  ...   \n4             APPLIED MICROBIOLOGY AND BIOTECHNOLOGY  108    1  NaN  ...   \n\n     PY                                                 AB  \\\n0  2024  Protecting and building soil carbon has become...   \n1  2024  The high background of host RNA poses a major ...   \n2  2024  The transition to renewable energies and elect...   \n3  2024  Synthetic microbial community has widely conce...   \n4  2024  Direct ammonia oxidation (Dirammox) might be o...   \n\n                                                  C1   CT   CY   SP   CL TC  \\\n0  [Just, Berta Singla; Llenas, Laia; Ponsa, Serg...  NaN  NaN  NaN  NaN  0   \n1  [Pereira-Marques, Joana; Ferreira, Rui M.; Fig...  NaN  NaN  NaN  NaN  2   \n2  [Golzar-Ahmadi, Mehdi; Norouzi, Forough; Holus...  NaN  NaN  NaN  NaN  0   \n3  [Li, Chenglong; Han, Yanfeng; Zou, Xiao; Zhang...  NaN  NaN  NaN  NaN  0   \n4  [Hu, Yu; Wang, Yulin; Liu, Shuang-Jiang] Shand...  NaN  NaN  NaN  NaN  0   \n\n                                                  WC                   UT  \n0  Agriculture, Multidisciplinary; Green & Sustai...  WOS:001247571700001  \n1        Gastroenterology & Hepatology; Microbiology  WOS:001176335800001  \n2               Biotechnology & Applied Microbiology  WOS:001316252000001  \n3               Biotechnology & Applied Microbiology  WOS:001273513000001  \n4               Biotechnology & Applied Microbiology  WOS:001252334300001  \n\n[5 rows x 24 columns]\n\n\nä¸‹é¢ï¼Œå°† dataframe ä¸­çš„æ•°æ®é€æ‰¹å¤„ç†ï¼Œç”Ÿæˆ JSON æ ¼å¼çš„æ–‡æœ¬ã€‚\n\nbatch_to_json()ï¼šè¿™æ˜¯å‡½æ•°çš„ä¸»ä½“ï¼Œå°†æ•°æ®æŒ‰æ‰¹æ¬¡è¿›è¡Œå¤„ç†ï¼Œå¹¶å°†æ¯è¡Œæ•°æ®è½¬åŒ–ä¸º JSON æ ¼å¼ã€‚\næ‰¹æ¬¡åˆ‡åˆ†ï¼šä½¿ç”¨ data[i:i+batch_size] å¯¹ DataFrame è¿›è¡Œåˆ†æ‰¹å¤„ç†ã€‚\næ„å»º JSONï¼šæ¯è¡Œæ•°æ®æå–å‡º UTã€TIã€AB åˆ—çš„å€¼ï¼Œå¹¶æ„å»ºä¸€ä¸ªåŒ…å« idã€ti å’Œ ab é”®çš„ JSON å¯¹è±¡ã€‚\njson.dumps()ï¼šå°†åˆ—è¡¨å½¢å¼çš„ JSON å¯¹è±¡è½¬æ¢ä¸º JSON å­—ç¬¦ä¸²ã€‚\nensure_ascii=Falseï¼šç¡®ä¿è¾“å‡ºçš„ JSON å­—ç¬¦ä¸²æ”¯æŒé ASCII å­—ç¬¦ã€‚\n\n\nimport pandas as pd\nimport json\nfrom IPython.display import Markdown\n\ndef batch_to_json(data, batch_size):\n    # ç¡®ä¿è¾“å…¥çš„ data æ˜¯ä¸€ä¸ª DataFrameï¼Œä¸” batch_size æ˜¯æ­£æ•´æ•°\n    if not isinstance(data, pd.DataFrame):\n        raise ValueError(\"data åº”è¯¥æ˜¯ä¸€ä¸ª pandas DataFrame\")\n    if not isinstance(batch_size, int) or batch_size &lt;= 0:\n        raise ValueError(\"batch_size åº”è¯¥æ˜¯ä¸€ä¸ªæ­£æ•´æ•°\")\n    \n    # æå– dataframe ä¸­çš„æ¯ batch_size è¡Œæ•°æ®\n    batches = [data[i:i+batch_size] for i in range(0, len(data), batch_size)]\n    \n    result = []\n    for batch in batches:\n        json_batch = []\n        for _, row in batch.iterrows():\n            # æ„å»ºæ¯è¡Œçš„ JSON å¯¹è±¡\n            json_obj = {\n                \"ID\": row[\"UT\"],\n                \"TI\": row[\"TI\"],\n                \"AB\": row[\"AB\"]\n            }\n            json_batch.append(json_obj)\n        result.append(json.dumps(json_batch, ensure_ascii=False))  # è½¬æ¢ä¸º JSON æ ¼å¼çš„å­—ç¬¦ä¸²\n    return result\n\n# ç¤ºä¾‹ä½¿ç”¨\nbatch_size = 2\njson_output = batch_to_json(data[0:1], batch_size)\n\nfrom pprint import pprint\npprint(json_output)\n\n['[{\"ID\": \"WOS:001247571700001\", \"TI\": \"Biofertilization increases soil '\n 'organic carbon concentrations: results of a meta-analysis\", \"AB\": '\n '\"Protecting and building soil carbon has become a global policy priority, '\n 'and novel agronomic fertilization practices may contribute to soil '\n 'protection and climate-smart agriculture. The application of microbial '\n 'inoculants (biofertilizers) is considered beneficial for soil and climate '\n '-smart agriculture. Therefore, an exhaustive meta-analysis of '\n 'biofertilization studies was carried out worldwide to quantify the benefits '\n 'of microbial inoculants on SOC concentration. Based on 59 studies and 267 '\n 'observations, was found that biofertilizers significantly increased SOC '\n 'concentration by an average of 0.44 g C kg-1 soil. All biofertilizer types '\n 'were estimated to contribute positively to SOC (0.18-0.70 g C kg-1soil), but '\n 'only cyanobacteria, mixtures of organisms, mycorrhizal fungi, and nitrogen '\n 'fixers were statistically significant. In terms of crop type, results were '\n 'significant and positive for cereals, fruits, legumes and root/tuber crops '\n '(0.44-0.82 g C kg-1soil). A significant positive linear relationship was '\n 'observed between crop yield and SOC changes, supporting the notion that '\n 'greater productivity helps explain SOC increases, accounting for 7% of the '\n 'dataset variability. This study provides the first evidence from a global '\n 'assessment that biofertilizer use is associated with an augmented '\n 'terrestrial agricultural organic carbon sink contributing to soil protection '\n 'and food security where climate-smart solutions are sought.\"}]']\n\n\n\n\n16.2.3 è°ƒæ•´æç¤ºè¯\nNote: å°†æç¤ºè¯æ¢æˆè‹±æ–‡æ•ˆæœå¯èƒ½ä¼šæ›´å¥½ã€‚\nNote: JSON æ ¼å¼è¦æ±‚é”®å€¼å¯¹å¿…é¡»ç”¨åŒå¼•å·ã€‚\n\n# ä½¿ç”¨ä¸‰å¼•å·æ’å…¥ä¸€ä¸ªéå¸¸é•¿çš„ç³»ç»Ÿæç¤ºç¬¦\nsystem_prompt = \"\"\"  \nPlease identify the relevance of each article's research topic to **synthetic microbial community** research based on the following content, and provide a score (0 for completely irrelevant, 10 for highly relevant, 1-9 for partially relevant):\n\nPlease note:\n\n1. A synthetic microbial community refers to a composite of one or more microorganisms created by humans. It can be a probiotic, a biofertilizer, or a small microbial community. All research related to these topics should be considered relevant to synthetic microbial community research.\n2. The subsequent content will be provided in JSON format, including the article's ID, title (TI), and abstract (AB). Please make your judgment based on the title and abstract content, and record the ID for your response.\n3. Be sure to follow the response requirements below.\n\nResponse requirements:\n\n1. In your response, please provide the article's ID, score, and a brief reason.\n2. Please use the JSON format for your response, for example:\n\n{\"results\": [{\"ID\":\"string\", \"score\":number, \"reason\": \"string\"}]}\n\n\"\"\"\n\nè¦ä½¿ OpenAI API è°ƒç”¨çš„ç»“æœä»¥ç»Ÿä¸€çš„ JSON æ ¼å¼è¿”å›ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œè®¾ç½®ï¼š\n\nimport requests\nimport json\n\ndef analyze_content(content):\n  messages = [\n      {\"role\": \"system\", \"content\": system_prompt}\n  ]\n  \n  messages.append({\"role\": \"user\", \"content\": content})\n\n  response = requests.post(\n      \"http://localhost:11434/v1/chat/completions\",\n      json={\n          \"model\": \"llama3.1:8b\",\n          \"messages\": messages,\n          \"stream\": False\n      }\n  )\n  # å°†APIå“åº”è§£æä¸ºJSONæ ¼å¼\n  response_data = response.json()\n  content_str = response_data['choices'][0]['message']['content']\n  # ä» content_str ä¸­æå– JSON æ ¼å¼çš„æ–‡æœ¬\n  json_start = content_str.find(\"{\")\n  json_end = content_str.rfind(\"}\") + 1\n  json_str = content_str[json_start:json_end]\n\n  try:\n      content_dict = json.loads(json_str)\n  except json.JSONDecodeError:\n      print(f\"è­¦å‘Š: è¿”å›çš„å†…å®¹ä¸åŒ…å«æœ‰æ•ˆçš„ JSON æ•°æ®ã€‚å†…å®¹ä¸º: {content_str}\")\n      content_dict = {\"results\": []}\n  \n  # å¦‚æœå«æœ‰ results é”®ï¼Œåˆ™è¿”å› results é”®å¯¹åº”çš„å€¼\n  if 'results' in content_dict:\n      result = content_dict['results']\n  else:\n      print(f\"è­¦å‘Š: è¿”å›çš„JSON å†…å®¹ä¸åŒ…å«æœ‰æ•ˆçš„ 'results' é”®ã€‚å†…å®¹ä¸º: {json_str}\")\n      result = []\n\n  return result\n\ntest_output = analyze_content(json_output[0])\npprint(test_output)\n\n[{'ID': 'WOS:001247571700001',\n  'reason': 'The article discusses the benefits of biofertilization on soil '\n            'organic carbon concentrations and its contribution to '\n            'climate-smart agriculture, which is relevant to synthetic '\n            'microbial community research as it involves a specific type of '\n            'microbe (microbial inoculants) used for agricultural purposes.',\n  'score': 9}]\n\n\n\n\n16.2.4 æ‰¹å¤„ç†\nç°åœ¨å¯ä»¥è¿›è¡Œæ‰¹å¤„ç†ï¼Œå¹¶å°†ç»“æœä¿å­˜ä¸‹æ¥ã€‚\n\nbatches = batch_to_json(data[0:20], batch_size=1)\n\nresults = []\n\nimport time\n\nstart_time = time.time()\n\nfrom tqdm import tqdm\n\nfor batch in tqdm(batches):\n  result = analyze_content(batch)\n  results.append(result)\n\nend_time = time.time()\nexecution_time = end_time - start_time\nprint(f\"æ‰¹å¤„ç†æ‰§è¡Œæ—¶é—´: {execution_time:.2f} ç§’\")\n\næ‰¹å¤„ç†æ‰§è¡Œæ—¶é—´: 88.28 ç§’\n\n\nå°†åˆ—è¡¨åˆå¹¶æˆä¸€ä¸ªæ•°æ®æ¡†ï¼Œå¹¶ä¿å­˜åˆ°ç¡¬ç›˜ä¸­ä¾›åç»­åˆ†æä½¿ç”¨ã€‚\n\nimport json\n\ndata_list = []\n\nfor result in results:\n  # å¦‚æœ result ä¸æ˜¯ç©ºåˆ—è¡¨\n  if result:\n    for item in result:\n      # ç¡®ä¿æœ‰ ID é”®ã€score é”®ã€reason é”®\n      if 'ID' in item and 'score' in item and 'reason' in item:\n        data_list.append([item['ID'], item['score'], item['reason']])\n\ndf = pd.DataFrame(data_list, columns=['ID', 'score', 'reason'])\n\ndf\n# df.to_csv('output.csv', index=False)\n\n\n\n\n\n\n\n\nID\nscore\nreason\n\n\n\n\n0\nWOS:001247571700001\n8.0\nThe article discusses the use of biofertilizer...\n\n\n1\nWOS:001176335800001\n8.5\nThe article discusses a metatranscriptomics st...\n\n\n2\nWOS:001316252000001\n8.0\nThe article discusses using heterotrophic micr...\n\n\n3\nWOS:001273513000001\n10.0\nThe article's title directly mentions 'synthet...\n\n\n4\nWOS:001252334300001\n8.0\nThe study involves creating a synthetic microb...\n\n\n5\nWOS:001209713100001\n8.0\nThe article discusses microalgal biofuels, lip...\n\n\n6\nWOS:001198552100002\n9.0\nThe article discusses various methods to study...\n\n\n7\nWOS:001171546000001\n10.0\nThe article discusses the construction of a sy...\n\n\n8\nWOS:001314268600001\n10.0\nThe article explores the use of synthetic micr...\n\n\n9\nWOS:001313702300001\n0.0\nThis article's research topic is related to th...\n\n\n10\nWOS:001320306700001\n5.0\nThe research topic focuses on using microalgae...\n\n\n11\nWOS:001319961700001\n10.0\nThe research topic directly relates to synthet...\n\n\n12\nWOS:001318177900001\n10.0\nThe research topic is directly related to synt...\n\n\n13\nWOS:001318328600001\n6.0\nWhile this article is about textile printing w...\n\n\n14\nWOS:001317596600001\n4.0\nThe article discusses cationic antimicrobial p...\n\n\n15\nWOS:001291429900001\n10.0\nThis article investigates the effects of anaer...\n\n\n16\nWOS:001319156200001\n6.0\nThe article discusses a nitrogen-fixing cyanob...\n\n\n17\nWOS:001307986400001\n9.0\nThe article discusses synthetic microbial comm...\n\n\n18\nWOS:001319855200001\n8.0\nThe article discusses the use of Paenibacillus...\n\n\n19\nWOS:001314605300007\n8.0\nThe article discusses the role of acetic acid ...",
    "crumbs": [
      "<span class='chapter-number'>16</span>Â  <span class='chapter-title'>Llama 3.2</span>"
    ]
  },
  {
    "objectID": "batch-async-task.html",
    "href": "batch-async-task.html",
    "title": "17Â  æ‰¹é‡å¼‚æ­¥ä»»åŠ¡",
    "section": "",
    "text": "17.1 è·Ÿè¸ªè¿›åº¦\nåœ¨ R ä¸­ï¼Œapply å‡½æ•°æœ¬èº«å¹¶ä¸æä¾›è¿›åº¦æ¡çš„åŠŸèƒ½ï¼Œä½†å¯ä»¥ç»“åˆ pbapply åŒ…æ¥å®ç°è¿›åº¦æ˜¾ç¤ºã€‚pbapply æ˜¯ apply å®¶æ—å‡½æ•°çš„å¢å¼ºç‰ˆï¼Œæ”¯æŒæ˜¾ç¤ºè¿›åº¦æ¡ã€‚",
    "crumbs": [
      "<span class='chapter-number'>17</span>Â  <span class='chapter-title'>æ‰¹é‡å¼‚æ­¥ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "batch-async-task.html#è·Ÿè¸ªè¿›åº¦",
    "href": "batch-async-task.html#è·Ÿè¸ªè¿›åº¦",
    "title": "17Â  æ‰¹é‡å¼‚æ­¥ä»»åŠ¡",
    "section": "",
    "text": "17.1.1 å®‰è£…å’Œä½¿ç”¨ pbapply åŒ…\n\nå®‰è£… pbapply åŒ…ï¼š\ninstall.packages(\"pbapply\")\nä½¿ç”¨ pbapply::pblapply() ä»£æ›¿ apply()ï¼š\npbapply åŒ…ä¸­çš„å‡½æ•°ä¸ apply ç³»åˆ—å‡½æ•°æ¥å£ç›¸åŒï¼Œåªæ˜¯å¤šäº†è¿›åº¦æ¡æ˜¾ç¤ºåŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ pblapply() å¤„ç†æ¯ä¸€è¡Œå¹¶æ˜¾ç¤ºè¿›åº¦ï¼š\n\nlibrary(pbapply)\n\n# åˆ›å»ºä¸€ä¸ªç¤ºä¾‹ data.frame\ndf = data.frame(a = 1:1000, b = rnorm(1000))\n\n# ä½¿ç”¨ pblapply æ˜¾ç¤º apply çš„è¿›åº¦\nresult = pbapply(df, 1, function(row) {\n  Sys.sleep(0.01)  # æ¨¡æ‹Ÿä¸€äº›éœ€è¦æ—¶é—´çš„è®¡ç®—\n  sum(row)         # è®¡ç®—æ¯ä¸€è¡Œçš„å’Œ\n})\n\n\n\n\n17.1.2 pbapply åŒ…ä¸­çš„å…¶ä»–å¸¸ç”¨å‡½æ•°ï¼š\n\npblapply()ï¼šç”¨äº lapply ç±»çš„æ“ä½œã€‚\npbapply()ï¼šç”¨äº apply ç±»æ“ä½œï¼ˆä¸ apply() ç±»ä¼¼ï¼‰ã€‚\npbmclapply()ï¼šç”¨äºå¹¶è¡ŒåŒ– lapply æ“ä½œï¼ˆä»…é€‚ç”¨äº UNIX-like ç³»ç»Ÿï¼‰ã€‚\n\né€šè¿‡è¿™ç§æ–¹æ³•ï¼Œä½ å¯ä»¥æ–¹ä¾¿åœ°åœ¨ R ä¸­æ˜¾ç¤º apply æ‰§è¡Œçš„è¿›åº¦ï¼Œå°¤å…¶é€‚ç”¨äºå¤„ç†å¤§å‹æ•°æ®é›†æ—¶è·Ÿè¸ªè®¡ç®—è¿›åº¦ã€‚",
    "crumbs": [
      "<span class='chapter-number'>17</span>Â  <span class='chapter-title'>æ‰¹é‡å¼‚æ­¥ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "batch-async-task.html#ç¼“å­˜",
    "href": "batch-async-task.html#ç¼“å­˜",
    "title": "17Â  æ‰¹é‡å¼‚æ­¥ä»»åŠ¡",
    "section": "17.2 ç¼“å­˜",
    "text": "17.2 ç¼“å­˜\nä¸ºäº†è‡ªåŠ¨ç¼“å­˜ pbapply çš„æ‰§è¡Œè¿›åº¦ï¼Œä½ å¯ä»¥ä½¿ç”¨ memoise åŒ…ï¼Œå®ƒèƒ½å°†å‡½æ•°çš„æ‰§è¡Œç»“æœè¿›è¡Œç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—ã€‚å®ƒå¯ä»¥ç¼“å­˜åˆ°å†…å®¹ã€æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€Google cloud storageã€AWS cloud storage ç­‰ã€‚ç»“åˆ pbapplyï¼Œä½ å¯ä»¥å°†æ¯æ¬¡å¤„ç†çš„ç»“æœç¼“å­˜èµ·æ¥ï¼Œä»¥ä¾¿ä¸‹æ¬¡è°ƒç”¨æ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å­˜çš„æ•°æ®ã€‚\n\n17.2.1 å®‰è£…å’Œä½¿ç”¨ memoise åŒ…\n\nå®‰è£… memoise åŒ…ï¼š\ninstall.packages(\"memoise\")\nå°†å¤„ç†å‡½æ•°ç¼“å­˜èµ·æ¥ï¼š\nä½¿ç”¨ memoise::memoise() å¯¹å‡½æ•°è¿›è¡Œç¼“å­˜å¤„ç†ã€‚è¿™æ ·ï¼Œpbapply åœ¨æ¯æ¬¡æ‰§è¡Œæ—¶ï¼Œéƒ½ä¼šæ£€æŸ¥æ˜¯å¦å·²ç»ç¼“å­˜è¿‡è¯¥ç»“æœã€‚\n\nlibrary(pbapply)\nlibrary(memoise)\n\n# ç¤ºä¾‹ï¼šå¯¹æ¯ä¸€è¡Œçš„è®¡ç®—è¿›è¡Œç¼“å­˜\nmy_function = function(row) {\n  Sys.sleep(0.01)  # æ¨¡æ‹Ÿä¸€äº›è€—æ—¶æ“ä½œ\n  sum(row)         # ç®€å•è®¡ç®—æ¯è¡Œçš„å’Œ\n}\n\n# å¯¹å‡½æ•°è¿›è¡Œç¼“å­˜\ncached_function = memoise(my_function)\n\nå®šä¹‰å¥½äº†ç¼“å­˜å‡½æ•°åï¼Œå°±å¯ä»¥ä½¿ç”¨ pbapply å¹¶ç»“åˆç¼“å­˜æ¥å¤„ç†æ•°æ®äº†ã€‚åœ¨ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œå‡½æ•°ä¼šæ‰§è¡Œå¹¶ç¼“å­˜ç»“æœã€‚åœ¨åç»­çš„è¿è¡Œä¸­ï¼Œå¦‚æœè¾“å…¥ç›¸åŒï¼Œå‡½æ•°ä¼šç›´æ¥ä»ç¼“å­˜ä¸­è¿”å›ç»“æœï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚\nä¸‹é¢æ˜¯ç¬¬ä¸€æ¬¡è¿è¡Œçš„ç»“æœï¼š\n\n# ä½¿ç”¨ pbapply å¹¶ç»“åˆç¼“å­˜\nset.seed(123)\ndf = data.frame(a = 1:1000, b = rnorm(1000))\nsystem.time(result &lt;- pbapply(df, 1, cached_function))\n\n   user  system elapsed \n  0.318   0.032  12.187 \n\n\nå†æ¬¡è¿è¡ŒåŒæ ·çš„ä»£ç ï¼Œç»“æœä¼šä»ç¼“å­˜ä¸­ç›´æ¥è¿”å›ï¼š\n\nset.seed(123)\ndf = data.frame(a = 1:1000, b = rnorm(1000))\nsystem.time(result &lt;- pbapply(df, 1, cached_function))\n\n   user  system elapsed \n  0.019   0.001   0.019 \n\n\nç¬¬äºŒæ¬¡è¿è¡Œæ—¶ï¼Œç”±äºç»“æœå·²ç»ç¼“å­˜ï¼Œæ‰€ä»¥é€Ÿåº¦æ›´å¿«ã€‚ä¸è¿‡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¼“å­˜åªå¯¹åŒä¸€ä¸ªå‡½æ•°æœ‰æ•ˆï¼Œå¦‚æœå‡½æ•°å®šä¹‰ä¸åŒï¼Œç¼“å­˜ä¸ä¼šç”Ÿæ•ˆã€‚é‡æ–°å®šä¹‰ç¼“å­˜å‡½æ•°åï¼Œå“ªæ€•å‡½æ•°çš„å†…éƒ¨é€»è¾‘å®Œå…¨ç›¸åŒï¼Œç¼“å­˜ä¹Ÿä¼šå¤±æ•ˆã€‚\n\n\n\n17.2.2 å·¥ä½œåŸç†ï¼š\n\nmemoise å°†å‡½æ•° my_function çš„ç»“æœç¼“å­˜èµ·æ¥ã€‚å½“ pbapply å†æ¬¡è°ƒç”¨è¯¥å‡½æ•°å¤„ç†ç›¸åŒçš„è¾“å…¥æ—¶ï¼Œç³»ç»Ÿä¼šç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–ç»“æœï¼Œè€Œä¸æ˜¯é‡æ–°æ‰§è¡Œã€‚\nå¯¹äºæ¯ä¸€è¡Œå¤„ç†çš„ç»“æœï¼Œéƒ½ä¼šè¢«ç¼“å­˜ã€‚å³ä½¿ä½ å¤šæ¬¡è¿è¡Œç›¸åŒçš„æ“ä½œï¼Œå·²ç»è®¡ç®—è¿‡çš„éƒ¨åˆ†ä¼šä»ç¼“å­˜ä¸­ç›´æ¥åŠ è½½ï¼Œå¤§å¹…æé«˜æ•ˆç‡ã€‚\n\n\n\n17.2.3 å¯é€‰çš„å­˜å‚¨æ–¹å¼ï¼š\nmemoise è¿˜æ”¯æŒä¸åŒçš„å­˜å‚¨æ–¹å¼ï¼ˆä¾‹å¦‚æ–‡ä»¶ç³»ç»Ÿã€æ•°æ®åº“ã€å†…å­˜ç­‰ï¼‰ï¼Œä½ å¯ä»¥å°†ç¼“å­˜çš„æ•°æ®å­˜å‚¨åœ¨æŒä¹…åŒ–çš„å­˜å‚¨ä¸­ï¼Œè¿™æ ·å³ä½¿ R ä¼šè¯å…³é—­ï¼Œä¹Ÿèƒ½ä¿ç•™ç¼“å­˜ç»“æœï¼š\n# ä½¿ç”¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿç¼“å­˜\ncached_function = memoise(my_function, cache = cache_filesystem(\"cache\"))\nè¿™æ ·å¯ä»¥åœ¨æœªæ¥çš„ä¼šè¯ä¸­ç»§ç»­ä½¿ç”¨ç¼“å­˜ï¼Œæé«˜è®¡ç®—çš„æ•ˆç‡å¹¶é¿å…é‡å¤æ‰§è¡Œç›¸åŒçš„ä»»åŠ¡ã€‚\n\n\n17.2.4 è‡ªå®šä¹‰ç¼“å­˜é”®\nåœ¨ memoise ä¸­ï¼Œç¼“å­˜çš„å”¯ä¸€é”®æ˜¯åŸºäºè¾“å…¥å‚æ•°çš„å€¼è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä½¿ç”¨çš„æ˜¯å‚æ•°çš„å“ˆå¸Œå€¼ã€‚è¿™æ„å‘³ç€å½“ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°å†…å®¹ç›¸åŒæ—¶ï¼Œmemoise ä¼šè¯†åˆ«å¹¶ä½¿ç”¨å·²ç»ç¼“å­˜çš„ç»“æœï¼Œè€Œæ— éœ€é‡å¤è®¡ç®—ã€‚\nç„¶è€Œï¼Œæœ‰æ—¶ä½ å¯èƒ½å¸Œæœ›æ›´æ˜ç¡®åœ°æ§åˆ¶å¦‚ä½•ç”Ÿæˆè¿™äº›ç¼“å­˜é”®ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¡®ä¿ç¼“å­˜é”®çš„å”¯ä¸€æ€§ï¼š\n\n17.2.4.1 é»˜è®¤è¡Œä¸ºï¼ˆè‡ªåŠ¨åŸºäºå‚æ•°ç”Ÿæˆé”®ï¼‰\nmemoise ä¼šé»˜è®¤æ ¹æ®å‡½æ•°çš„è¾“å…¥å‚æ•°å†…å®¹æ¥ç”Ÿæˆå“ˆå¸Œå€¼ã€‚ä¾‹å¦‚ï¼š\nlibrary(memoise)\n\n# å®šä¹‰ä¸€ä¸ªç®€å•çš„å‡½æ•°\nmy_function = function(x) {\n  Sys.sleep(1)  # æ¨¡æ‹Ÿè®¡ç®—å»¶è¿Ÿ\n  x^2           # è¿”å›å¹³æ–¹\n}\n\n# ç¼“å­˜è¯¥å‡½æ•°\ncached_function = memoise(my_function)\n\n# è°ƒç”¨å‡½æ•°ï¼Œmemoise å°†è‡ªåŠ¨æ ¹æ® x çš„å€¼ç”Ÿæˆç¼“å­˜\ncached_function(10)  # ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œä¼šæ‰§è¡Œ\ncached_function(10)  # ç¬¬äºŒæ¬¡è°ƒç”¨ï¼Œä¼šä»ç¼“å­˜ä¸­è¿”å›ç»“æœ\nåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œmemoise ä¼šæ ¹æ® x=10 ç”Ÿæˆå“ˆå¸Œé”®ï¼Œä¸‹æ¬¡è°ƒç”¨ç›¸åŒè¾“å…¥æ—¶ä¼šç›´æ¥è¿”å›ç¼“å­˜ç»“æœã€‚\n\n\n17.2.4.2 è‡ªå®šä¹‰é”®ç”Ÿæˆæ–¹æ³•\nå¦‚æœä½ éœ€è¦è‡ªå®šä¹‰é”®çš„ç”Ÿæˆæ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨ digest åŒ…æ¥æ‰‹åŠ¨ç”Ÿæˆç¼“å­˜é”®ã€‚é€šè¿‡å°†è¾“å…¥å‚æ•°è½¬æ¢æˆå“ˆå¸Œå€¼ä½œä¸ºç¼“å­˜é”®æ¥ç²¾ç¡®æ§åˆ¶ç¼“å­˜è¡Œä¸ºã€‚\nä¾‹å¦‚ï¼š\n\nlibrary(memoise)\nlibrary(digest)\n\n# è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œæ‰‹åŠ¨ç”Ÿæˆç¼“å­˜é”®\nmy_custom_memoise = function(f) {\n  mem_f = memoise(function(...) {\n    # ä½¿ç”¨ digest æ‰‹åŠ¨ç”Ÿæˆå”¯ä¸€é”®ï¼ŒåŸºäºè¾“å…¥å‚æ•°çš„å“ˆå¸Œå€¼\n    cache_key = digest(list(...))\n    message(\"Cache key: \", cache_key)\n    f(...)\n  })\n  return(mem_f)\n}\n\n# å®šä¹‰ä¸€ä¸ªå‡½æ•°\nmy_function = function(x) {\n  Sys.sleep(1)\n  x^2\n}\n\n# å°†å‡½æ•°ç¼“å­˜ï¼Œå¹¶è‡ªå®šä¹‰ç¼“å­˜é”®ç”Ÿæˆ\ncached_function = my_custom_memoise(my_function)\n\n# è°ƒç”¨å‡½æ•°æ—¶ä¼šç”Ÿæˆå¹¶è¾“å‡ºè‡ªå®šä¹‰çš„ç¼“å­˜é”®\ncached_function(10)\n\n[1] 100\n\ncached_function(10)\n\n[1] 100\n\ncached_function(20)  # å¯¹äºä¸åŒçš„è¾“å…¥ï¼Œç¼“å­˜é”®ä¼šä¸åŒ\n\n[1] 400\n\n\n\n\n\n17.2.5 ä¿å­˜ç¼“å­˜åˆ° sqlite æ•°æ®åº“\nä½¿ç”¨ cache_filesystem ç¼“å­˜æ—¶ï¼Œç¼“å­˜æ•°æ®ä¼šä¿å­˜åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¼šæ¶‰åŠæ¯”è¾ƒå¤šçš„ç£ç›˜è¯»å†™è¿ç®—ï¼Œå½“å¤„ç†é‡è¾ƒå¤§æ—¶ï¼Œä¼šä¸¥é‡å½±å“æ€§èƒ½ã€‚è€Œä¸”æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œç®¡ç†èµ·æ¥ä¹Ÿä¸æ–¹ä¾¿ã€‚å› æ­¤ï¼Œè¿™é‡Œæ‰©å±•äº†ä¸€ä¸ª cache_dbi() å‡½æ•°ï¼Œä½¿ç”¨æ•°æ®åº“æ¥ç¼“å­˜æ•°æ®ã€‚\n\n#' SQLite Database Cache\n#'\n#' Use a cache in a SQLite database that will persist between R sessions.\n#'\n#' @param con A DBI connection object to a SQLite database.\n#' @param table_name Name of the table to use for caching. Default: \"cache\".\n#'\n#' @examples\n#'\n#' \\dontrun{\n#' library(DBI)\n#' library(RSQLite)\n#' \n#' # åˆ›å»º SQLite æ•°æ®åº“è¿æ¥\n#' con &lt;- dbConnect(SQLite(), dbname = \"cache.sqlite\")\n#' \n#' # ä½¿ç”¨ SQLite ç¼“å­˜\n#' db_cache &lt;- cache_dbi(con)\n#' \n#' mem_runif &lt;- memoise(runif, cache = db_cache)\n#' }\n#'\n#' @export\n#' @inheritParams cache_memory\ncache_dbi &lt;- function(con, algo = \"xxhash64\", table_name = \"cache\") {\n  if (!(requireNamespace(\"digest\"))) { stop(\"Package `digest` must be installed for `cache_dbi()`.\") }\n  if (!(requireNamespace(\"DBI\"))) { stop(\"Package `DBI` must be installed for `cache_dbi()`.\") }\n\n  if (!grepl(\"^[A-Za-z0-9_]+$\", table_name)) {\n    stop(\"Invalid table name\")\n  }\n\n  # åˆ›å»ºç¼“å­˜è¡¨\n  DBI::dbExecute(con, sprintf(\"CREATE TABLE IF NOT EXISTS %s (key TEXT PRIMARY KEY, value BLOB)\", table_name))\n\n  # é‡ç½®ç¼“å­˜\n  cache_reset &lt;- function() {\n    DBI::dbExecute(con, sprintf(\"DELETE FROM %s\", table_name))\n  }\n\n  # è®¾ç½®ç¼“å­˜\n  cache_set &lt;- function(key, value) {\n    serialized_value &lt;- serialize(value, NULL)  # åºåˆ—åŒ– R å¯¹è±¡\n    DBI::dbExecute(con, sprintf(\"INSERT OR REPLACE INTO %s (key, value) VALUES (?, ?)\", table_name),\n                   params = list(key, list(serialized_value)))  # ç”¨ list åŒ…è£¹ serialized_value\n  }\n\n  # è·å–ç¼“å­˜\n  cache_get &lt;- function(key) {\n    result &lt;- DBI::dbGetQuery(con, sprintf(\"SELECT value FROM %s WHERE key = ?\", table_name),\n                              params = list(key))\n    if (nrow(result) == 0) {\n      return(NULL)\n    }\n    unserialize(result$value[[1]])  # ååºåˆ—åŒ–ç¬¬ä¸€ä¸ªå€¼\n  }\n\n  # æ£€æŸ¥ç¼“å­˜æ˜¯å¦å­˜åœ¨\n  cache_has_key &lt;- function(key) {\n    result &lt;- DBI::dbGetQuery(con, sprintf(\"SELECT 1 FROM %s WHERE key = ? LIMIT 1\", table_name),\n                              params = list(key))\n    nrow(result) &gt; 0\n  }\n\n  # åˆ é™¤ç¼“å­˜\n  cache_drop_key &lt;- function(key) {\n    DBI::dbExecute(con, sprintf(\"DELETE FROM %s WHERE key = ?\", table_name),\n                   params = list(key))\n  }\n\n  list(\n    digest = function(...) digest::digest(..., algo = algo),\n    reset = cache_reset,\n    set = cache_set,\n    get = cache_get,\n    has_key = cache_has_key,\n    drop_key = cache_drop_key,\n    keys = function() DBI::dbGetQuery(con, sprintf(\"SELECT key FROM %s\", table_name))$key\n  )\n}\n\nä¸‹é¢ï¼Œä½¿ç”¨ cache_dbi() å‡½æ•°æ¥ç¼“å­˜æ•°æ®ï¼š\n\nlibrary(memoise)\nlibrary(DBI)\nlibrary(RSQLite)\n\n# åˆ›å»º SQLite æ•°æ®åº“è¿æ¥\ncon = dbConnect(SQLite(), dbname = tempfile())\n# on.exit(dbDisconnect(con))\n\n# å°†ç¼“å­˜æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­\ncached_function = memoise(my_function, cache = cache_dbi(con))\n\n# ç¬¬ä¸€æ¬¡è¿è¡Œ\nsystem.time(cached_function(10))\n\n   user  system elapsed \n  0.002   0.001   1.008 \n\n# ç¬¬äºŒæ¬¡è¿è¡Œ\nsystem.time(cached_function(10))\n\n   user  system elapsed \n  0.008   0.000   0.007 \n\n# ç¬¬ä¸‰æ¬¡è¿è¡Œ\nsystem.time(cached_function(20))\n\n   user  system elapsed \n  0.002   0.002   1.009",
    "crumbs": [
      "<span class='chapter-number'>17</span>Â  <span class='chapter-title'>æ‰¹é‡å¼‚æ­¥ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "batch-async-task.html#åŠ¨æ€æ§åˆ¶æ‰¹æ¬¡æ‰§è¡Œ",
    "href": "batch-async-task.html#åŠ¨æ€æ§åˆ¶æ‰¹æ¬¡æ‰§è¡Œ",
    "title": "17Â  æ‰¹é‡å¼‚æ­¥ä»»åŠ¡",
    "section": "17.3 åŠ¨æ€æ§åˆ¶æ‰¹æ¬¡æ‰§è¡Œ",
    "text": "17.3 åŠ¨æ€æ§åˆ¶æ‰¹æ¬¡æ‰§è¡Œ\nä¸ºäº†åŠ¨æ€æ§åˆ¶æ‰¹æ¬¡çš„æ‰§è¡Œï¼Œå¹¶ç¡®ä¿æ­£åœ¨æ‰§è¡Œçš„è¿ç®—ä¸è¶…è¿‡ batch_sizeï¼Œä½ å¯ä»¥ä½¿ç”¨ R çš„å¼‚æ­¥ç¼–ç¨‹æˆ–å¹¶å‘å·¥å…·åŒ…ï¼Œæ¯”å¦‚ parallel å’Œ futureï¼Œç»“åˆ Sys.sleep() æ§åˆ¶æ‰¹æ¬¡æäº¤çš„é€Ÿç‡ã€‚\n\n17.3.1 ä½¿ç”¨ parallel åŒ…å®ç°åŠ¨æ€åˆ†æ‰¹\nä»¥ä¸‹æ˜¯ä½¿ç”¨ parallel åŒ…æ‰§è¡Œ batch_size ä¸ªå¹¶å‘æ“ä½œçš„ç¤ºä¾‹ï¼š\n\nlibrary(parallel)\n\n# ç¤ºä¾‹æ•°æ®\ndf = data.frame(a = 1:100, b = rnorm(100))\n\n# å®šä¹‰å¤„ç†å‡½æ•°\nprocess_function = function(row) {\n  Sys.sleep(runif(1, 0.1, 0.5))  # æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡\n  sum(row)      # è¿”å›æ¯è¡Œçš„å’Œ\n}\n\n# æ¯”è¾ƒä¸²è¡Œå’Œå¹¶è¡Œå¤„ç†çš„æ€§èƒ½\n\n# ä¸²è¡Œå¤„ç†\nstart_time_serial = Sys.time()\nresults_serial = lapply(1:nrow(df), function(i) {\n  process_function(df[i, ])\n})\nend_time_serial = Sys.time()\ntime_serial = difftime(end_time_serial, start_time_serial, units = \"secs\")\n\n# å¹¶è¡Œå¤„ç†\nstart_time_parallel = Sys.time()\nresults_parallel = mclapply(1:nrow(df), function(i) {\n  process_function(df[i, ])\n}, mc.cores = parallel::detectCores() - 1)  # ä½¿ç”¨å¯ç”¨æ ¸å¿ƒæ•°å‡1\nend_time_parallel = Sys.time()\ntime_parallel = difftime(end_time_parallel, start_time_parallel, units = \"secs\")\n\n# è®¡ç®—æ€§èƒ½æå‡\nspeedup = as.numeric(time_serial) / as.numeric(time_parallel)\n\n# è¾“å‡ºç»“æœ\ncat(\"ä¸²è¡Œå¤„ç†æ—¶é—´ï¼š\", time_serial, \"ç§’\\n\")\ncat(\"å¹¶è¡Œå¤„ç†æ—¶é—´ï¼š\", time_parallel, \"ç§’\\n\")\ncat(\"æ€§èƒ½æå‡ï¼š\", round(speedup, 2), \"å€\\n\")\n\n# éªŒè¯ç»“æœæ­£ç¡®æ€§\ntestthat::expect_equal(rowSums(df), unlist(results_serial))\ntestthat::expect_equal(rowSums(df), unlist(results_parallel))\n\n\n\n17.3.2 ä½¿ç”¨ future åŒ…å®ç°åŠ¨æ€åˆ†æ‰¹\nfuture åŒ…å…è®¸ä½ å¼‚æ­¥åœ°è¿è¡Œå‡½æ•°ï¼Œå¹¶é€šè¿‡é™åˆ¶åŒæ—¶è¿›è¡Œçš„ä»»åŠ¡æ•°é‡æ¥åŠ¨æ€æ§åˆ¶æ‰¹æ¬¡ã€‚é€šè¿‡ç›‘æ§å¹¶å‘æ‰§è¡Œçš„æ•°é‡ï¼Œå¦‚æœä½äº batch_sizeï¼Œåˆ™è‡ªåŠ¨å¯åŠ¨æ–°çš„ä»»åŠ¡ï¼Œå¦åˆ™ç­‰å¾… 1 ç§’å†æ£€æŸ¥ã€‚\n\n\n17.3.3 ä»£ç ç¤ºä¾‹\n\nlibrary(future)\nlibrary(future.apply)\n\n# è®¾å®šæœ€å¤§å¹¶è¡Œæ‰§è¡Œä»»åŠ¡æ•°ä¸º batch_size\nbatch_size = 10\n\n# ä½¿ç”¨å¤šçº¿ç¨‹è®¡åˆ’\nplan(multisession, workers = batch_size)\n\n# ç¤ºä¾‹æ•°æ®\ndf = data.frame(a = 1:100, b = rnorm(100))\n\n# å®šä¹‰å¤„ç†å‡½æ•°\nprocess_function = function(row) {\n  Sys.sleep(runif(1, 0.1, 0.5))  # æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡\n  sum(row)      # è¿”å›æ¯è¡Œçš„å’Œ\n}\n\n# åŠ¨æ€æ§åˆ¶æ‰¹æ¬¡æ‰§è¡Œ\nresults = list()  # ç”¨äºå­˜å‚¨ç»“æœ\nfutures = list()  # ç”¨äºå­˜å‚¨æ¯ä¸ª future\n\n# å°†æ¯è¡Œåˆ†æˆä»»åŠ¡æäº¤\nfor (i in 1:nrow(df)) {\n  # æ£€æŸ¥å½“å‰è¿è¡Œä¸­çš„ä»»åŠ¡æ•°é‡\n  current_tasks = futures[!sapply(futures, resolved)]\n\n  # å¦‚æœå½“å‰è¿è¡Œä¸­çš„ä»»åŠ¡æ•°é‡è¾¾åˆ° batch_sizeï¼Œç­‰å¾… 1 ç§’\n  while (length(current_tasks) &gt;= batch_size) {\n    # æ‰“å°å½“å‰è¿è¡Œä¸­çš„ä»»åŠ¡æ•°é‡\n    message(\"å½“å‰è¿è¡Œä¸­çš„ä»»åŠ¡æ•°é‡ï¼š\", length(current_tasks))\n    # ç­‰å¾… 1 ç§’\n    Sys.sleep(1)\n    # æ›´æ–°å½“å‰è¿è¡Œä¸­çš„ä»»åŠ¡\n    current_tasks = futures[!sapply(futures, resolved)]\n  }\n  \n  # æäº¤æ–°çš„ä»»åŠ¡ï¼Œå¹¶ä¿æŒè¿½è¸ª\n  futures[[i]] = future({\n    process_function(df[i, ])\n  }, seed = TRUE)\n\n}\n\n# æ”¶é›†æ‰€æœ‰ç»“æœ\nresults = future::value(futures) |&gt; unlist()\n\n# å±•ç¤ºç»“æœ\ntestthat::expect_equal(rowSums(df), results)\n\n\n\n17.3.4 ä»£ç è¯´æ˜\n\nfuture å’Œ future.applyï¼šfuture åŒ…å…è®¸å°†ä»»åŠ¡å¼‚æ­¥æäº¤ï¼Œé€šè¿‡ plan(multisession, workers = batch_size) é™åˆ¶åŒæ—¶è¿è¡Œçš„ä»»åŠ¡æ•°ã€‚\nåŠ¨æ€ä»»åŠ¡è°ƒåº¦ï¼š\n\næ¯æ¬¡æ–°ä»»åŠ¡æäº¤å‰ï¼Œæ£€æŸ¥å½“å‰è¿è¡Œä¸­çš„ä»»åŠ¡æ•°é‡ï¼ˆlength(futures)ï¼‰ã€‚\nå¦‚æœè¿è¡Œä¸­çš„ä»»åŠ¡è¾¾åˆ° batch_sizeï¼Œç¨‹åºä¼šç­‰å¾… 1 ç§’ï¼Œå†æ¬¡æ£€æŸ¥ä»»åŠ¡æ•°é‡ï¼Œç¡®ä¿ä¸è¶…å‡ºæœ€å¤§å¹¶è¡Œæ•°ã€‚\nå½“ä½äº batch_size æ—¶ï¼Œæ–°çš„ä»»åŠ¡æ‰ä¼šè¢«æäº¤ã€‚\n\nç»“æœæ”¶é›†ï¼šä½¿ç”¨ future::value(futures) æ¥è·å–æ‰€æœ‰ä»»åŠ¡çš„è®¡ç®—ç»“æœã€‚\né”™è¯¯å¤„ç†ï¼šä½¿ç”¨ tryCatch æ•è·é”™è¯¯ï¼Œå¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚\n\né€šè¿‡è¿™ç§æ–¹æ³•ï¼Œä½ å¯ä»¥ç¡®ä¿æ‰¹æ¬¡æ‰§è¡Œæ•°ä¸ä¼šè¶…è¿‡ batch_sizeï¼Œå¹¶ä¸”åŠ¨æ€æäº¤æ–°ä»»åŠ¡ï¼Œä»è€Œå®ç°æ›´çµæ´»çš„ä»»åŠ¡ç®¡ç†ã€‚",
    "crumbs": [
      "<span class='chapter-number'>17</span>Â  <span class='chapter-title'>æ‰¹é‡å¼‚æ­¥ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "batch-async-task.html#åŒ…è£…æˆä¸€ä¸ªå‡½æ•°",
    "href": "batch-async-task.html#åŒ…è£…æˆä¸€ä¸ªå‡½æ•°",
    "title": "17Â  æ‰¹é‡å¼‚æ­¥ä»»åŠ¡",
    "section": "17.4 åŒ…è£…æˆä¸€ä¸ªå‡½æ•°",
    "text": "17.4 åŒ…è£…æˆä¸€ä¸ªå‡½æ•°\n\n17.4.1 å‡½æ•°å®šä¹‰\nå‡½æ•°é‡‡ç”¨ pbapply æ˜¾ç¤ºè¿›åº¦ï¼Œbatch_size è®¾å®šæ‰¹æ¬¡å¤§å°ï¼Œfun æ¥å—å‘½ä»¤ï¼ˆå¦‚æœè¿™ä¸ªå‘½ä»¤æ˜¯ä¸€ä¸ª memorise å‡½æ•°åˆ™ç›´æ¥ä½¿ç”¨ï¼Œå¦‚æœä¸æ˜¯åˆ™å°†å…¶è‡ªåŠ¨ç¼“å­˜ï¼‰ï¼Œç¼“å­˜é»˜è®¤ä½¿ç”¨ cache_dbi()ï¼Œç¼“å­˜æ–‡ä»¶åœ°å€ä¸º db_file æ–‡ä»¶ï¼Œç”±ç”¨æˆ·æä¾›ã€‚\n\nrun_task_with_cache &lt;- function(df, fun, db_file) {\n\n  # æ£€æŸ¥å¹¶åˆ›å»ºç¼“å­˜\n  con = DBI::dbConnect(RSQLite::SQLite(), dbname = db_file)\n  on.exit(DBI::dbDisconnect(con))\n  \n  # å¦‚æœfunæ˜¯memoiseå‡½æ•°ï¼Œåˆ™æå‡º warningï¼Œå¹¶ä½¿ç”¨fun \n  if (inherits(fun, \"memoised\")) {\n    warning(\"Fun is already a memoised function. It will be used directly. `db_file` will be ignored.\")\n  } else {\n    # å¦‚æœfunä¸æ˜¯memoiseå‡½æ•°ï¼Œåˆ™å°†å…¶ç¼“å­˜\n    fun &lt;- memoise::memoise(fun, cache = cache_dbi(con))\n  }\n  \n  # æ‰§è¡Œè®¡ç®—\n  results = pbapply::pblapply(1:nrow(df), function(i) {\n    row = df[i, ]\n    result = tryCatch(fun(row), error = function(e) {\n        message(\"é”™è¯¯å‘ç”Ÿåœ¨ç¬¬ \", i, \" è¡Œ: \", e$message)\n        return(NA)\n      })\n    return(result)\n  })\n  \n  return(results)\n}\n\n\n# ç¤ºä¾‹æ•°æ®\nset.seed(123456)\ndf = data.frame(a = 1:100, b = rnorm(100))\n\n# å®šä¹‰å¤„ç†å‡½æ•°\nprocess_function = function(row) {\n  Sys.sleep(0.1)  # æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡\n  sum(row)      # è¿”å›æ¯è¡Œçš„å’Œ\n}\n\n\n# è¿è¡Œå‡½æ•°\nresult &lt;- run_task_with_cache(df, process_function, db_file = \"cache.sqlite\")\n\ntestthat::expect_equal(unlist(result), rowSums(df))\n\n\n\n17.4.2 å¹¶è¡Œè®¡ç®—\nå¹¶è¡Œè®¡ç®—å¯ä»¥ä½¿ç”¨ future åŒ…ï¼Œæˆ–è€… parallel åŒ…ã€‚ä½†æ˜¯åœ¨æ˜¾ç¤ºè¿›åº¦æ¡ã€æ•°æ®åº“è®¿é—®æ–¹é¢å®ç°èµ·æ¥æœ‰ä¸€å®šéš¾åº¦ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°æ•°æ®åº“è®¿é—®çš„å¹¶å‘é—®é¢˜ï¼Œæš‚æ—¶æ²¡æœ‰å¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆã€‚å› æ­¤ï¼Œè€ƒè™‘ä½¿ç”¨æ•°æ®æ‹†åˆ†çš„æ–¹æ³•ï¼Œæ‹†æˆå¤šä¸ªæ‰¹æ¬¡ï¼Œæ¯ä¸ªæ‰¹æ¬¡ä½¿ç”¨ä¸€ä¸ªè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹ä½¿ç”¨ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å¹¶å‘é—®é¢˜ã€‚",
    "crumbs": [
      "<span class='chapter-number'>17</span>Â  <span class='chapter-title'>æ‰¹é‡å¼‚æ­¥ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "batch-async-task.html#è¿›åº¦æ¡",
    "href": "batch-async-task.html#è¿›åº¦æ¡",
    "title": "17Â  æ‰¹é‡å¼‚æ­¥ä»»åŠ¡",
    "section": "17.5 è¿›åº¦æ¡",
    "text": "17.5 è¿›åº¦æ¡\nåœ¨ R ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ªåŒ…æ¥æ˜¾ç¤ºç°ä»£åŒ–çš„è¿›åº¦æ¡ï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„åŒ…åŒ…æ‹¬ï¼š\n\nprogressrï¼šä¸€ä¸ªå¼ºå¤§çš„è¿›åº¦æ¡åŒ…ï¼Œå¯ä»¥æ˜¾ç¤ºå¹¶è¡Œä»»åŠ¡çš„è¿›åº¦æ¡ã€‚\nprogressï¼šä¸€ä¸ªç®€å•çš„ã€å¯é«˜åº¦è‡ªå®šä¹‰çš„è¿›åº¦æ¡åŒ…ã€‚\ncliï¼šå¯ä»¥ç»“åˆè¿›åº¦æ¡æ˜¾ç¤ºï¼Œä¹Ÿå¯ä»¥æ˜¾ç¤ºä¸°å¯Œçš„å‘½ä»¤è¡Œç•Œé¢å…ƒç´ ã€‚\npbapplyï¼šé€‚ç”¨äº *apply ç³»åˆ—å‡½æ•°çš„è¿›åº¦æ¡é›†æˆã€‚\n\nä»¥ä¸‹æ˜¯è¿™äº›åŒ…çš„åŸºæœ¬ç”¨æ³•ï¼š\n\nä½¿ç”¨ progressr åŒ…\n\nprogressr åŒ…å¯ä»¥ç”¨æ¥æ˜¾ç¤ºå¹¶è¡Œä»»åŠ¡çš„è¿›åº¦æ¡ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ future å’Œ furrr åŒ…è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œå¹¶ä½¿ç”¨ progressr æ˜¾ç¤ºè¿›åº¦çš„ç¤ºä¾‹ï¼š\n\nlibrary(future)\nlibrary(furrr)\nlibrary(progressr)\n\nplan(multisession, workers = 4)\n\ndata &lt;- 1:100\n\ntime_consuming_task &lt;- function(x) {\n  Sys.sleep(0.01)\n  return(x^2)\n}\n\nwith_progress({\n  p &lt;- progressor(steps = length(data))\n  \n  results &lt;- future_map(data, function(x) {\n    result &lt;- time_consuming_task(x)\n    p()\n    return(result)\n  })\n})\n\n\nä½¿ç”¨ progress åŒ…\n\nprogress åŒ…æä¾›äº†ç®€å•æ˜“ç”¨çš„è¿›åº¦æ¡ï¼ŒåŒæ—¶å¯ä»¥è¿›è¡Œé«˜åº¦è‡ªå®šä¹‰ã€‚\n\n# å®‰è£…å¹¶åŠ è½½ progress åŒ…\n# install.packages(\"progress\")\nlibrary(progress)\n\n# åˆ›å»ºä¸€ä¸ªè¿›åº¦æ¡\npb = progress_bar$new(\n  format = \"  downloading [:bar] :percent in :elapsed\",\n  total = 100, clear = FALSE, width = 60\n)\n\n# æ¨¡æ‹Ÿä¸€ä¸ªä»»åŠ¡å¹¶æ›´æ–°è¿›åº¦æ¡\nfor (i in 1:100) {\n  Sys.sleep(0.01)  # æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡\n  pb$tick()  # æ¯æ¬¡å¾ªç¯æ—¶ï¼Œè¿›åº¦æ¡å‰è¿›ä¸€æ ¼\n}\n\n\nä½¿ç”¨ cli åŒ…\n\ncli åŒ…ä¸ä»…æä¾›è¿›åº¦æ¡ï¼Œè¿˜å¯ä»¥åˆ›å»ºå¯Œæ–‡æœ¬å‘½ä»¤è¡Œç•Œé¢ã€‚\n\n# å®‰è£…å¹¶åŠ è½½ cli åŒ…\n# install.packages(\"cli\")\nlibrary(cli)\n\n# åˆ›å»ºå¹¶æ˜¾ç¤ºè¿›åº¦æ¡\npb = cli_progress_bar(\"Computing\", \n                      total = 100, \n                      format = \" {cli::pb_bar} {cli::pb_percent} ETA: {cli::pb_eta}\")\n\nfor (i in 1:100) {\n  Sys.sleep(0.05)  # æ¨¡æ‹Ÿä»»åŠ¡\n  cli_progress_update()  # æ›´æ–°è¿›åº¦æ¡\n}\n\nmessage(\"Done!\")\ncli_progress_done()  # ä»»åŠ¡å®Œæˆæ—¶æ¸…é™¤è¿›åº¦æ¡\n\n\nä½¿ç”¨ pbapply åŒ…\n\nå¦‚æœä½ ç»å¸¸ä½¿ç”¨ apply ç³»åˆ—å‡½æ•°ï¼Œpbapply åŒ…å¯ä»¥åœ¨å®ƒä»¬çš„åŸºç¡€ä¸Šæ·»åŠ è¿›åº¦æ¡ã€‚\n\n# å®‰è£…å¹¶åŠ è½½ pbapply åŒ…\n#install.packages(\"pbapply\")\nlibrary(pbapply)\n\n# ä½¿ç”¨ pbapply ä¸­çš„ pbsapply ä»£æ›¿ sapplyï¼Œè‡ªåŠ¨æ·»åŠ è¿›åº¦æ¡\nresult = pbsapply(1:100, function(x) {\n  Sys.sleep(0.01)  # æ¨¡æ‹Ÿä»»åŠ¡\n  x^2\n})\n\nè¿™å‡ ä¸ªåŒ…éƒ½æä¾›äº†ç°ä»£åŒ–çš„è¿›åº¦æ¡æ˜¾ç¤ºï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é€‰æ‹©æœ€åˆé€‚çš„ã€‚",
    "crumbs": [
      "<span class='chapter-number'>17</span>Â  <span class='chapter-title'>æ‰¹é‡å¼‚æ­¥ä»»åŠ¡</span>"
    ]
  },
  {
    "objectID": "object-detection-of-microfluidic-chip.html",
    "href": "object-detection-of-microfluidic-chip.html",
    "title": "18Â  æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡ä¸­çš„ç‰©ä½“",
    "section": "",
    "text": "18.1 è¯»å–å¹¶æ˜¾ç¤ºå›¾åƒ\nfrom PIL import Image\nimport matplotlib.pyplot as plt\n\n# åŠ è½½å›¾åƒ\nimage_path = 'example/images/microfluidic-chip.jpg'\nimage = Image.open(image_path)\n\n# åœ¨ Notebook ä¸­æ˜¾ç¤ºå›¾åƒ\nplt.figure(figsize=(12, 8))\nplt.imshow(image)\nplt.axis('on')  # æ˜¾ç¤ºåæ ‡è½´\nplt.show()",
    "crumbs": [
      "<span class='chapter-number'>18</span>Â  <span class='chapter-title'>æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡ä¸­çš„ç‰©ä½“</span>"
    ]
  },
  {
    "objectID": "object-detection-of-microfluidic-chip.html#ä½¿ç”¨é«˜æ–¯æ¨¡ç³Š",
    "href": "object-detection-of-microfluidic-chip.html#ä½¿ç”¨é«˜æ–¯æ¨¡ç³Š",
    "title": "18Â  æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡ä¸­çš„ç‰©ä½“",
    "section": "18.2 ä½¿ç”¨é«˜æ–¯æ¨¡ç³Š",
    "text": "18.2 ä½¿ç”¨é«˜æ–¯æ¨¡ç³Š\nè¿™æ®µä»£ç ä¸»è¦å®ç°äº†å›¾åƒçš„é¢„å¤„ç†å’Œå¯è§†åŒ–ã€‚\né¦–å…ˆï¼Œä½¿ç”¨ OpenCV åº“è¯»å–å›¾åƒå¹¶å°†å…¶è½¬æ¢ä¸ºç°åº¦å›¾ï¼Œè¿™æ ·å¯ä»¥å‡å°‘è®¡ç®—é‡å¹¶ç®€åŒ–åç»­å¤„ç†ã€‚\nç„¶åï¼Œåº”ç”¨é«˜æ–¯æ¨¡ç³Šæ¥å‡å°‘å›¾åƒä¸­çš„å™ªå£°ï¼Œè¿™æœ‰åŠ©äºæé«˜åç»­è¾¹ç¼˜æ£€æµ‹çš„å‡†ç¡®æ€§ã€‚é«˜æ–¯æ¨¡ç³Šä½¿ç”¨ 9x9 çš„æ ¸ï¼Œå¯ä»¥æœ‰æ•ˆå¹³æ»‘å›¾åƒè€Œä¸ä¼šè¿‡åº¦æ¨¡ç³Šé‡è¦ç‰¹å¾ã€‚\næœ€åï¼Œä½¿ç”¨ Matplotlib åº“åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå­å›¾çš„å›¾å½¢ï¼Œåˆ†åˆ«æ˜¾ç¤ºåŸå§‹ç°åº¦å›¾åƒå’Œç»è¿‡é«˜æ–¯æ¨¡ç³Šå¤„ç†åçš„å›¾åƒï¼Œä»¥ä¾¿ç›´è§‚æ¯”è¾ƒå¤„ç†æ•ˆæœã€‚è¿™ä¸ªé¢„å¤„ç†æ­¥éª¤ä¸ºåç»­çš„ç‰©ä½“æ£€æµ‹å¥ å®šäº†åŸºç¡€ã€‚\n\nimport cv2\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# è¯»å–å›¾åƒå¹¶è½¬æ¢ä¸ºç°åº¦å›¾\nimage = cv2.imread(image_path)\ngray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)\n\n# åº”ç”¨é«˜æ–¯æ¨¡ç³Šä»¥å‡å°‘å™ªå£°\nblurred = cv2.GaussianBlur(gray, (9, 9), 0)\n\n# æ˜¾ç¤ºæ¨¡ç³Šåçš„å›¾åƒ\nplt.figure(figsize=(10, 5))\nplt.subplot(1, 2, 1)\nplt.title(\"Original Image\")\nplt.imshow(cv2.cvtColor(gray, cv2.COLOR_BGR2RGB))\nplt.axis('off')\n\nplt.subplot(1, 2, 2)\nplt.title(\"Gaussian Blurred Image\")\nplt.imshow(cv2.cvtColor(blurred, cv2.COLOR_BGR2RGB))\nplt.axis('off')\n\nplt.tight_layout()\nplt.show()",
    "crumbs": [
      "<span class='chapter-number'>18</span>Â  <span class='chapter-title'>æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡ä¸­çš„ç‰©ä½“</span>"
    ]
  },
  {
    "objectID": "object-detection-of-microfluidic-chip.html#ä½¿ç”¨cannyè¾¹ç¼˜æ£€æµ‹",
    "href": "object-detection-of-microfluidic-chip.html#ä½¿ç”¨cannyè¾¹ç¼˜æ£€æµ‹",
    "title": "18Â  æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡ä¸­çš„ç‰©ä½“",
    "section": "18.3 ä½¿ç”¨Cannyè¾¹ç¼˜æ£€æµ‹",
    "text": "18.3 ä½¿ç”¨Cannyè¾¹ç¼˜æ£€æµ‹\nCanny è¾¹ç¼˜æ£€æµ‹æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„å›¾åƒå¤„ç†æŠ€æœ¯ï¼Œç”¨äºè¯†åˆ«å›¾åƒä¸­çš„è¾¹ç¼˜ã€‚å®ƒç”± John F. Canny åœ¨ 1986 å¹´æå‡ºï¼Œè¢«è®¤ä¸ºæ˜¯ä¸€ç§éå¸¸æœ‰æ•ˆçš„è¾¹ç¼˜æ£€æµ‹ç®—æ³•ã€‚Canny è¾¹ç¼˜æ£€æµ‹çš„ä¸»è¦æ­¥éª¤åŒ…æ‹¬ï¼š\n\né«˜æ–¯æ»¤æ³¢ï¼š é¦–å…ˆå¯¹å›¾åƒè¿›è¡Œé«˜æ–¯æ¨¡ç³Šï¼Œä»¥å‡å°‘å™ªå£°ã€‚è¿™ä¸€æ­¥å·²ç»åœ¨å‰é¢çš„ä»£ç ä¸­å®Œæˆã€‚\nè®¡ç®—å›¾åƒæ¢¯åº¦ï¼š ä½¿ç”¨ Sobel ç®—å­è®¡ç®—å›¾åƒåœ¨ x å’Œ y æ–¹å‘çš„æ¢¯åº¦ã€‚è¿™å¯ä»¥æ‰¾å‡ºå›¾åƒä¸­äº®åº¦å˜åŒ–æœ€å¤§çš„åŒºåŸŸã€‚\néæå¤§å€¼æŠ‘åˆ¶ï¼š æ²¿æ¢¯åº¦æ–¹å‘ï¼Œæ¯”è¾ƒåƒç´ çš„æ¢¯åº¦å¹…å€¼ã€‚å¦‚æœä¸æ˜¯å±€éƒ¨æœ€å¤§å€¼ï¼Œåˆ™å°†å…¶æŠ‘åˆ¶ï¼ˆè®¾ä¸º 0ï¼‰ã€‚è¿™ä¸€æ­¥å¯ä»¥ç»†åŒ–è¾¹ç¼˜ã€‚\nåŒé˜ˆå€¼å¤„ç†ï¼š ä½¿ç”¨ä¸¤ä¸ªé˜ˆå€¼ï¼ˆé«˜é˜ˆå€¼å’Œä½é˜ˆå€¼ï¼‰æ¥åŒºåˆ†å¼ºè¾¹ç¼˜ã€å¼±è¾¹ç¼˜å’Œéè¾¹ç¼˜åƒç´ ã€‚\nè¾¹ç¼˜è·Ÿè¸ªï¼š æœ€åï¼Œé€šè¿‡æ»åé˜ˆå€¼æ³•æ¥è·Ÿè¸ªè¾¹ç¼˜ã€‚å¼ºè¾¹ç¼˜åƒç´ è¢«ç«‹å³æ ‡è®°ä¸ºè¾¹ç¼˜ï¼Œè€Œå¼±è¾¹ç¼˜åƒç´ åªæœ‰åœ¨ä¸å¼ºè¾¹ç¼˜åƒç´ ç›¸è¿æ—¶æ‰è¢«ä¿ç•™ã€‚\n\nCanny è¾¹ç¼˜æ£€æµ‹çš„ä¼˜ç‚¹åŒ…æ‹¬ï¼š - èƒ½å¤Ÿæ£€æµ‹åˆ°å¼±è¾¹ç¼˜ - å¯¹å™ªå£°å…·æœ‰è¾ƒå¼ºçš„é²æ£’æ€§ - èƒ½å¤Ÿå¾—åˆ°è¾ƒä¸ºç²¾ç¡®çš„è¾¹ç¼˜å®šä½\nåœ¨ OpenCV ä¸­ï¼Œcv2.Canny() å‡½æ•°å°è£…äº†è¿™äº›æ­¥éª¤ï¼Œä½¿å¾—è¾¹ç¼˜æ£€æµ‹å˜å¾—ç®€å•æ˜“ç”¨ã€‚åœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥è¿›è¡Œè¾¹ç¼˜æ£€æµ‹ã€‚\n\n# ä½¿ç”¨Cannyè¾¹ç¼˜æ£€æµ‹\nedges = cv2.Canny(blurred, 100, 200)\n\n# å®šä¹‰å½¢æ€å­¦æ“ä½œçš„æ ¸\nkernel = np.ones((2,2), np.uint8)\n\n# åº”ç”¨é—­è¿ç®—æ¥å¡«å……è¾¹ç¼˜ä¹‹é—´çš„å°é—´éš™\nclosed_edges = cv2.morphologyEx(edges, cv2.MORPH_CLOSE, kernel, iterations=2)\n\n# åº”ç”¨è†¨èƒ€æ“ä½œæ¥è¿›ä¸€æ­¥åŠ ç²—è¾¹ç¼˜\ndilated_edges = cv2.dilate(closed_edges, kernel, iterations=2)\n\n# å¯»æ‰¾è½®å»“\ncontours, _ = cv2.findContours(dilated_edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)\n\n# åœ¨åŸå›¾ä¸Šç»˜åˆ¶è½®å»“\nresult = image.copy()\ncv2.drawContours(result, contours, -1, (0, 255, 0), 2)\n\n# æ˜¾ç¤ºç»“æœ\nplt.figure(figsize=(15, 5))\nplt.subplot(1, 3, 1)\nplt.title(\"Original Image\")\nplt.imshow(cv2.cvtColor(image, cv2.COLOR_BGR2RGB))\nplt.axis('off')\n\nplt.subplot(1, 3, 2)\nplt.title(\"Processed Edges\")\nplt.imshow(dilated_edges, cmap='gray')\nplt.axis('off')\n\nplt.subplot(1, 3, 3)\nplt.title(\"Detected Shapes\")\nplt.imshow(cv2.cvtColor(result, cv2.COLOR_BGR2RGB))\nplt.axis('off')\n\nplt.tight_layout()\nplt.show()\n\n# æ‰“å°æ£€æµ‹åˆ°çš„è½®å»“æ•°é‡\nprint(f\"Detected contours: {len(contours)}\")\n\n\n\n\n\n\n\n\nDetected contours: 22",
    "crumbs": [
      "<span class='chapter-number'>18</span>Â  <span class='chapter-title'>æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡ä¸­çš„ç‰©ä½“</span>"
    ]
  },
  {
    "objectID": "object-detection-of-microfluidic-chip.html#ä½¿ç”¨-groundingdino-æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡",
    "href": "object-detection-of-microfluidic-chip.html#ä½¿ç”¨-groundingdino-æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡",
    "title": "18Â  æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡ä¸­çš„ç‰©ä½“",
    "section": "18.4 ä½¿ç”¨ GroundingDino æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡",
    "text": "18.4 ä½¿ç”¨ GroundingDino æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡\nåœ¨è¿™ä¸ªéƒ¨åˆ†,æˆ‘ä»¬å°†ä½¿ç”¨ GroundingDino æ¨¡å‹æ¥æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡ä¸­çš„ç™½ç‚¹ã€‚GroundingDino æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ç›®æ ‡æ£€æµ‹æ¨¡å‹,å¯ä»¥æ ¹æ®æ–‡æœ¬æç¤ºæ¥å®šä½å’Œåˆ†å‰²å›¾åƒä¸­çš„å¯¹è±¡ã€‚ä»¥ä¸‹æ˜¯ä»£ç çš„ä¸»è¦æ­¥éª¤å’ŒåŠŸèƒ½:\n\nå‡†å¤‡å›¾åƒå’Œæç¤º:\n\nè®¾ç½®å›¾åƒè·¯å¾„å’Œä¸Šä¼ å›¾åƒ\nåˆ›å»ºæ–‡æœ¬æç¤º â€œwhite dotsâ€\n\né…ç½®æ£€æµ‹ä»»åŠ¡:\n\nä½¿ç”¨ DetectionTask è®¾ç½®æ£€æµ‹å‚æ•°\næŒ‡å®šæ£€æµ‹ç›®æ ‡ä¸ºè¾¹ç•Œæ¡†(BBox)å’Œæ©ç (Mask)\né€‰æ‹© GroundingDino-1.5-Pro æ¨¡å‹\n\næ‰§è¡Œæ£€æµ‹:\n\nä½¿ç”¨ client.run_task() è¿è¡Œæ£€æµ‹ä»»åŠ¡\nè·å–æ£€æµ‹ç»“æœ\n\nå¯è§†åŒ–ç»“æœ:\n\néå†æ£€æµ‹åˆ°çš„æ¯ä¸ªå¯¹è±¡\nå°†æ©ç ä» RLE æ ¼å¼è½¬æ¢ä¸º RGBA å›¾åƒ\nåˆ›å»ºå›¾åƒå‰¯æœ¬å¹¶ç»˜åˆ¶æ£€æµ‹ç»“æœ\næ˜¾ç¤ºåŸå§‹å›¾åƒã€æ©ç å åŠ å’Œè¾¹ç•Œæ¡†\næ·»åŠ ç±»åˆ«å’Œç½®ä¿¡åº¦å¾—åˆ†æ ‡ç­¾\n\n\nè¿™æ®µä»£ç å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨é«˜çº§ç›®æ ‡æ£€æµ‹æ¨¡å‹æ¥è¯†åˆ«å¾®æµæ§èŠ¯ç‰‡ä¸­çš„ç‰¹å®šç»“æ„,å¹¶ä»¥å¯è§†åŒ–çš„æ–¹å¼å‘ˆç°ç»“æœã€‚\n\nimport os\nfrom dds_cloudapi_sdk import Config\nfrom dds_cloudapi_sdk import Client\nfrom dds_cloudapi_sdk import DetectionTask\nfrom dds_cloudapi_sdk import TextPrompt\nfrom dds_cloudapi_sdk import DetectionModel\nfrom dds_cloudapi_sdk import DetectionTarget\n\ntoken = os.getenv(\"DINO_API_KEY\")\nconfig = Config(token)\nclient = Client(config)\n\nimage_path = \"example/images/microfluidic-chip.jpg\"\nimage_url = client.upload_file(image_path)\nprompt = [TextPrompt(text=\"white dots surrounding by black edge\")]\n\ntask = DetectionTask(\n    image_url=image_url,\n    prompts=prompt,\n    targets=[DetectionTarget.Mask, DetectionTarget.BBox],  # detect both bbox and mask\n    model=DetectionModel.GDino1_5_Pro,  # detect with GroundingDino-1.5-Pro model\n)\n\ntask = DetectionTask(\n    image_url=image_url,\n    prompts=prompt,\n    targets=[DetectionTarget.Mask, DetectionTarget.BBox],\n    model=DetectionModel.GDino1_5_Pro,\n)\n\nclient.run_task(task)\nresult = task.result    \n\n\n# æ˜¾ç¤ºæ£€æµ‹ç»“æœ\nimport matplotlib.pyplot as plt\nfrom PIL import Image, ImageDraw\nimport matplotlib.patches as patches\n\nimage = Image.open(image_path)\n\nobjects = result.objects  # the list of detected objects\nfor idx, obj in enumerate(objects):\n    # å°†RLEæ ¼å¼è½¬æ¢ä¸ºRGBAå›¾åƒ\n    mask_image = task.rle2rgba(obj.mask)\n\n    # åˆ›å»ºä¸€ä¸ªå›¾åƒå‰¯æœ¬ç”¨äºç»˜åˆ¶\n    fig, ax = plt.subplots(1, 1, figsize=(12, 8))\n    \n    ax.imshow(image)\n    ax.imshow(mask_image, alpha=0.5)\n    \n    # åœ¨å›¾åƒä¸Šç»˜åˆ¶æ©ç \n    bbox = obj.bbox\n    # åˆ›å»ºä¸€ä¸ªçŸ©å½¢æ¡†ï¼Œå‚æ•°ä¸º (å·¦ä¸Šè§’ x, å·¦ä¸Šè§’ y, å®½åº¦, é«˜åº¦)\n    rect = patches.Rectangle(\n        (bbox[0], bbox[1]),  # å·¦ä¸Šè§’åæ ‡\n        bbox[2] - bbox[0],   # å®½åº¦\n        bbox[3] - bbox[1],   # é«˜åº¦\n        linewidth=2,         # è¾¹æ¡†å®½åº¦\n        edgecolor='red',     # è¾¹æ¡†é¢œè‰²\n        facecolor='none'     # å¡«å……é¢œè‰²\n    )\n    ax.add_patch(rect)   \n    \n    # åœ¨å›¾åƒä¸Šæ·»åŠ ç±»åˆ«å’Œåˆ†æ•°\n    text = f\"{obj.category} {obj.score:.2f}\"\n    ax.text(bbox[0], \n              bbox[1] - 10, \n              text, \n              color='red', \n              fontsize=12)\n\n    # æ˜¾ç¤ºå›¾åƒ\n    # plt.axis('off')  # ä¸æ˜¾ç¤ºåæ ‡è½´\n    plt.show()",
    "crumbs": [
      "<span class='chapter-number'>18</span>Â  <span class='chapter-title'>æ£€æµ‹å¾®æµæ§èŠ¯ç‰‡ä¸­çš„ç‰©ä½“</span>"
    ]
  },
  {
    "objectID": "gradio.html",
    "href": "gradio.html",
    "title": "19Â  Gradio",
    "section": "",
    "text": "19.1 ç”¨äºæƒ…æ„Ÿåˆ†æçš„ APP\nä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ Gradio åˆ›å»ºä¸€ä¸ªå¯ä»¥è¾“å…¥æ–‡æœ¬å¹¶è¿”å›æƒ…æ„Ÿåˆ†æç»“æœçš„ç•Œé¢ï¼š\nimport gradio as gr\nfrom transformers import pipeline\n\n# åŠ è½½æƒ…æ„Ÿåˆ†ææ¨¡å‹\nsentiment_model = pipeline(\"sentiment-analysis\")\n\n# å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†è¾“å…¥å¹¶è¿”å›ç»“æœ\ndef analyze_sentiment(text):\n    result = sentiment_model(text)[0]\n    return {result['label']: result['score']}\n\n# åˆ›å»º Gradio æ¥å£\niface = gr.Interface(\n    fn=analyze_sentiment,\n    inputs=\"text\",\n    outputs=\"label\",\n    live=True\n)\n\n# å¯åŠ¨ç•Œé¢\niface.launch()\n\nRunning on local URL:  http://127.0.0.1:7860\n\nTo create a public link, set `share=True` in `launch()`.\nä½ å¯ä»¥åœ¨æœ¬åœ°è¿è¡Œè¿™ä¸ªä»£ç ï¼Œå¹¶é€šè¿‡ç”Ÿæˆçš„é“¾æ¥è®¿é—®å’Œæµ‹è¯•æƒ…æ„Ÿåˆ†ææ¨¡å‹ã€‚",
    "crumbs": [
      "<span class='chapter-number'>19</span>Â  <span class='chapter-title'>Gradio</span>"
    ]
  },
  {
    "objectID": "gradio.html#åœ¨çº¿æœåŠ¡",
    "href": "gradio.html#åœ¨çº¿æœåŠ¡",
    "title": "19Â  Gradio",
    "section": "19.2 åœ¨çº¿æœåŠ¡",
    "text": "19.2 åœ¨çº¿æœåŠ¡\nè¿˜å¯ä»¥é€šè¿‡ iface.launch(share=True) å°†æœåŠ¡å‘å¸ƒåˆ° gradio.live ç½‘ç«™ä¸Šï¼šhttps://e7ce7d908c95c155b5.gradio.live/?ã€‚\næ³¨æ„ï¼šè¿™ä¸ªåˆ†äº«é“¾æ¥ä¼šå¾ˆå¿«å¤±æ•ˆã€‚\nè¿™æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ gradio_client åº“ä¸­çš„ Client ç±»ä¸ä¸€ä¸ªè¿œç¨‹ Gradio åº”ç”¨è¿›è¡Œäº¤äº’ã€‚\n\nfrom gradio_client import Client\n\nclient = Client(\"https://e7ce7d908c95c155b5.gradio.live/\")\nresult = client.predict(\n        text=\"Hello!!\",\n        api_name=\"/predict\"\n)\nprint(result)\n\nclient = Client(\"https://e7ce7d908c95c155b5.gradio.live/\")\n\nåˆ›å»º Client å®ä¾‹ï¼šå®ä¾‹åŒ–ä¸€ä¸ª Client å¯¹è±¡ï¼Œè¿æ¥åˆ°æŒ‡å®šçš„ Gradio åº”ç”¨ URLã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒURL æ˜¯ https://e7ce7d908c95c155b5.gradio.live/ã€‚\n\nresult = client.predict(\n    text=\"Hello!!\",\n    api_name=\"/predict\"\n)\n\nè°ƒç”¨ predict æ–¹æ³•ï¼š\n\ntext=\"Hello!!\"ï¼šä¼ é€’ä¸€ä¸ªåŒ…å«æ–‡æœ¬ \"Hello!!\" çš„å‚æ•°ã€‚\napi_name=\"/predict\"ï¼šæŒ‡å®šè¦è°ƒç”¨çš„ API åç§°ã€‚è¿™ä¸ªåç§°é€šå¸¸æ˜¯åœ¨ Gradio åº”ç”¨ä¸­å®šä¹‰çš„ç‰¹å®šç«¯ç‚¹ã€‚\nè¯¥æ–¹æ³•ä¼šå°†å‚æ•°å‘é€åˆ° Gradio åº”ç”¨çš„ /predict ç«¯ç‚¹ï¼Œå¹¶è¿”å›é¢„æµ‹ç»“æœã€‚\n\n\nprint(result)\n\næ‰“å°ç»“æœï¼šå°† predict æ–¹æ³•è¿”å›çš„ç»“æœæ‰“å°åˆ°æ§åˆ¶å°ã€‚\n\né€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥æ–¹ä¾¿åœ°ä¸è¿œç¨‹ Gradio åº”ç”¨è¿›è¡Œäº¤äº’ï¼Œå‘é€è¯·æ±‚å¹¶è·å–é¢„æµ‹ç»“æœã€‚",
    "crumbs": [
      "<span class='chapter-number'>19</span>Â  <span class='chapter-title'>Gradio</span>"
    ]
  },
  {
    "objectID": "gradio.html#åœ¨-quarto-ä¸­æ˜¾ç¤º",
    "href": "gradio.html#åœ¨-quarto-ä¸­æ˜¾ç¤º",
    "title": "19Â  Gradio",
    "section": "19.3 åœ¨ Quarto ä¸­æ˜¾ç¤º",
    "text": "19.3 åœ¨ Quarto ä¸­æ˜¾ç¤º\nè¦åœ¨ Quarto ä¸­æ­£ç¡®æ˜¾ç¤º Gradio çš„è¾“å‡ºç»“æœï¼Œä½ éœ€è¦ç¡®ä¿ä»¥ä¸‹å‡ ç‚¹ï¼š\n\nGradio æœåŠ¡æ­£å¸¸è¿è¡Œï¼šä½ éœ€è¦åœ¨æœ¬åœ°æˆ–è¿œç¨‹æœåŠ¡å™¨ä¸Šå¯åŠ¨ Gradio æœåŠ¡ã€‚\nåœ¨ Quarto æ–‡æ¡£ä¸­åµŒå…¥ Gradio åº”ç”¨ï¼šä½ å¯ä»¥åœ¨ Quarto æ–‡æ¡£ä¸­åµŒå…¥ä¸€ä¸ª iframe æ¥æ˜¾ç¤º Gradio åº”ç”¨çš„è¾“å‡ºã€‚\n\nä¸‹é¢æ˜¯ä¸€ä¸ªè¯¦ç»†çš„æ­¥éª¤ï¼š\n\n19.3.1 1. å¯åŠ¨ Gradio æœåŠ¡\né¦–å…ˆï¼Œç¡®ä¿ä½ çš„ Gradio æœåŠ¡æ­£åœ¨è¿è¡Œã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„ä»£ç å¯åŠ¨ Gradio åº”ç”¨ã€‚\n\n\n19.3.2 2. åœ¨ Quarto æ–‡æ¡£ä¸­åµŒå…¥ Gradio åº”ç”¨\nåœ¨ä½ çš„ Quarto æ–‡æ¡£ä¸­ï¼ˆä¾‹å¦‚ï¼Œdocument.qmdï¼‰ï¼Œä½ å¯ä»¥é€šè¿‡ iframe åµŒå…¥ Gradio åº”ç”¨ã€‚ç¡®ä¿ä½ ä½¿ç”¨çš„æ˜¯ .qmd æ–‡ä»¶æ ¼å¼ï¼Œå¹¶åœ¨å…¶ä¸­åµŒå…¥ Gradio çš„é“¾æ¥ã€‚\nä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ Quarto æ–‡æ¡£ï¼š\n# Gradio Application\n\n&lt;iframe src=\"YOUR_GRADIO_LINK_HERE\"&gt;&lt;/iframe&gt;\nå°† YOUR_GRADIO_LINK_HERE æ›¿æ¢ä¸º Gradio åº”ç”¨ç”Ÿæˆçš„å…¬å¼€é“¾æ¥ã€‚\n\n\n\n\n19.3.3 3. æ¸²æŸ“ Quarto æ–‡æ¡£\nä½¿ç”¨ Quarto æ¸²æŸ“æ–‡æ¡£ï¼š\nquarto render document.qmd\nè¿™å°†ç”Ÿæˆä¸€ä¸ª HTML æ–‡ä»¶ï¼Œå…¶ä¸­åµŒå…¥äº†ä½ çš„ Gradio åº”ç”¨ã€‚æ‰“å¼€ç”Ÿæˆçš„ HTML æ–‡ä»¶ï¼Œå³å¯åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹å¹¶ä¸ Gradio åº”ç”¨è¿›è¡Œäº¤äº’ã€‚\nè¿˜å¯ä»¥å‚è§ Quarto åŠ¨æ€æ–‡æ¡£ï¼šhttps://quarto.org/docs/interactive/ã€‚",
    "crumbs": [
      "<span class='chapter-number'>19</span>Â  <span class='chapter-title'>Gradio</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Knuth, Donald E. 1984. â€œLiterate Programming.â€ Comput.\nJ. 27 (2): 97â€“111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "References"
    ]
  }
]